<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Tianlin</title>
  
  <subtitle>Tianlin</subtitle>
  <link href="https://www.linjiangyu.com/atom.xml" rel="self"/>
  
  <link href="https://www.linjiangyu.com/"/>
  <updated>2023-11-27T01:42:42.511Z</updated>
  <id>https://www.linjiangyu.com/</id>
  
  <author>
    <name>Tianlin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>LBå¸¸ç”¨è°ƒåº¦ç®—æ³•</title>
    <link href="https://www.linjiangyu.com/posts/ed485414.html"/>
    <id>https://www.linjiangyu.com/posts/ed485414.html</id>
    <published>2023-06-11T11:06:38.000Z</published>
    <updated>2023-11-27T01:42:42.511Z</updated>
    
    <content type="html"><![CDATA[<h3 id="LBå¸¸ç”¨è°ƒåº¦ç®—æ³•">LBå¸¸ç”¨è°ƒåº¦ç®—æ³•</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">)</span> <span class="string">è½®è¯¢:</span> <span class="string">RRï¼ˆRound</span> <span class="string">Robinï¼‰</span></span><br><span class="line"><span class="string">æœ€åŸºæœ¬çš„è°ƒåº¦ç®—æ³•ï¼ŒæŠŠè¯·æ±‚è¿æ¥ä¾æ¬¡è½®æµåˆ†é…åˆ°RSæœºå™¨ï¼Œç¼ºç‚¹æ˜¯å¦‚æœæœºå™¨æ€§èƒ½ä¸ä¸€è‡´ä¾¿ä¼šå¯¼è‡´èµ„æºæµªè´¹</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span><span class="string">)</span> <span class="string">åŠ æƒè½®è¯¢:</span> <span class="string">WRRï¼ˆWeighted</span> <span class="string">Round</span> <span class="string">Robinï¼‰</span></span><br><span class="line"><span class="string">åœ¨RRçš„åŸºç¡€ä¸Šæ·»åŠ äº†è®¾ç½®æœºå™¨æƒé‡ï¼ŒæŒ‰ç…§æƒé‡æ¯”ä¾‹è°ƒåº¦è¯·æ±‚</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span><span class="string">)</span> <span class="string">æºåœ°å€å“ˆå¸Œ:</span> <span class="string">SH</span> <span class="string">ï¼ˆSource</span> <span class="string">Hashï¼‰</span></span><br><span class="line"><span class="string">å°†è¯·æ±‚çš„å®¢æˆ·ç«¯IPåœ°å€è¿›è¡ŒHashè®¡ç®—å¹¶è°ƒåº¦ï¼Œåé¢æ­¤IPåœ°å€å‘å‡ºçš„è¯·æ±‚ä¾¿ä¼šè¢«æ°¸ä¹…çš„è°ƒåº¦åˆ°åŒä¸€å°RSæœºå™¨ä¸Š</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span><span class="string">)</span> <span class="string">ç›®æ ‡åœ°å€å“ˆå¸Œ:</span> <span class="string">DH</span> <span class="string">(Destination</span> <span class="string">Hash)</span></span><br><span class="line"><span class="string">é€šè¿‡ä¸€ä¸ªæ•£åˆ—å‡½æ•°å°†æ¥è‡ªåŒä¸€ä¸ªæºIPçš„è¯·æ±‚åœ°å€æ˜ å°„åˆ°ä¸€å°æœåŠ¡å™¨æˆ–é“¾è·¯ä¸Š</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span><span class="string">)</span> <span class="string">æœ€å°‘è¿æ¥æ•°:</span> <span class="string">LCï¼ˆLeast</span> <span class="string">Connectionï¼‰</span></span><br><span class="line"><span class="string">æ ¹æ®å½“å‰å„æœåŠ¡å™¨çš„è¿æ¥æ•°æ¥ä¼°è®¡æœåŠ¡å™¨çš„è´Ÿè½½æƒ…å†µï¼ŒæŠŠæ–°çš„è¿æ¥åˆ†é…ç»™è¿æ¥æ•°æœ€å°çš„æœåŠ¡å™¨ï¼›è´Ÿè½½ç‡=active*256+inactiveï¼Œå€¼å°çš„ä¼˜å…ˆåˆ†é…è¯·æ±‚</span></span><br><span class="line"></span><br><span class="line"><span class="number">6</span><span class="string">ï¼‰åŠ æƒæœ€å°‘è¿æ¥æ•°:</span> <span class="string">WLCï¼ˆWeighted</span> <span class="string">Least</span> <span class="string">Connectionï¼‰</span></span><br><span class="line"><span class="string">ä¸LCç±»ä¼¼ï¼Œæ ¹æ®å½“å‰å„æœåŠ¡å™¨çš„è¿æ¥æ•°æ¥ä¼°è®¡æœåŠ¡å™¨çš„è´Ÿè½½æƒ…å†µï¼ŒæŠŠæ–°çš„è¿æ¥åˆ†é…ç»™è¿æ¥æ•°æœ€å°çš„æœåŠ¡å™¨ï¼›è´Ÿè½½ç‡=(active*256+inactive)/weightï¼Œå€¼å°çš„ä¼˜å…ˆåˆ†é…è¯·æ±‚</span></span><br><span class="line"></span><br><span class="line"><span class="number">7</span><span class="string">ï¼‰æœ€çŸ­æœŸæœ›å»¶è¿Ÿ:</span> <span class="string">SEDï¼ˆShortest</span> <span class="string">Expect</span> <span class="string">Delayï¼‰</span></span><br><span class="line"><span class="string">è¿™ä¸ªç®—æ³•ä¸»è¦æ˜¯ä¼˜åŒ–LCçš„ï¼Œåœ¨æœåŠ¡å‡åœ¨è¯·æ±‚å°‘çš„æ—¶å€™é¿å…è´Ÿè½½åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šåšçš„ä¼˜åŒ–ï¼›è´Ÿè½½ç‡=(active+1)*256/weightï¼Œå€¼å°çš„ä¼˜å…ˆåˆ†é…è¯·æ±‚</span></span><br><span class="line"></span><br><span class="line"><span class="number">8</span><span class="string">)</span> <span class="string">æ°¸ä¸æ’é˜Ÿ:</span> <span class="string">NQ</span> <span class="string">ï¼ˆNerver</span> <span class="string">Queueï¼‰</span></span><br><span class="line"><span class="string">åœ¨è´Ÿè½½ä½æ—¶ï¼Œè¯·æ±‚ç›´æ¥åˆ†é…åˆ°ç©ºé—²æœåŠ¡å™¨ä¸Šï¼Œä¸ä¼šäº§ç”Ÿè¯·æ±‚ç­‰å¾…ï¼›å½“æœåŠ¡å™¨éƒ½å¾ˆå¿™æ—¶ï¼Œå°†è½®è¯¢</span></span><br><span class="line"></span><br><span class="line"><span class="number">9</span><span class="string">)</span> <span class="string">åŸºäºæœ¬åœ°æœ€å°‘è¿æ¥:</span> <span class="string">LBLCï¼ˆLocality-Based</span> <span class="string">Least</span> <span class="string">Connectionï¼‰</span></span><br><span class="line"><span class="string">æ ¹æ®è¯·æ±‚çš„ç›®æ ‡IPåœ°å€æ‰¾å‡ºè¯¥ç›®æ ‡IPåœ°å€æœ€è¿‘ä½¿ç”¨çš„RealServerï¼Œè‹¥è¯¥Real</span> <span class="string">Serveræ˜¯å¯ç”¨çš„ä¸”æ²¡æœ‰è¶…è½½ï¼Œå°†è¯·æ±‚å‘é€åˆ°è¯¥æœåŠ¡å™¨ï¼›è‹¥æœåŠ¡å™¨ä¸å­˜åœ¨ï¼Œæˆ–è€…è¯¥æœåŠ¡å™¨è¶…è½½ä¸”æœ‰æœåŠ¡å™¨å¤„äºä¸€åŠçš„å·¥ä½œè´Ÿè½½ï¼Œåˆ™ç”¨â€œæœ€å°‘é“¾æ¥â€çš„åŸåˆ™é€‰å‡ºä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å™¨ï¼Œå°†è¯·æ±‚å‘é€åˆ°è¯¥æœåŠ¡å™¨</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">LBå¸¸ç”¨è°ƒåº¦ç®—æ³•</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
    <category term="æœåŠ¡" scheme="https://www.linjiangyu.com/tags/%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>SDä½¿ç”¨å’ŒLoraæ¨¡å‹è®­ç»ƒ</title>
    <link href="https://www.linjiangyu.com/posts/ba51ac6f.html"/>
    <id>https://www.linjiangyu.com/posts/ba51ac6f.html</id>
    <published>2023-05-03T03:44:21.000Z</published>
    <updated>2023-11-27T01:42:42.511Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SDä½¿ç”¨å’ŒLoraæ¨¡å‹è®­ç»ƒ">SDä½¿ç”¨å’ŒLoraæ¨¡å‹è®­ç»ƒ</h2><p>æœ€è¿‘ä¸€ç›´æ²¡æœ‰æ›´æ–°åšå®¢ï¼Œä¸€æ–¹é¢å› ä¸ºè‡ªå·±åœ¨å‡†å¤‡å®ä¹ éœ€è¦çš„ä¸œè¥¿æ—¶é—´å¾ˆèµ¶ï¼Œå¦ä¸€æ–¹é¢å°±æ˜¯å› ä¸ºAIç»˜ç”»ç©å…·å•¦ã€‚</p><h3 id="Stable-Diffusion">Stable Diffusion</h3><ul><li><p>éœ€è¦æ˜¾å¡æ˜¯Nå¡ä¸”å®‰è£…å¥½<a href="https://www.nvidia.cn/geforce/drivers/">Nå¡GPUé©±åŠ¨</a></p></li><li><p>è¿™é‡Œæˆ‘æ˜¯ä½¿ç”¨çš„æ¥è‡ª<a href="https://space.bilibili.com/12566101">Bç«™é˜¿å©†ä¸»ç§‹è‘‰</a>æ‰€å‘å¸ƒçš„<a href="https://pan.baidu.com/s/1tmYETTYuWYcCTsJUk2zF0A?pwd=6drn">Stable Diffusion V4æ•´åˆåŒ…</a> éƒ¨ç½²åœ¨æœ¬åœ°ç”µè„‘çš„AIç»˜ç”»çš„</p></li><li><p>æ•´åˆåŒ…ä¸‹è½½ååŒ…æ‹¬ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/DQAX0_I2%5D~%5DX%7BEVR%5BLSK9LL.png" alt=""></p></li></ul><ol><li><p>é¦–å…ˆè¿è¡Œå¯åŠ¨å™¨ä¾èµ–</p></li><li><p>è§£å‹sd-webui-aki-v4.zip</p></li><li><p>è¿›å…¥sd-webui-aki-v4æ–‡ä»¶å¤¹æ‰“å¼€å¯åŠ¨å™¨åä¸€é”®å¯åŠ¨ç­‰å¾…æ§åˆ¶å°è¾“å‡ºå®Œæ¯•å¼¹å‡ºWeb Uiç•Œé¢å°±å¯ä»¥å¼€å§‹ç»˜å›¾å•¦</p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683086006853.jpg" alt=""></p></li><li><p>æ•´åˆåŒ…å·²ç»å®‰è£…å¥½æ±‰åŒ–ï¼Œè¿™é‡Œçš„æ­£å‘æç¤ºè¯å°±æ˜¯è¾“å…¥ä½ æƒ³è¦è®©AIç”»å‡ºäººç‰©çš„æè¿°å•¦ï¼Œä¾‹å¦‚masterpiece,1 girl, very detailed CG, beautiful eyes, very detailed, Blackboard painting, complex details_ 1.2, 8k wallpaper, jkç­‰ç­‰ï¼Œé»˜è®¤ä½¿ç”¨è‹±æ–‡ï¼Œç”¨é€—å·åˆ†å‰²è¯è¯­ï¼Œè€Œè´Ÿé¢æç¤ºè¯åˆ™æ˜¯åç€æ¥äº†ï¼Œä¾‹å¦‚å†™å…¥worst quality,bad hands,malformedÂ hands,worstÂ quality,lowÂ quality,((((ugly)))),(((duplicate))),(((trans))),((trannsexual)),(outÂ ofÂ frame),extraÂ fingers,mutatedÂ hands,outÂ ofÂ frame,extraÂ limbs,(badÂ anatomy),grossproportions,(malformedÂ limbs),((missingÂ arms)),((missinglegs)),(((extraÂ arms))),(((extraÂ legs)))</p></li><li><p>ç­‰ç­‰</p><ul><li>è¿™é‡Œæ¨èä½¿ç”¨æˆ‘çš„TAGç”Ÿæˆå™¨</li></ul><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1682909507747.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Tianlin_Tag</div>  <p>è‡ªç”¨TAGç”Ÿæˆå·¥å…·</p>  <a href='https://tag.linjiangyu.com/'></a>  </figcaption>  </figure>  </div></li><li><p>å®é™…ç”Ÿæˆä¸€å¼ å§ï¼Œå› ä¸ºæˆ‘çš„ç ´çƒ‚ç”µè„‘æ˜¾å¡ä¸è¡Œï¼Œæ˜¾å­˜ä¸å¤Ÿæ‰€ä»¥è¿™é‡Œç­‰ä¸Šä¸ªæŠŠåˆ†é’Ÿéƒ½æ˜¯ä¸å¥‡æ€ªçš„ï¼Œå…·ä½“è¿˜æ˜¯çœ‹ä½ ä¸æ˜¾å¡ä¹‹é—´çš„ç¾ç»Šå§ğŸ¤£</p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683087991679.jpg" alt=""></p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/00010-235500343-masterpiece,1%20girl,%20very%20detailed%20CG,%20beautiful%20eyes,%20very%20detailed,%20Blackboard%20painting,%20complex%20details_%201.2,%208k%20wallpaper,%20jk.png" alt=""></p><p>â€‹è¿™é‡Œçœ‹å¯èƒ½ä¼šæœ‰ç‚¹æ¨¡ç³Šï¼Ÿæˆ‘è¿˜ç»è¿‡äº†å‹ç¼©æ‰ä¸Šä¼ æ˜¾ç¤ºåœ¨æ­¤ç½‘é¡µä¸­çš„åŸå› å§ï¼Œå¯ä»¥çœ‹åˆ°AIå¯ä»¥å¾ˆå¥½çš„ç»˜ç”»å‡ºæˆ‘ä»¬æ»¡æ„çš„å›¾ç‰‡</p><ul><li>è€Œä¸”åœ¨Stable Diffusionä¸­ä¹Ÿæœ‰å›¾ç‰‡æ”¾å¤§çš„è¿è¡Œï¼Œå›¾ç‰‡æ”¾å¤§å…¶å®æ˜¯åœ¨å·²çŸ¥åƒç´ ç‚¹çš„ä½ç½®ä¸Šä¼°ç®—æ–°çš„åƒç´ ç‚¹çš„å€¼ã€‚è¿™å¯ä»¥é€šè¿‡è®¡ç®—åŸå›¾åƒä¸­çš„ç›¸é‚»åƒç´ ç‚¹çš„å¹³å‡å€¼æˆ–åŠ æƒå¹³å‡å€¼æ¥å®ç°ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åŸå›¾åƒä¸­çš„æ¯ä¸ªåƒç´ ç‚¹ä¹‹é—´ä¼°ç®—å‡ºæ–°çš„åƒç´ ç‚¹çš„å€¼ï¼Œä»è€Œæ¥å¢åŠ å›¾åƒçš„åˆ†è¾¨ç‡å’Œæ¸…æ™°åº¦</li><li>Stable Diffusionéå¸¸å¼ºå¤§ï¼Œç”šè‡³è¿˜æ”¯æŒæ–‡ä»¶å¤¹ä¸­å›¾ç‰‡æ‰¹é‡å¤„ç†è¾“å‡º</li></ul><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683088698837.png" alt=""></p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683089264426.jpg" alt=""></p><p>åœ¨è¿™é‡Œä¸Šä¼ ä½ éœ€è¦æ”¾å¤§å¤„ç†çš„å›¾ç‰‡ï¼Œæˆ‘ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨BSRGANç®—æ³•æ¥æ”¾å¤§å¤„ç†çš„ï¼Œç¼©æ”¾æ¯”ä¾‹ä¹Ÿæ˜¯å¸¸ç”¨çš„3ï¼Œæœ€é«˜å¯ä»¥åˆ°8ï¼Œåˆ†è¾¨ç‡è°ƒåˆ°å¤ªé«˜çš„æ—¶å€™å›¾ç‰‡çš„çº¿æ¡ä¼šè¿‡åˆ†æ˜æ˜¾æˆ‘å¹¶ä¸å–œæ¬¢ã€‚</p><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨3å€çš„ç¼©æ”¾æ¯”ä¾‹å’ŒBSRGANç®—æ³•å¤„ç†åçš„å›¾ç‰‡</p><div class="hide-block"><button type="button" class="hide-button" style="background-color: orange;">ç‚¹å‡»æŸ¥çœ‹     </button><div class="hide-content"><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1279261927392739.png" alt=""></p></div></div><p>å¯ä»¥çœ‹å‡º3å€çš„ç¼©æ”¾æ¯”ä¾‹ä¾¿å·²ç»å¯ä»¥è¾¾åˆ°éå¸¸å¥½çš„æ•ˆæœäº†ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä½¿ç”¨3-4ä¹‹é—´</p></li></ol><h3 id="Loraçš„è®­ç»ƒ">Loraçš„è®­ç»ƒ</h3><h4 id="å‡†å¤‡æ¡ä»¶å’Œç´ æ">å‡†å¤‡æ¡ä»¶å’Œç´ æ</h4><p>â€‹æœ‰äº›ç”»è´¨ä¹Ÿæ˜¯ç»è¿‡ä¸€ä¼ å†ä¼ è¢«å„ç§ç¤¾äº¤è½¯ä»¶ä¸€å†å‹ç¼©ï¼Œåˆ°æ‰‹çš„å›¾ç‰‡ä¹Ÿæ€»æ˜¯æ„Ÿè§‰æ¸…æ™°åº¦ä¸é«˜ï¼Œè€Œå°±ç®—ä½ æŠŠæ‰€æœ‰å…³äºä½ æƒ³è¦ç”Ÿæˆçš„äººç‰©çš„å„ç§ç»†èŠ‚éƒ½æè¿°å‡ºæ¥ï¼ŒAIç»˜å›¾ä¹Ÿæ— æ³•å°†äººç‰©çš„æ ·å¼å®Œæ•´çš„å¤ç°å‡ºæ¥ï¼Œä¸€èˆ¬å¯¹äºä¸“è¦äº§å‡ºå›¾ç‰‡çš„è§’è‰²å°±è¦ç”¨åˆ°Loraæˆ–è€…embeddingäº†ï¼Œè¿™é‡Œä¸»è¦è®²çš„æ˜¯å¦‚ä½•è®­ç»ƒä¸€ä¸ªä¸“æœ‰äººç‰©çš„Loraæ¨¡å‹ã€‚</p><ul><li><p>ä¸€èˆ¬çš„Loraæ¨¡å‹æ–‡ä»¶æ˜¯ä»¥safetensorsä¸ºåç¼€çš„è®­ç»ƒæ¨¡å‹æ–‡ä»¶ï¼Œå­˜æ”¾åœ¨SD_ROOT/models/Loraä¸­ã€‚</p></li><li><p>è®­ç»ƒçš„è¦æ±‚</p><ol><li><p>æ˜¾å­˜ï¼Œéœ€è¦æœ€å°‘ä¸º8Gçš„ç”µè„‘æ˜¾å­˜æ‰èƒ½è¿›è¡Œæœ€ä½çš„æœ¬åœ°è¿è¡Œè®­ç»ƒ(æˆ‘çš„ç ´çƒ‚ç”µè„‘å“ªé‡Œä¼šæœ‰8Gæ˜¾å­˜,æ‰€ä»¥è¿™é‡Œå†™çš„ä¾¿æ˜¯ç™½å«–äº‘ç«¯è¿è¡Œè®­ç»ƒLoraæ¨¡å‹)</p></li><li><p>å›¾ç‰‡ï¼Œéœ€è¦è‡³å°‘10å¼ ä»¥ä¸Šçš„è¾ƒé«˜æ¸…æ™°åº¦ï¼Œè¾ƒæ— æ‚ç‰©çš„äººç‰©å›¾ç‰‡(ä¹Ÿå°±æ˜¯æœ€å¥½å°‘ç‚¹èƒŒæ™¯ç‰©å“ä»€ä¹ˆçš„ï¼Œå¤šä¸ºäººç‰©çš„å•ç‹¬å±•ç¤ºå›¾æœ€å¥½)ï¼Œè€Œä¸”éœ€è¦ç»è¿‡å¤„ç†æŠŠæ‰€æœ‰çš„å›¾ç‰‡çš„åˆ†è¾¨ç‡éƒ½è°ƒä¸ºä¸€è‡´(åˆ†è¾¨ç‡è¦æ˜¯64çš„å€æ•°ä¸”éƒ½ä¸èƒ½è¶…è¿‡1920),è¿™é‡Œä¸€èˆ¬å¯ä»¥ä½¿ç”¨SDä¸­çš„åæœŸå¤„ç†è¿›è¡Œå›¾ç‰‡çš„åˆ†è¾¨ç‡æ”¾å¤§ï¼Œç„¶åä½¿ç”¨SDè®­ç»ƒä¸­çš„å›¾ç‰‡é¢„å¤„ç†è¿›è¡Œå¯¹å›¾ç‰‡è‡ªåŠ¨é¢éƒ¨ç„¦ç‚¹å‰ªè£çš„åˆ†è¾¨ç‡è£å‰ª(æˆ‘çš„æ¨èæ˜¯ä¸è¦è¶…è¿‡1280,1280çš„(è¿™é‡Œæˆ‘ä½¿ç”¨çš„å·®ä¸å¤š30å·¦å³å¼ çš„1280,1280çš„å›¾ç‰‡è®­ç»ƒçš„epochesæ•°ä¸º20çš„æ—¶å€™éƒ½è¦è®­ç»ƒåˆ°å·®ä¸å¤š4ä¸ªå°æ—¶å¤š)ï¼Œé™¤éå®¶é‡Œæœ‰æ¡ä»¶æ˜¯ç”¨çš„è‡ªå·±ç”µè„‘è®­ç»ƒçš„å¯ä»¥æŠŠåˆ†è¾¨ç‡æé«˜ï¼Œè®©è®­ç»ƒè¾¾åˆ°æœ€ä½³çš„æ•ˆæœ(è¿™é‡Œæˆ‘æ„Ÿè§‰ä¸æ˜¯epochesè®­ç»ƒæ•°è¶Šå¤šè¶Šå¥½ï¼Œè€Œä¸”æ”¯æŒå åŠ è®­ç»ƒçš„æ–¹å¼è®­ç»ƒæˆ‘åœ¨ä¸Šæ¬¡å åŠ è®­ç»ƒäº†8ä¸ªå°æ—¶å…¨éƒ¨ç™½æ­äº†ï¼Œå›¾ç‰‡çš„ç”Ÿæˆç›´æ¥æ•´ä¸ªå´©åï¼Œæ¨èå°±æ˜¯ä¸€æ¬¡æ€§ç»ƒå®Œ)</p></li><li><p>googleè´¦å·,è¿™é‡Œæ˜¯ä½¿ç”¨è°·æ­Œçš„Colabæ¥è¿›è¡Œäº‘ç«¯è®­ç»ƒ,googleæ¯å‘¨ä¼šåˆ·æ–°ä¸€æ¬¡è´¦å·çš„è¯•ç”¨Jupyter Notebookç¬”è®°æœ¬çš„æ—¶é•¿ï¼Œå®˜ç½‘è¯´æ˜¯ä¸€å‘¨æœ‰12å°æ—¶çš„æ—¶é—´ï¼Œä½†æ˜¯å®é™…ä¸Šä¸ºä½¿ç”¨çš„ä¼¤å®³ä¸€ä¸ªè´¦å·æœ€å¤šå°±6ä¸ªå°æ—¶å·¦å³çš„æ—¶é—´(ä¹‹å‰è®­ç»ƒåˆ°6ä¸ªå¤šå°æ—¶çš„æ¨¡å‹è¢«ä¸­æ–­äº†) (è¿™é‡Œä¼šç”¨æŒ‚è½½æŠŠè°·æ­Œç¡¬ç›˜æŒ‚è½½åˆ°Jupyter Notebookç¬”è®°æœ¬ä¸Šè€Œä¸”è®¾ç½®æ¨¡å‹çš„è¾“å‡ºç›®å½•ä¸ºæŒ‚è½½çš„è·¯å¾„ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…æ‰“æ°´æ¼‚ï¼Œå› ä¸ºæˆ‘éƒ½æ˜¯ä¸¤ä¸ªstepså°±ä¿å­˜ä¸€æ¬¡æ¨¡å‹,é‚£ä¹ˆå°±ç®—è®­ç»ƒè¢«ä¸­æ–­äº†ä¹Ÿå¯ä»¥åœ¨è°·æ­Œç¡¬ç›˜ä¸­ä¸‹è½½æœ€æ–°çš„ä¸­æ–­æ¨¡å‹ï¼Œä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„)</p></li><li><p>ç»™ä½ çš„å›¾ç‰‡æ‰“æ ‡ç­¾ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨SDä¸­çš„Taggeræ’ä»¶ï¼Œå¦‚æœæ˜¯ä½¿ç”¨ä¸Šé¢çš„æ•´åˆåŒ…çš„è¯æ˜¯æœ‰åŒ…å«åœ¨å†…çš„ï¼Œæƒ³è¦ä½¿ç”¨è¿™ä¸ªæ’ä»¶å¯¹å›¾ç‰‡è¿›è¡Œæ‰¹å¤„ç†éƒ½æ‰“ä¸Šæ ‡ç­¾ä¿å­˜åœ¨ç›¸åŒè·¯å¾„ä¸‹ç›¸åŒåå­—çš„txtæ–‡ä»¶ä¸­ç„¶ååé¢è¦ä¸Šä¼ åˆ°Jupyter Notebookç¬”è®°æœ¬ä¸­<br><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683166925138.png" alt=""></p></li></ol><p>è¿™é‡Œçš„é˜€å€¼æ˜¯å®šä¹‰AIçš„æ ‡ç­¾è¯è¯­å¼ºåº¦èŒƒå›´ï¼Œæˆ‘è‡ªå·±ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨5.5</p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683166978197.jpg" alt=""></p><p>é™„åŠ æç¤ºè¯åˆ™å¯ä»¥ç†è§£ä¸ºç»™æ¯ä¸ªå›¾ç‰‡éƒ½åŠ ä¸Šä¸€ä¸ªå±äºè‡ªå·±çš„æ ‡è®°å§ï¼Œä¸æ‡‚çš„è¯å¿½ç•¥å³å¯ï¼Œç„¶åç‚¹å‡»åæ¨æç¤ºè¯ä¾¿å¯ä»¥äº†ï¼Œé»˜è®¤çš„è¾“å‡ºä¹Ÿæ˜¯ä»¥å›¾ç‰‡æ–‡ä»¶åå­—ä¸ºå‰ç¼€ä»¥txtä¸ºåç¼€ï¼Œæ²¡æœ‰æŒ‡å®šç›®å½•ä¹Ÿæ˜¯é»˜è®¤çš„å›¾ç‰‡è·¯å¾„ä¸‹è¾“å‡ºçš„</p><ol start="5"><li>å…·æœ‰ç§‘å­¦ä¸Šç½‘çš„èƒ½åŠ›(å› ä¸ºè®¿é—®Colabéœ€è¦)</li></ol></li></ul><h4 id="å¼€å§‹è®­ç»ƒ">å¼€å§‹è®­ç»ƒ</h4><p>è¯´æ˜:è¿™é‡Œçš„æ¯ä¸€å°æ­¥éª¤éƒ½è¦æ–°æ·»åŠ ä¸€ä¸ªä»£ç å•å…ƒæ ¼</p><ol><li><p>é¦–å…ˆè¿›å…¥åˆ°<a href="https://colab.research.google.com/">Colab</a> åˆ›å»ºæ–°çš„ç¬”è®°æœ¬</p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683167364878.jpg" alt=""></p></li><li><p>æ›´æ”¹è¿è¡Œç±»å‹ä¸ºGPUå¹¶ä¿å­˜</p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683167480635.jpg" alt=""></p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683167536583.jpg" alt=""> æŸ¥çœ‹GPUå’ŒæŒ‚è½½ç£ç›˜</p><p>åœ¨ä»£ç æ¡†è¾“å…¥ç„¶åç‚¹å‡»å·¦ä¸Šè§’å¯åŠ¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">!nvidia-smi</span><br><span class="line"><span class="keyword">from</span> google.colab <span class="keyword">import</span> drive</span><br><span class="line">drive.mount(<span class="string">&#x27;/content/drive/&#x27;</span>)</span><br><span class="line">!echo <span class="string">&quot;ç¡¬ç›˜æŒ‚è½½å®Œæˆ.&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼šå¼¹å‡ºè®©ä½ å…è®¸ç¬”è®°æœ¬è®¿é—®å¹¶æˆæƒåˆ°è°·æ­Œç£ç›˜ï¼Œç›´æ¥å…è®¸ç„¶åçœ‹åˆ°è¾“å‡ºç¡¬ç›˜æŒ‚è½½å®Œæˆå°±å¯ä»¥äº†</p><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683167836877.jpg" alt=""></p></li><li><p>è¿è¡Œä¸€ç³»åˆ—é…ç½®</p><ul><li>ç‚¹å‡»æ·»åŠ ä»£ç æ¡†ç„¶åè¾“å…¥åæ‰§è¡Œ</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">%cd /content/</span><br><span class="line">git_https = <span class="string">&quot;https://github.com/Akegarasu/lora-scripts&quot;</span></span><br><span class="line">!git clone --recurse-submodules &#123;git_https&#125;  /content/lora-scripts/</span><br><span class="line">!cd lora-scripts &amp;&amp; git pull &amp;&amp; git submodule update --init --recursive</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å…‹éš†å®Œæˆ ä½ å¯ä»¥åœ¨å®‰è£…ä¾èµ–æ—¶å»é…ç½®train.shæ–‡ä»¶&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment">#########</span></span><br><span class="line"><span class="comment">#è®¾ç½®train.shæ–‡ä»¶è·¯å¾„ï¼Œè¿™ä¸ªåœ¨å‡½æ•°ä¸­ä¼šè¢«ä½¿ç”¨</span></span><br><span class="line">train_sh_path = <span class="string">r&#x27;/content/lora-scripts/train.sh&#x27;</span></span><br><span class="line"><span class="comment">#########</span></span><br><span class="line"><span class="comment">#å®šä¹‰å‡½æ•°ï¼Œç¼–è¾‘train_sh_pathè·¯å¾„çš„æ–‡ä»¶ï¼Œä¸ºsearchçš„å‚æ•°èµ‹äºˆå€¼input</span></span><br><span class="line"><span class="comment">#searchä¸ºå­—ç¬¦ä¸²ï¼Œinputå¯ä»¥ä¸ºæ•°å€¼å’Œå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search_input</span>(<span class="params">search, <span class="built_in">input</span></span>):</span><br><span class="line">  <span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">  <span class="comment">#åŒ¹é…æ ‡å¿—: 1åŒ¹é…search=&quot;&quot; ï¼Œ 2åŒ¹é…search=5 ï¼Œ 3ä¸“é—¨ä¸“é—¨åŒ¹é…extArgs=()</span></span><br><span class="line">  search_type_flag = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#searchä¸æ˜¯å­—ç¬¦ä¸²å°±æŠ¥é”™</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span>( <span class="built_in">isinstance</span>(search, <span class="built_in">str</span>) ):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;éå­—ç¬¦ä¸²çš„&#x27;search&#x27;å‚æ•°&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#å¦‚æœsearchè¾“å…¥çš„æ˜¯&quot;&quot;ï¼Œåˆ™ä¸“é—¨åŒ¹é…extArgs=()</span></span><br><span class="line">  <span class="keyword">if</span> search == <span class="string">&quot;&quot;</span>:</span><br><span class="line">    search = <span class="string">&quot;extArgs&quot;</span></span><br><span class="line">    pattern = <span class="string">rf&#x27;^<span class="subst">&#123;search&#125;</span>=(\(.*?\))&#x27;</span></span><br><span class="line">    replace = <span class="string">rf&#x27;<span class="subst">&#123;search&#125;</span>=(<span class="subst">&#123;<span class="built_in">input</span>&#125;</span>)&#x27;</span></span><br><span class="line">    search_type_flag = <span class="number">3</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># å¦‚æœinputæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ŒåŒ¹é…search=&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(<span class="built_in">input</span>, <span class="built_in">str</span>):</span><br><span class="line">      <span class="comment">#pattern = rf&#x27;&#123;search&#125;=(&quot;.*?&quot;)&#x27;</span></span><br><span class="line">      <span class="comment">#replace = f&quot;&#123;search&#125;=\&quot;&#123;input&#125;\&quot;&quot;</span></span><br><span class="line">      pattern = <span class="string">rf&#x27;^<span class="subst">&#123;search&#125;</span>=(&quot;.*?&quot;)&#x27;</span></span><br><span class="line">      replace = <span class="string">rf&#x27;<span class="subst">&#123;search&#125;</span>=&quot;<span class="subst">&#123;<span class="built_in">input</span>&#125;</span>&quot;&#x27;</span></span><br><span class="line">      search_type_flag = <span class="number">1</span></span><br><span class="line">    <span class="comment"># å¦‚æœinputæ˜¯æ•°å€¼ç±»å‹ï¼ŒåŒ¹é…search= ï¼ˆå¯ä»¥åŒ¹é…å°æ•°ã€æ•´æ•°ã€ç§‘å­¦è®¡æ•°ï¼‰</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(<span class="built_in">input</span>, (<span class="built_in">int</span>, <span class="built_in">float</span>)):</span><br><span class="line">      pattern = <span class="string">rf&#x27;^<span class="subst">&#123;search&#125;</span>=([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)&#x27;</span></span><br><span class="line">      replace = <span class="string">rf&#x27;<span class="subst">&#123;search&#125;</span>=<span class="subst">&#123;<span class="built_in">input</span>&#125;</span>&#x27;</span></span><br><span class="line">      search_type_flag = <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>: <span class="comment"># å…¶ä»–æƒ…å†µï¼Œå°±è¿”å›é”™è¯¯ä¿¡æ¯ </span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;é”™è¯¯çš„åŒ¹é…input&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#ä½¿ç”¨withè¯­å¥æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶è¯»å–å†…å®¹</span></span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(train_sh_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.read()</span><br><span class="line">    re_get = re.findall(pattern, content, flags=re.MULTILINE|re.DOTALL)</span><br><span class="line">    <span class="comment">#æ£€æŸ¥æ˜¯å¦åŒ¹é…åˆ°ï¼ŒåŒ¹é…ä¸åˆ°åˆ™æŠ¥é”™å¹¶é€€å‡º</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span>(re_get):</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">f&quot;è­¦å‘Šï¼ï¼ï¼å¯¹äº&#x27;<span class="subst">&#123;search&#125;</span>&#x27;çš„æ­£åˆ™è¡¨è¾¾å¼å¹¶æœªåŒ¹é…ï¼Œè¯·æ‰‹åŠ¨è®¾ç½®è¯¥å‚æ•°ï¼Œå¹¶ç§ä¿¡æˆ‘æ›´æ–°ï¼&quot;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    <span class="comment">#å¦‚æœåŒ¹é…åˆ°äº†æ‰§è¡Œæ¥ä¸‹æ¥æ“ä½œ</span></span><br><span class="line">    <span class="comment">#ä½¿ç”¨re.subå‡½æ•°è¿›è¡Œæ›¿æ¢ï¼Œå¹¶åŠ ä¸Šre.MULTILINEæ ‡å¿—</span></span><br><span class="line">    new_content = re.sub(pattern, replace, content, flags=re.MULTILINE|re.DOTALL, count=<span class="number">1</span>)</span><br><span class="line">    <span class="comment">#å¦‚æœå†…å®¹æœªæ›´æ”¹ï¼Œæç¤ºæœªæ”¹å˜ä»¥åŠå€¼</span></span><br><span class="line">    <span class="keyword">if</span> new_content == content:</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;search&#125;</span>=<span class="subst">&#123;re_get[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    <span class="comment">#å¦‚æœæ”¹å˜åˆ™å†™å…¥ï¼Œè¾“å‡ºæ”¹å˜ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">with</span> <span class="built_in">open</span>(train_sh_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(new_content)</span><br><span class="line">      <span class="keyword">if</span> search_type_flag == <span class="number">1</span>: right = left = <span class="string">&quot;\&quot;&quot;</span></span><br><span class="line">      <span class="keyword">elif</span> search_type_flag == <span class="number">2</span>: right = left = <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="keyword">elif</span> search_type_flag == <span class="number">3</span>: right = <span class="string">&quot;)&quot;</span> ; left = <span class="string">&quot;(&quot;</span> </span><br><span class="line">      <span class="keyword">else</span>: <span class="built_in">print</span>(<span class="string">&quot;è¾“å…¥å‚æ•°é”™è¯¯&quot;</span>)</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">f&quot;å‘ç”Ÿä¿®æ”¹ï¼Œ<span class="subst">&#123;search&#125;</span>=<span class="subst">&#123;re_get[<span class="number">0</span>]&#125;</span>ç°åœ¨ä¸º<span class="subst">&#123;left&#125;</span><span class="subst">&#123;<span class="built_in">input</span>&#125;</span><span class="subst">&#123;right&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¨¡å‹è¾“å‡ºåœ°å€è¢«æ›´æ”¹è‡³&quot;/content/drive/MyDrive/Lora/output/&quot; </span></span><br><span class="line">output_dir = <span class="string">&quot;/content/drive/MyDrive/Lora/output/&quot;</span></span><br><span class="line">search_input(<span class="string">&quot;  --output_dir&quot;</span>, output_dir)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ¨¡å‹è¾“å‡ºåœ°å€é»˜è®¤è¢«æ›´æ”¹è‡³è°·æ­Œç¡¬ç›˜ï¼š<span class="subst">&#123;output_dir&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå§‹åŒ–logè¾“å‡ºè·¯å¾„</span></span><br><span class="line">logging_dir = output_dir + <span class="string">&quot;/logs&quot;</span></span><br><span class="line">search_input(<span class="string">&quot;  --logging_dir&quot;</span>, logging_dir)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;logæ—¥å¿—é»˜è®¤è¾“å‡ºè‡³è°·æ­Œç¡¬ç›˜ï¼š<span class="subst">&#123;logging_dir&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå§‹åŒ–sample_prompt.txtè·¯å¾„</span></span><br><span class="line">sample_prompt_txt_path = <span class="string">&quot;/content/lora-scripts/sample_prompt.txt&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;sample_prompt.txté»˜è®¤è·¯å¾„ä¸ºï¼š<span class="subst">&#123;sample_prompt_txt_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå§‹åŒ–è®­ç»ƒé›†è·¯å¾„</span></span><br><span class="line">train_data_dir = <span class="string">&quot;/content/lora-scripts/train/aki/&quot;</span></span><br><span class="line">search_input(<span class="string">&quot;train_data_dir&quot;</span>, train_data_dir)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è®­ç»ƒé›†å°†æ‹·è´è‡³ï¼š<span class="subst">&#123;train_data_dir&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå§‹åŒ–æ­£åˆ™åŒ–é›†è·¯å¾„</span></span><br><span class="line">reg_data_dir = <span class="string">&quot;/content/lora-scripts/train/reg/&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ­£åˆ™åŒ–é›†å°†æ‹·è´è‡³ï¼š<span class="subst">&#123;reg_data_dir&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¼ƒç”¨ä»£ç </span></span><br><span class="line"><span class="comment">#!sed -i &#x27;s/--output_dir=&quot;.\/output&quot;/--output_dir=&quot;/content/drive/MyDrive/Lora/output/&quot;/&#x27; /content/lora-scripts/train.sh</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#################################################################</span></span><br><span class="line"><span class="comment">#å£°æ˜extArgs_Contentç±»ï¼Œç”¨äºåœ¨ä¸åŒä»£ç å—ä¸­æ›´æ–°extArgsçš„å†…å®¹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExtArgsContent</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">    self.base_model = <span class="string">&quot;&quot;</span></span><br><span class="line">    self.vae = <span class="string">&quot;&quot;</span></span><br><span class="line">    self.common_parameter = <span class="string">&quot;&quot;</span></span><br><span class="line">    self.sample_parameter = <span class="string">&quot;&quot;</span></span><br><span class="line">    self.plus_parameter = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment">#åˆå¹¶å…¨éƒ¨ç±»å±æ€§å­—ç¬¦ä¸²</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">all</span>(<span class="params">self</span>):</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    attributes = self.__dict__.values()</span><br><span class="line">    <span class="keyword">for</span> attribute <span class="keyword">in</span> attributes:</span><br><span class="line">      result += attribute</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="comment">#å°†åœ¨ï¼ˆå…­ã€ä¸ƒï¼‰ä¸­è¢«ä½¿ç”¨</span></span><br><span class="line">extArgs_content = ExtArgsContent()</span><br><span class="line"></span><br><span class="line"><span class="comment">#################################################################</span></span><br><span class="line"><span class="comment">#ç”¨äºè¯»å–  --output_dir=&quot;&quot;å’Œ  --logging_dir=&quot;&quot;çš„å€¼ï¼Œæ¥ä¿®æ”¹8.2ä¸­ä¿å­˜è·¯å¾„</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search_get</span>(<span class="params">search</span>):</span><br><span class="line">  <span class="comment"># å¦‚æœinputæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ŒåŒ¹é…search=&quot;&quot;</span></span><br><span class="line">  <span class="comment">#pattern = rf&#x27;&#123;search&#125;=(&quot;.*?&quot;)&#x27;</span></span><br><span class="line">  pattern = <span class="string">rf&#x27;^<span class="subst">&#123;search&#125;</span>=(&quot;.*?&quot;)&#x27;</span></span><br><span class="line">  <span class="comment">#ä½¿ç”¨withè¯­å¥æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶è¯»å–å†…å®¹</span></span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(train_sh_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.read()</span><br><span class="line">    re_get = re.findall(pattern, content, flags=re.MULTILINE|re.DOTALL)</span><br><span class="line">    <span class="keyword">return</span> re_get[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#################################################################</span></span><br><span class="line"><span class="comment">#åˆå§‹åŒ–ï¼Œåœ¨ï¼ˆå…«ï¼‰ä¸­æ‰§è¡Œåˆ¤æ–­</span></span><br><span class="line">enable_sample = <span class="literal">False</span></span><br><span class="line">use_train_sh_self = <span class="literal">False</span></span><br><span class="line">use_sample_prompt_txt_self = <span class="literal">False</span></span><br></pre></td></tr></table></figure><ul><li><p>åˆ›å»ºè®­ç»ƒæ—¶çš„æ–‡ä»¶å¤¹</p><p>è¿™é‡Œæˆ‘è¦è¾“å‡ºçš„æ¨¡å‹ä¸ºTLailinï¼Œæ‰€ä»¥å°±ç›´æ¥å†™ä¸Šäº†ï¼Œå¦‚æœä½ è¦æ›´æ”¹çš„è¯ï¼Œåé¢å¯¹åº”çš„TLailinä¹Ÿéƒ½è¦æ›´æ”¹ä¸Šï¼Œè¾“å…¥åå¯åŠ¨è¿è¡Œï¼Œç„¶åå¯ä»¥åœ¨è¿™é‡Œä¸Šä¼ ä¹‹å‰çš„å·²å‡†å¤‡å¥½çš„å›¾ç‰‡å’ŒTaggeræ–‡ä»¶åˆ°è¿™é‡Œ</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!mkdir -pv /content/lora-scripts/train/TLailin/6_TLailin</span><br></pre></td></tr></table></figure><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683168591611.jpg" alt=""></p><ul><li>å®‰è£…ä¾èµ–ç¯å¢ƒ(è¿™é‡Œç­‰å¾…çš„æ—¶é—´ä¼šæ¯”è¾ƒé•¿)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">!sudo apt-get update -y &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">!sudo apt-get install python3<span class="number">.10</span> &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="comment">#change alternatives é¦–é€‰py3.9</span></span><br><span class="line">!sudo update-alternatives --install /usr/<span class="built_in">bin</span>/python3 python3 /usr/<span class="built_in">bin</span>/python3<span class="number">.9</span> <span class="number">1</span>  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">!sudo update-alternatives --install /usr/<span class="built_in">bin</span>/python3 python3 /usr/<span class="built_in">bin</span>/python3<span class="number">.10</span> <span class="number">2</span>  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="comment">#check python version æŸ¥çœ‹ç‰ˆæœ¬ #3.10</span></span><br><span class="line">!python --version</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pythonå‡çº§ä¸­&quot;</span>)</span><br><span class="line"><span class="comment"># install pip for new python ä¸ºpy3.10å®‰è£…pip</span></span><br><span class="line">!sudo apt-get install python3<span class="number">.10</span>-distutils  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">!wget https://bootstrap.pypa.io/get-pip.py  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">!python get-pip.py  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="comment">#install colab&#x27;s dependencies å®‰è£…colabä¾èµ–</span></span><br><span class="line">!python -m pip install ipython ipython_genutils ipykernel jupyter_console prompt_toolkit httplib2 astor  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="comment"># link to the old google package å°†py3.9çš„è°·æ­Œä¾èµ–è¿æ¥è‡³3.10</span></span><br><span class="line">!ln -s /usr/local/lib/python3<span class="number">.9</span>/dist-packages/google \</span><br><span class="line">/usr/local/lib/python3<span class="number">.10</span>/dist-packages/google  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pythonå‡çº§å®Œæˆ 1/6&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿™æ˜¯ä¸€ä¸ªå¤‡ä»½æ›´æ–°python3.10.6çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">#åˆ‡æ¢åˆ°python3.10</span></span><br><span class="line"><span class="comment">#!wget https://github.com/korakot/kora/releases/download/v0.10/py310.sh</span></span><br><span class="line"><span class="comment">#!bash ./py310.sh -b -f -p /usr/local</span></span><br><span class="line"><span class="comment">#!python -m ipykernel install --name &quot;py310&quot; --user</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################################</span></span><br><span class="line"><span class="comment">#å®‰è£…ç›¸å…³ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">pip_all_number = <span class="number">7</span></span><br><span class="line">pip_count = <span class="number">2</span></span><br><span class="line"><span class="comment">#å®‰è£…aria2</span></span><br><span class="line">!apt -qq install liblz4-tool aria2  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="comment">#å®‰è£…å…¶ä»–ä¾èµ–</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å…¶ä»–ä¾èµ–å®‰è£…ä¸­ï¼Œæ­¤æ­¥è€—æ—¶è¾ƒé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…&quot;</span>)</span><br><span class="line">%cd /content/lora-scripts/sd-scripts/</span><br><span class="line">!pip -q install --upgrade -r requirements.txt  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å…¶ä»–ä¾èµ–å®‰è£…å®Œæˆ <span class="subst">&#123;pip_count&#125;</span>/<span class="subst">&#123;pip_all_number&#125;</span>&quot;</span>)</span><br><span class="line">pip_count+=<span class="number">1</span></span><br><span class="line"><span class="comment">#å®‰è£…å…¼å®¹torch1.14.1çš„torchvision0.14.1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;torchvisionå®‰è£…ä¸­&quot;</span>)</span><br><span class="line">!pip -q install torchvision==<span class="number">0.14</span><span class="number">.1</span>  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;torchvision-0.14.1å®‰è£…å®Œæˆ <span class="subst">&#123;pip_count&#125;</span>/<span class="subst">&#123;pip_all_number&#125;</span>&quot;</span>)</span><br><span class="line">pip_count+=<span class="number">1</span></span><br><span class="line"><span class="comment">#å®‰è£…xformers 0.0.16ç‰ˆæœ¬</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;xformerså®‰è£…ä¸­&quot;</span>)</span><br><span class="line">!pip -q install xformers==<span class="number">0.0</span><span class="number">.16</span>  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;xformers-0.0.16å®‰è£…å®Œæˆ <span class="subst">&#123;pip_count&#125;</span>/<span class="subst">&#123;pip_all_number&#125;</span>&quot;</span>)</span><br><span class="line">pip_count+=<span class="number">1</span></span><br><span class="line"><span class="comment">#å®‰è£…Triton</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;tritonå®‰è£…ä¸­&quot;</span>)</span><br><span class="line">!pip -q install triton==<span class="number">2.0</span><span class="number">.0</span>.dev20221202  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Tritonå®‰è£…å®Œæˆ <span class="subst">&#123;pip_count&#125;</span>/<span class="subst">&#123;pip_all_number&#125;</span>&quot;</span>)</span><br><span class="line">pip_count+=<span class="number">1</span></span><br><span class="line"><span class="comment">#å®‰è£…lionä¼˜åŒ–å™¨ã€lycoris</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;lionä¼˜åŒ–å™¨ã€lycoriså®‰è£…ä¸­&quot;</span>)</span><br><span class="line">!pip -q install --upgrade lion-pytorch lycoris-lora  &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;lionä¼˜åŒ–å™¨ã€lycoriså®‰è£…å®Œæˆ <span class="subst">&#123;pip_count&#125;</span>/<span class="subst">&#123;pip_all_number&#125;</span>&quot;</span>)</span><br><span class="line">pip_count+=<span class="number">1</span></span><br><span class="line"><span class="comment">#å®‰è£…Dadaptionä¼˜åŒ–å™¨</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Dadaptionä¼˜åŒ–å™¨å®‰è£…ä¸­&quot;</span>)</span><br><span class="line">!pip -q install dadaptation   &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Dadaptionä¼˜åŒ–å™¨å®‰è£…å®Œæˆ <span class="subst">&#123;pip_count&#125;</span>/<span class="subst">&#123;pip_all_number&#125;</span>&quot;</span>)</span><br><span class="line">pip_count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#############################</span></span><br><span class="line"><span class="comment">#å¼€å¯tensorboard</span></span><br><span class="line">%load_ext tensorboard</span><br></pre></td></tr></table></figure><ul><li>ä¸‹è½½è®­ç»ƒåº•æ¨¡ï¼Œç‚¹å‡»é€‰æ‹©å°±å¯ä»¥äº†ï¼Œä¸æ˜¯å¾ˆäº†è§£çš„è¯ç›´æ¥è¿è¡Œå°±å¯ä»¥</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#@title ### 6.1 ä¸‹è½½æ¨¡å‹</span></span><br><span class="line">installModels = []</span><br><span class="line">installv2Models = []</span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown ####**é€‰æ‹©ä¼˜å…ˆçº§ä»ä¸Šåˆ°ä¸‹ï¼Œæ¯”å¦‚è¯´ä½ æƒ³è‡ªå®šä¹‰é“¾æ¥ï¼Œåˆ™éœ€è¦ä¿æŒä¸¤ä¸ªé¢„è®¾æ¨¡å‹ä¸ºç©º**</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown **é¢„è®¾å‰ªææ¨¡å‹ï¼ˆ`Animefull-final-pruned`å³NovelAIå®˜æ¨¡ ï¼Œ `Stable-Diffusion-v1-5`å³SD1.5ï¼‰**</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown SD1.x model</span></span><br><span class="line">modelName = <span class="string">&quot;Animefull-final-pruned&quot;</span>  <span class="comment"># @param [&quot;&quot;, &quot;Animefull-final-pruned&quot;, &quot;Stable-Diffusion-v1-5&quot;, &quot;Anything-v3-1&quot;, &quot;AnyLoRA&quot;, &quot;AnimePastelDream&quot;, &quot;Chillout-mix&quot;, &quot;OpenJourney-v4&quot;]</span></span><br><span class="line"><span class="comment">#@markdown SD2.x model</span></span><br><span class="line">v2ModelName = <span class="string">&quot;&quot;</span>  <span class="comment"># @param [&quot;&quot;, &quot;stable-diffusion-2-1-base&quot;, &quot;stable-diffusion-2-1-768v&quot;, &quot;plat-diffusion-v1-3-1&quot;, &quot;replicant-v1&quot;, &quot;illuminati-diffusion-v1-0&quot;, &quot;illuminati-diffusion-v1-1&quot;, &quot;waifu-diffusion-1-4-anime-e2&quot;, &quot;waifu-diffusion-1-5-e2&quot;, &quot;waifu-diffusion-1-5-e2-aesthetic&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown **è‡ªå®šä¹‰æ¨¡å‹é“¾æ¥ä¾‹å¦‚`https://huggingface.co/a1079602570/animefull-final-pruned/resolve/main/novelailatest-pruned.ckpt`ï¼‰**</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown **æˆ–è€…è‡ªå®šä¹‰æ¨¡å‹è·¯å¾„ä¾‹å¦‚`/content/drive/MyDrive/Lora/model/your_model.ckpt`**</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown **å¦‚æœè¿æ¥æˆ–è€…è·¯å¾„ä¸­åŒ…å«æ¨¡å‹çš„æ‰©å±•å(æ¯”å¦‚æˆ‘ç»™å‡ºçš„ä¸¤ä¸ªä¾‹å¦‚çš„æœ«å°¾éƒ½æœ‰æ‰©å±•å)ï¼Œåˆ™ä¼šè‡ªåŠ¨æŒ‡å®šï¼Œå¦åˆ™ä½ éœ€è¦æ‰‹åŠ¨é€‰æ‹©**</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown - **æ³¨æ„ï¼ŒColabæ™®é€šç”¨æˆ·ä»…èƒ½é€‰æ‹©5Gä»¥ä¸‹çš„æ¨¡å‹**</span></span><br><span class="line"></span><br><span class="line">base_model_url = <span class="string">&quot;https://civitai.com/api/download/models/37521&quot;</span> <span class="comment">#@param &#123;type:&quot;string&quot;&#125;</span></span><br><span class="line"></span><br><span class="line">base_model_self_dir = <span class="string">&quot;&quot;</span> <span class="comment">#@param &#123;type:&quot;string&quot;&#125;</span></span><br><span class="line"></span><br><span class="line">base_model_extension = <span class="string">&quot;ckpt&quot;</span> <span class="comment">#@param [&quot;ckpt&quot;, &quot;safetensors&quot;, &quot;pt&quot;]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">modelUrl = [</span><br><span class="line">    <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/Linaqruf/personal-backup/resolve/main/models/animefull-final-pruned.ckpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/cag/anything-v3-1/resolve/main/anything-v3-1.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/Lykon/AnyLoRA/resolve/main/AnyLoRA_noVae_fp16.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/Lykon/AnimePastelDream/resolve/main/AnimePastelDream_Soft_noVae_fp16.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/Linaqruf/stolen/resolve/main/pruned-models/chillout_mix-pruned.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/prompthero/openjourney-v4/resolve/main/openjourney-v4.ckpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/Linaqruf/stolen/resolve/main/pruned-models/stable_diffusion_1_5-pruned.safetensors&quot;</span>,</span><br><span class="line">]</span><br><span class="line">modelList = [</span><br><span class="line">    <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Animefull-final-pruned&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Anything-v3-1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AnyLoRA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AnimePastelDream&quot;</span>,    </span><br><span class="line">    <span class="string">&quot;Chillout-mix&quot;</span>,</span><br><span class="line">    <span class="string">&quot;OpenJourney-v4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Stable-Diffusion-v1-5&quot;</span>,</span><br><span class="line">]</span><br><span class="line">v2ModelUrl = [</span><br><span class="line">    <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/stabilityai/stable-diffusion-2-1-base/resolve/main/v2-1_512-ema-pruned.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/stabilityai/stable-diffusion-2-1/resolve/main/v2-1_768-ema-pruned.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/p1atdev/pd-archive/resolve/main/plat-v1-3-1.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/gsdf/Replicant-V1.0/resolve/main/Replicant-V1.0.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/IlluminatiAI/Illuminati_Diffusion_v1.0/resolve/main/illuminati_diffusion_v1.0.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/4eJIoBek/Illuminati-Diffusion-v1-1/resolve/main/illuminatiDiffusionV1_v11.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/hakurei/waifu-diffusion-v1-4/resolve/main/wd-1-4-anime_e2.ckpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/waifu-diffusion/wd-1-5-beta2/resolve/main/checkpoints/wd-1-5-beta2-fp32.safetensors&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/waifu-diffusion/wd-1-5-beta2/resolve/main/checkpoints/wd-1-5-beta2-aesthetic-fp32.safetensors&quot;</span>,</span><br><span class="line">]</span><br><span class="line">v2ModelList = [</span><br><span class="line">    <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stable-diffusion-2-1-base&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stable-diffusion-2-1-768v&quot;</span>,</span><br><span class="line">    <span class="string">&quot;plat-diffusion-v1-3-1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;replicant-v1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;illuminati-diffusion-v1-0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;illuminati-diffusion-v1-1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;waifu-diffusion-1-4-anime-e2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;waifu-diffusion-1-5-e2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;waifu-diffusion-1-5-e2-aesthetic&quot;</span>,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">if</span> modelName:</span><br><span class="line">    installModels.append((modelName, modelUrl[modelList.index(modelName)]))</span><br><span class="line"><span class="keyword">if</span> v2ModelName:</span><br><span class="line">    installv2Models.append((v2ModelName, v2ModelUrl[v2ModelList.index(v2ModelName)]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸‹è½½è·¯å¾„</span></span><br><span class="line">base_model_dir = <span class="string">&quot;/content/lora-scripts/sd-models/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ£€æŸ¥è¿æ¥æ˜¯å¦å«æœ‰æ‰©å±•åä¿¡æ¯ï¼Œä¸å«æœ‰åˆ™ç”±ç”¨æˆ·æŒ‡å®š</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ext</span>(<span class="params">url</span>):</span><br><span class="line">  <span class="keyword">if</span> url.endswith(<span class="string">&quot;.ckpt&quot;</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ckpt&quot;</span></span><br><span class="line">  <span class="keyword">elif</span> url.endswith(<span class="string">&quot;.safetensors&quot;</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;safetensors&quot;</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> base_model_extension</span><br><span class="line"><span class="comment">#ä¸‹è½½æ¨¡å‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">install</span>(<span class="params">checkpoint_name, url</span>):</span><br><span class="line">    ext = check_ext(url)</span><br><span class="line">    hf_token = <span class="string">&quot;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&quot;</span></span><br><span class="line">    user_header = <span class="string">f&#x27;&quot;Authorization: Bearer <span class="subst">&#123;hf_token&#125;</span>&quot;&#x27;</span></span><br><span class="line">    !aria2c --console-log-level=error --summary-interval=<span class="number">10</span> --header=&#123;user_header&#125; -c -x <span class="number">16</span> -k 1M -s <span class="number">16</span> -d &#123;base_model_dir&#125; -o &#123;checkpoint_name&#125;.&#123;ext&#125; &#123;url&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;checkpoint_name&#125;</span>.<span class="subst">&#123;ext&#125;</span>&quot;</span>   <span class="comment">#è¿”å›æ¨¡å‹åç§°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">install_checkpoint</span>():</span><br><span class="line">    <span class="keyword">for</span> model <span class="keyword">in</span> installModels:</span><br><span class="line">        <span class="keyword">return</span> install(model[<span class="number">0</span>], model[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> v2model <span class="keyword">in</span> installv2Models:</span><br><span class="line">        <span class="keyword">return</span> install(v2model[<span class="number">0</span>], v2model[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#å°è¯•ä¸‹è½½é¢„è®¾æ¨¡å‹</span></span><br><span class="line">base_model_name = install_checkpoint()</span><br><span class="line"><span class="comment">#é¢„è®¾ä¸‹è½½æˆåŠŸï¼Œåˆ™å®Œæˆè·¯å¾„ä¿®æ”¹</span></span><br><span class="line"><span class="keyword">if</span> base_model_name:</span><br><span class="line">  pretrained_model = base_model_dir + base_model_name</span><br><span class="line"><span class="comment">#ä¸‹è½½å¤±è´¥ï¼Œbase_model_nameä¸ºnon</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  <span class="comment">#ä¸ç•™ç©ºï¼Œåˆ™å°è¯•ç”¨è¿æ¥ä¸‹è½½</span></span><br><span class="line">  <span class="keyword">if</span> base_model_url:</span><br><span class="line">    base_model_name = <span class="string">&quot;download.&quot;</span> + check_ext(base_model_url)</span><br><span class="line">    pretrained_model = base_model_dir + base_model_name</span><br><span class="line">    !aria2c --console-log-level=error --summary-interval=<span class="number">10</span> -c -x <span class="number">16</span> -k 1M -s <span class="number">16</span> -d &#123;base_model_dir&#125; -o &#123;base_model_name&#125; --allow-overwrite &#123;base_model_url&#125;</span><br><span class="line">  <span class="comment">#ç•™ç©ºï¼Œå°†è€ƒè™‘ä»è‡ªå®šä¹‰è·¯å¾„ä¸­æ‹·è´</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">if</span> base_model_self_dir:</span><br><span class="line">      base_model_name = <span class="string">&quot;self.&quot;</span> + check_ext(base_model_self_dir)</span><br><span class="line">      pretrained_model = base_model_dir + base_model_name</span><br><span class="line">      !cp &#123;base_model_self_dir&#125; &#123;pretrained_model&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;ä½ æ ¹æœ¬æ²¡é€‰æ‹©ä»»ä½•æ¨¡å‹ï¼&quot;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿®æ”¹train.shçš„åº•æ¨¡è·¯å¾„ï¼Œå¹¶è¾“å‡ºä¿¡æ¯</span></span><br><span class="line">search_input(<span class="string">&quot;pretrained_model&quot;</span>, pretrained_model)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å‡ºæ¨¡å‹ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ä½ é€‰æ‹©çš„æ˜¯: <span class="subst">&#123;base_model_name&#125;</span> æ¨¡å‹&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>æŒ‡å®šä½¿ç”¨çš„å¤–æŒ‚Vaeï¼Œè¿˜æ˜¯ä¸€æ ·ï¼Œä¸äº†è§£çš„è¯ç›´æ¥é€‰æˆ‘æ¨èçš„animeç„¶åç›´æ¥è¿è¡Œå³å¯</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @title ## 6.2 ä¸‹è½½vaeï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å‚¨å­˜ä¸‹è½½ä¿¡æ¯å‚æ•°</span></span><br><span class="line">installVae = []</span><br><span class="line"><span class="comment">#@markdown é€‰æ‹© `none` æ„å‘³ç€ä¸ä½¿ç”¨vae</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown é€‰æ‹©ä¸€ä¸ªVaeä¸‹è½½å¹¶ä½¿ç”¨`&quot;animevae.pt&quot;, &quot;kl-f8-anime.ckpt&quot;, &quot;vae-ft-mse-840000-ema-pruned.ckpt&quot;`</span></span><br><span class="line"></span><br><span class="line">vaeUrl = [</span><br><span class="line">    <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/Linaqruf/personal-backup/resolve/main/vae/animevae.pt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/hakurei/waifu-diffusion-v1-4/resolve/main/vae/kl-f8-anime.ckpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://huggingface.co/stabilityai/sd-vae-ft-mse-original/resolve/main/vae-ft-mse-840000-ema-pruned.ckpt&quot;</span>,</span><br><span class="line">]</span><br><span class="line">vaeList = [<span class="string">&quot;none&quot;</span>, <span class="string">&quot;anime.vae.pt&quot;</span>, <span class="string">&quot;waifudiffusion.vae.pt&quot;</span>, <span class="string">&quot;stablediffusion.vae.pt&quot;</span>]</span><br><span class="line">vaeName = <span class="string">&quot;anime.vae.pt&quot;</span>  <span class="comment"># @param [&quot;none&quot;, &quot;anime.vae.pt&quot;, &quot;waifudiffusion.vae.pt&quot;, &quot;stablediffusion.vae.pt&quot;]</span></span><br><span class="line"></span><br><span class="line">installVae.append((vaeName, vaeUrl[vaeList.index(vaeName)]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¼€å§‹ä¸‹è½½</span></span><br><span class="line">vae_dir = <span class="string">&quot;/content/lora-scripts/vae/&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">install</span>(<span class="params">vae_name, url</span>):</span><br><span class="line">    hf_token = <span class="string">&quot;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&quot;</span></span><br><span class="line">    user_header = <span class="string">f&#x27;&quot;Authorization: Bearer <span class="subst">&#123;hf_token&#125;</span>&quot;&#x27;</span></span><br><span class="line">    !aria2c --console-log-level=error --allow-overwrite --summary-interval=<span class="number">10</span> --header=&#123;user_header&#125; -c -x <span class="number">16</span> -k 1M -s <span class="number">16</span> -d &#123;vae_dir&#125; -o <span class="string">&quot;vae.pt&quot;</span> <span class="string">&quot;&#123;url&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">install_vae</span>():</span><br><span class="line">    <span class="keyword">if</span> vaeName != <span class="string">&quot;none&quot;</span>:</span><br><span class="line">        <span class="keyword">for</span> vae <span class="keyword">in</span> installVae:</span><br><span class="line">            install(vae[<span class="number">0</span>], vae[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">install_vae()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">extArgs_content.vae = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment">#ä¿®æ”¹train.shä¸­å‚æ•°</span></span><br><span class="line"><span class="keyword">if</span> vaeName == <span class="string">&quot;none&quot;</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;ä¸ä½¿ç”¨vae&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;ä½¿ç”¨<span class="subst">&#123;vaeName&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="comment">#å†™å…¥é‡‡æ ·åœ°å€f&quot;--vae=&#123;vae_dir&#125;&quot;</span></span><br><span class="line">  extArgs_content.vae += <span class="string">f&quot;\&quot;--vae=<span class="subst">&#123;vae_dir&#125;</span>vae.pt\&quot; &quot;</span></span><br><span class="line"></span><br><span class="line">search_input(<span class="string">&quot;&quot;</span>, extArgs_content.<span class="built_in">all</span>() )</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹è„šæœ¬è¿è¡Œå‚æ•°</li></ul><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683169164742.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹é¢æ˜¯è¦ä¿®æ”¹çš„é…ç½®,æ²¡æœ‰æ³¨é‡Šçš„è¯å°±ç›´æ¥è·Ÿç€æˆ‘å¤åˆ¶æ›´æ”¹è¿›å»å°±å¯ä»¥</span></span><br><span class="line">train_data_dir=<span class="string">&quot;/content/lora-scripts/train/TLailin/&quot;</span><span class="comment">#è¿™é‡Œæ”¹æˆåˆšæ‰åˆ›å»ºæ–‡ä»¶å¤¹çš„åå­—</span></span><br><span class="line">resolution=<span class="string">&quot;512,512&quot;</span><span class="comment"># è¿™é‡Œæ”¹æˆä½ å‡†å¤‡çš„å›¾ç‰‡çš„åˆ†è¾¨ç‡</span></span><br><span class="line">batch_size=<span class="number">1</span></span><br><span class="line">max_train_epoches=<span class="number">20</span></span><br><span class="line">output_name=<span class="string">&quot;TLailin&quot;</span><span class="comment"># æƒ³è¦è¾“å‡ºçš„æ¨¡å‹å</span></span><br><span class="line"></span><br><span class="line">min_bucket_reso=<span class="number">256</span></span><br><span class="line">max_bucket_reso=<span class="number">1920</span></span><br><span class="line"><span class="comment"># è¿™ä¸¤ä¸ªå‚æ•°æ˜¯è¦æ ¹æ®ä½ å‡†å¤‡çš„å›¾ç‰‡çš„åˆ†è¾¨ç‡æ¥è°ƒçš„,maxçš„å¯ä»¥ç›´æ¥æ‹‰åˆ°æœ€é«˜1920ï¼Œä½†æ˜¯minæ˜¯è¦åœ¨ä½ çš„æœ€ä½åˆ†è¾¨ç‡å¾€ä¸‹æˆ–è€…ä¸€æ ·,æ¯”å¦‚è¯´æˆ‘ç°åœ¨å‡†å¤‡çš„å›¾ç‰‡åˆ†è¾¨ç‡æ˜¯1280,1408ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘çš„min_bucket_resoæœ€é«˜å°±åªèƒ½å¡«1280</span></span><br></pre></td></tr></table></figure><ul><li>è¾“å…¥å¯åŠ¨å¼€å§‹è¿è¡Œ</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#@title  ### 8.2å¼€å§‹è®­ç»ƒ</span></span><br><span class="line"><span class="comment">#@markdown è‹¥æ­£ç¡®è¿è¡Œï¼Œè®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹ä¼šè‡ªåŠ¨ä¿å­˜è‡³ä½ çš„è°·æ­Œç¡¬ç›˜ä¸­`æˆ‘çš„äº‘ç«¯ç¡¬ç›˜/Lora/output/`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown å¦‚æœä¸åˆ°1åˆ†é’Ÿå°±è¿è¡Œå®Œäº†ï¼Œå¤šåŠæ˜¯å‡ºé”™äº†ï¼ŒæŠŠè¾“å‡ºä¿¡æ¯å¤åˆ¶åˆ°ChatGPTé—®ä¸‹ç½¢ï¼ :(</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown - Qï¼šè¾“å‡ºä»£ç çš„æœ€åå‡ºç°ï¼ˆkill:9ï¼‰å­—æ · </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown - Aï¼šçˆ†ramäº†ï¼Œæ›´æ¢å°çš„åº•æ¨¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown ---</span></span><br><span class="line"><span class="comment">#@markdown æ˜¯å¦ä¿å­˜æœ¬æ¬¡è®­ç»ƒçš„train.shå’Œé‡‡æ ·é…ç½®ï¼ˆå¦‚æœä½ å¯ç”¨é‡‡æ ·åŠŸèƒ½çš„è¯ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#@markdown ä¿å­˜è·¯å¾„ï¼š `ç•™ç©ºåˆ™ä¿å­˜è‡³å½“å‰train.shä¸­æŒ‡å®šçš„è¾“å‡ºè·¯å¾„`</span></span><br><span class="line">save_files = <span class="literal">True</span> <span class="comment">#@param &#123;type:&quot;boolean&quot;&#125;</span></span><br><span class="line">save_files_dir_self = <span class="string">&quot;&quot;</span> <span class="comment">#@param &#123;type:&quot;string&quot;&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> save_files:</span><br><span class="line">  <span class="comment">#æŒ‡å®šä¿å­˜è·¯å¾„</span></span><br><span class="line">  <span class="keyword">if</span> save_files_dir_self:</span><br><span class="line">    save_files_dir = save_files_dir_self</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ä½ æŒ‡å®šäº†è‡ªå®šä¹‰çš„é…ç½®ä¿å­˜è·¯å¾„ï¼š<span class="subst">&#123;save_files_dir&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    save_files_dir = search_get(<span class="string">&quot;  --output_dir&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;é‡‡ç”¨trian.shä¸­æŒ‡å®šçš„è¾“å‡ºè·¯å¾„ï¼š<span class="subst">&#123;save_files_dir&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="comment">#ä¿å­˜è®­ç»ƒå‚æ•°æ–‡ä»¶è‡³è°·æ­Œç¡¬ç›˜</span></span><br><span class="line">  !mkdir -p &#123;save_files_dir&#125;</span><br><span class="line">  !cp &#123;train_sh_path&#125; &#123;save_files_dir&#125;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;è®­ç»ƒå‚æ•°è¢«ä¿å­˜è‡³<span class="subst">&#123;save_files_dir&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="comment">#ä¿å­˜é‡‡æ ·å‚æ•°æ–‡ä»¶è‡³è°·æ­Œç¡¬ç›˜</span></span><br><span class="line">  <span class="keyword">if</span> enable_sample <span class="keyword">or</span> use_sample_prompt_txt_self:</span><br><span class="line">    !cp &#123;sample_prompt_txt_path&#125; &#123;save_files_dir&#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;é‡‡æ ·å‚æ•°è¢«ä¿å­˜è‡³<span class="subst">&#123;save_files_dir&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æœªå¯ç”¨é‡‡æ ·åŠŸèƒ½ï¼Œä¸ä¿å­˜é‡‡æ ·é…ç½®&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;ä¸ä¿å­˜é…ç½®æ–‡ä»¶&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¼€å§‹è®­ç»ƒï¼</span></span><br><span class="line">%cd /content/lora-scripts/</span><br><span class="line">!bash train.sh</span><br><span class="line"></span><br><span class="line">!echo <span class="string">&quot;å®Œæˆäº† XXXD.&quot;</span></span><br></pre></td></tr></table></figure><p>åé¢å°±æ˜¯æ¼«é•¿çš„ç­‰å¾…å•¦</p><ul><li><p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯Colabä¸€æ—¦å…³é—­å°±å¾ˆå¤§æ¦‚ç‡ä¼šè¿ä¸ä¸Šï¼Œè¿ä¸ä¸Šçš„è¯ä¼šé‡ç½®ç¬”è®°æœ¬ï¼Œä¹Ÿå°±ä¼šå‰åŠŸå°½å¼ƒï¼Œæ‰€ä»¥åœ¨è¿è¡Œçš„æ—¶å€™ä½ è¦æ—¶åˆ»ä¿æŒç€ç§‘å­¦ä¸Šç½‘ï¼Œè€Œä¸”è¦åœ¨æ§åˆ¶å°è¾“å…¥åˆ·æ–°ä»£ç é˜²æ­¢ä¸­é€”ç»™ä½ å¡å‡ºä¸ªéªŒè¯</p></li><li><p>æŒ‰F12å¼€å¯æ§åˆ¶å°ï¼Œé€‰æ‹©Consoleï¼Œç„¶ååœ¨æœ€ä¸‹é¢ç²˜è´´ä¸‹é¢ç»™å‡ºçš„ä»£ç å¹¶å›è½¦å°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function getElementByXpath(path) &#123;</span><br><span class="line">       <span class="keyword">return</span> document.evaluate(path, document, null, </span><br><span class="line">       XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">function reconnect()&#123;</span><br><span class="line">  console.log(<span class="string">&#x27;working&#x27;</span>)</span><br><span class="line">  getElementByXpath(<span class="string">&quot;//div[@id=&#x27;top-toolbar&#x27;]/colab-connect-button&quot;</span>).click()</span><br><span class="line">&#125;</span><br><span class="line">var a = setInterval(reconnect, <span class="number">1</span>*<span class="number">60</span>*<span class="number">1000</span>);</span><br><span class="line">function stop()&#123;</span><br><span class="line"> clearInterval(a)</span><br><span class="line">&#125;</span><br><span class="line">function start()&#123;</span><br><span class="line"> a = setInterval(reconnect, <span class="number">1</span>*<span class="number">60</span>*<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/%7B40I%5DMXKPDUHE@U2$SKAR_M.png" alt=""></p></li></ul></li></ol><h4 id="Loraçš„ä½¿ç”¨">Loraçš„ä½¿ç”¨</h4><p>æŠŠè¾“å‡ºåˆ°googleç£ç›˜ä¸­çš„è®­ç»ƒå¥½çš„æ¨¡å‹ä¸‹è½½ä¸‹æ¥ç„¶åæ”¾åœ¨SD_ROOT/models/Loraç›®å½•ä¸‹ç„¶ååˆ·æ–°Web UIç•Œé¢å°±ï¼ŒLoraçš„ä½¿ç”¨åªéœ€è¦ä½ ç‚¹å‡»<br><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683189185284.png" alt=""><br><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683189426645.jpg" alt=""><br>ç„¶åç‚¹å‡»è‡ªå·±çš„Loraæ¨¡å‹ï¼Œå°±ä¼šè‡ªåŠ¨å†™å…¥åˆ°æ­£å‘æç¤ºè¯å•¦ï¼Œå…¶ä»–çš„æŒ‰å¹³æ—¶çš„SDæ“ä½œæ¥å°±å¯ä»¥äº†ã€‚<br>è¿™é‡Œæˆ‘æœ‰ä¸Šä¼ è‡ªå·±çš„æ¨¡å‹åˆ°Cç«™ä¸­,åˆ†åˆ«æ˜¯è½»å°è¯´é‡Œçš„è§’è‰²è‰¾ç³å’Œæ²™å­£</p><style>.stars_box {    display: flex;    gap: 15px;    flex-wrap: wrap;    justify-content: center;}.stars_box .card_box {    margin: 0px !important}@media screen and (max-width: 768px) {    .stars_box{        padding: 0 5px    }    .stars_box .card_box {        width: calc(100%/2 - 8px) !important;        height: 240px !important;        margin: 8px 0 !important    }}html.hide-aside .layout > div:first-child {    width: 90%;}@media screen and (max-width: 768px).layout > div:first-child:not(.recent-posts) {    padding: 0px 14px !important;}.layout > div:first-child:not(.recent-posts) {    padding: 0px 12px!important;}</style><div class="stars_box"><div title="ä¸æ—¶è½»å£°åœ°ä»¥ä¿„è¯­é®ç¾çš„é‚»åº§è‰¾è‰åŒå­¦" referrerPolicy="no-referrer" class="card_box" style="background-image: url(https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1679060367555.png); width:200px; height:275px;">    <div class="card_mask">      <span>æ­¤ä½œå“åšä¸»æš‚æœªä½œå‡ºè¯„ä»·</span>      <a href="https://zh.moegirl.org.cn/%E4%B8%8D%E6%97%B6%E8%BD%BB%E5%A3%B0%E5%9C%B0%E4%BB%A5%E4%BF%84%E8%AF%AD%E9%81%AE%E7%BE%9E%E7%9A%84%E9%82%BB%E5%BA%A7%E8%89%BE%E8%8E%89%E5%90%8C%E5%AD%A6">æŸ¥çœ‹è¯¦æƒ…</a>    </div>    <div class="card_top">      <i class=""></i>      <span>è½»å°è¯´</span>    </div>    <div class="card_content">      <span>ä¸æ—¶è½»å£°åœ°ä»¥ä¿„è¯­é®ç¾çš„é‚»åº§è‰¾è‰åŒå­¦</span>      <div><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>    </div>  </div><div title="ä¹‰å¦¹ç”Ÿæ´»" referrerPolicy="no-referrer" class="card_box" style="background-image: url(https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/qxssj.jpg); width:200px; height:275px;">    <div class="card_mask">      <span>æ­¤ä½œå“åšä¸»æš‚æœªä½œå‡ºè¯„ä»·</span>      <a href="https://zh.moegirl.org.cn/%E4%B9%89%E5%A6%B9%E7%94%9F%E6%B4%BB">æŸ¥çœ‹è¯¦æƒ…</a>    </div>    <div class="card_top">      <i class=""></i>      <span>è½»å°è¯´</span>    </div>    <div class="card_content">      <span>ä¹‰å¦¹ç”Ÿæ´»</span>      <div><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>    </div>  </div></div><div class="note warning simple"><p>PS: é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼ä¸è¦ä½¿ç”¨æ­¤æ¨¡å‹ç”»18+çš„å›¾ç‰‡ï¼ï¼ï¼ä¸è¦ä½¿ç”¨æ­¤æ¨¡å‹ç”»18+çš„å›¾ç‰‡ï¼ï¼ï¼ä¸è¦ä½¿ç”¨æ­¤æ¨¡å‹ç”»18+çš„å›¾ç‰‡ï¼ï¼</p></div><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1683190141926.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Lora</div>  <p>åˆ†åˆ«æ˜¯è‰¾ç³å’Œç»«æ¿‘æ²™å­£</p>  <a href='https://civitai.com/user/Tianlin/models'></a>  </figcaption>  </figure>  </div><div class="note warning simple"><p>æœ¬æ¨¡å‹ä»…é™äºä¸ªäººå­¦ä¹ å’Œéå•†ä¸šç”¨é€”ã€‚ä½œè€…æä¾›çš„æ¨¡å‹æ²¡æœ‰ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„ä¿è¯å’Œæ‹…ä¿ï¼Œä½œè€…ä¸å¯¹ä»»ä½•ç”±äºä½¿ç”¨æœ¬æ¨¡å‹æ‰€å¼•èµ·çš„ç›´æ¥ã€é—´æ¥ã€å¶ç„¶ã€ç‰¹æ®ŠåŠåæœæ€§æŸå¤±æˆ–å…¶ä»–ä»»ä½•ç±»å‹çš„æŸå¤±æ‰¿æ‹…è´£ä»»ã€‚ä½¿ç”¨è€…åº”å¯¹ä½¿ç”¨æœ¬æ¨¡å‹æ‰€å¼•èµ·çš„é£é™©æ‰¿æ‹…å®Œå…¨è´£ä»»ï¼Œä½œè€…ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹ä¹‰åŠ¡å’Œèµ”å¿è´£ä»»</p></div>]]></content>
    
    
    <summary type="html">SDä½¿ç”¨å’ŒLoraæ¨¡å‹è®­ç»ƒ</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
    <category term="AI" scheme="https://www.linjiangyu.com/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>æ—¥å¿—è½®è¯¢</title>
    <link href="https://www.linjiangyu.com/posts/3f7ad5be.html"/>
    <id>https://www.linjiangyu.com/posts/3f7ad5be.html</id>
    <published>2023-03-14T11:27:14.000Z</published>
    <updated>2023-11-27T01:42:42.511Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ—¥å¿—è½®è¯¢">æ—¥å¿—è½®è¯¢</h3><h4 id="æ„ä¹‰">æ„ä¹‰</h4><ul><li>1.æ—¥å¿—è½®è¯¢å¯ä»¥ç¡®ä¿ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ä¸ä¼šæ— é™å¢é•¿ï¼Œä»¥å…å½±å“ç³»ç»Ÿæ€§èƒ½å¹¶å ç”¨è¿‡å¤šçš„ç£ç›˜ç©ºé—´ã€‚é€šè¿‡å®šæœŸè½®è¯¢æ—¥å¿—æ–‡ä»¶ï¼Œæ—§çš„æ—¥å¿—ä¿¡æ¯å¯ä»¥å¾—åˆ°ä¿ç•™ï¼Œä»è€Œä¸ºæ•…éšœæ’é™¤å’Œæ€§èƒ½åˆ†ææä¾›é‡è¦çš„å†å²æ•°æ®</li><li>2.æ—¥å¿—è½®è¯¢å¯ä»¥å°†æ—¥å¿—æ–‡ä»¶åˆ†å‰²ä¸ºå¤šä¸ªè¾ƒå°çš„æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶åŒ…å«ä¸€æ®µæ—¶é—´å†…çš„æ—¥å¿—ä¿¡æ¯ã€‚è¿™å°†ä½¿æ—¥å¿—æ£€ç´¢æ›´åŠ é«˜æ•ˆï¼Œå› ä¸ºåªéœ€è¦æœç´¢ç‰¹å®šæ—¶é—´æ®µå†…çš„æ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦æœç´¢æ•´ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚è¿™ä¹Ÿæœ‰åŠ©äºåŠ å¿«æ•…éšœæ’é™¤å’Œæ€§èƒ½åˆ†æçš„é€Ÿåº¦</li><li>3.æ—¥å¿—è½®è¯¢å¯ä»¥ä½¿æ—¥å¿—ç®¡ç†å’Œç»´æŠ¤æ›´åŠ æ–¹ä¾¿ã€‚ç”±äºæ¯ä¸ªæ—¥å¿—æ–‡ä»¶éƒ½åŒ…å«ä¸€æ®µæ—¶é—´èŒƒå›´å†…çš„æ—¥å¿—ä¿¡æ¯ï¼Œå› æ­¤å¯ä»¥è½»æ¾åœ°å¯¹ç‰¹å®šæ—¶é—´æ®µå†…çš„æ—¥å¿—è¿›è¡Œå¤‡ä»½ã€å‹ç¼©ã€å½’æ¡£æˆ–åˆ é™¤ã€‚æ­¤å¤–ï¼Œæ—¥å¿—è½®è¯¢è¿˜å¯ä»¥å¸®åŠ©è¯†åˆ«å’Œä¿®å¤æ—¥å¿—æ–‡ä»¶ä¸­çš„é”™è¯¯æˆ–æŸå</li></ul><h4 id="å®æ“">å®æ“</h4><ul><li>example<ul><li>æ—¥å¿—æ–‡ä»¶/var/log/messagesä¸€æœˆä¸€è½®è¯¢</li><li>æ—¥å¿—æ–‡ä»¶å¤§äº10Mæ—¶ï¼Œç›´æ¥ä¸»åŠ¨è¿›è¡Œè½®è¯¢ä¸éœ€è¦è€ƒè™‘ä¸€æœˆä¸€è½®è¯¢</li><li>ä¿å­˜5ä¸ªå¤‡ä»½æ–‡ä»¶</li><li>å¤‡ä»½æ–‡ä»¶éœ€è¦å‹ç¼©<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chattr +a /var/log/messages</span></span><br><span class="line"><span class="comment"># vim /etc/logrotate.d/messages        # å®šä¹‰è½®è¯¢è§„åˆ™</span></span><br><span class="line">/var/log/<span class="section">messages</span> &#123;</span><br><span class="line">        <span class="attribute">monthly</span><span class="comment"># æ¯ä¸ªæœˆè¿›è¡Œä¸€æ¬¡</span></span><br><span class="line">        size=<span class="number">8M</span><span class="comment"># æ–‡ä»¶å®¹é‡å¤§äº10Mæ—¶å¼€å§‹è½®è¯¢</span></span><br><span class="line">        rotate  <span class="number">5</span><span class="comment"># ä¿ç•™äº”ä¸ªæ–‡ä»¶</span></span><br><span class="line">        compress<span class="comment"># è¿›è¡Œå‹ç¼©</span></span><br><span class="line">        sharedscripts</span><br><span class="line">        prerotate</span><br><span class="line">                /usr/bin/chattr -a /var/log/messages</span><br><span class="line">        endscript</span><br><span class="line">        sharedscripts</span><br><span class="line">        postrotate</span><br><span class="line">                /bin/kill -HUP `cat /var/run/syslogd.pid <span class="number">2</span>&gt;/dev/null` <span class="number">2</span>&gt;/dev/null || <span class="literal">true</span></span><br><span class="line">                /usr/bin/chattr +a /var/log/messages</span><br><span class="line">        endscript</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># logrotate -vf /etc/logrotate.conf   // æŸ¥çœ‹è½®è¯¢</span></span><br><span class="line">// å¯ä»¥é€šè¿‡åˆ«çš„æ–‡ä»¶é‡å®šå‘åˆ°/var/log/messagesä¸­è®©æ–‡ä»¶è¾¾åˆ°<span class="number">10M</span>å¤§å°æµ‹è¯•è½®è¯¢</span><br></pre></td></tr></table></figure></li></ul></li></ul>]]></content>
    
    
    <summary type="html">æ—¥å¿—è½®è¯¢</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>HTTP/3æ–°ä¼˜åŠ¿</title>
    <link href="https://www.linjiangyu.com/posts/3b54fb61.html"/>
    <id>https://www.linjiangyu.com/posts/3b54fb61.html</id>
    <published>2023-03-03T08:41:41.000Z</published>
    <updated>2023-11-27T01:42:42.511Z</updated>
    
    <content type="html"><![CDATA[<h3 id="HTTP3">HTTP3</h3><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>HTTP/1.x</p>            </div><ul><li>å¼€å§‹ä¾¿æœ‰äº†é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼Œè¯·æ±‚å¤´éƒ¨æœªç»å‹ç¼©ä¾¿å‘é€ï¼Œè€Œä¸”å‘é€å†—é•¿çš„é¦–éƒ¨æ¯æ¬¡è¿˜ä¼šå‘å‡ºé‡å¤çš„ä¸ºå‹ç¼©å¤´éƒ¨æŠ¥æ–‡ã€‚<ul><li>æŒ‰é¡ºåºè¯·æ±‚å“åº”çš„ï¼Œå¦‚æœæœåŠ¡å™¨å“åº”æ…¢ä¼šå¯¼è‡´åé¢çš„æ•°æ®é˜»å¡ã€‚</li></ul><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>HTTP/2</p>            </div></li><li>å¤´éƒ¨å‹ç¼©ï¼ŒHTTP/2 é€šè¿‡ Stream çš„å¹¶å‘èƒ½åŠ›ï¼Œè§£å†³äº†é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼Œä½†æ˜¯å´å¡åœ¨äº†TCPè¿™ä¸€å±‚ã€‚<ul><li>TCPå±‚å¿…é¡»ä¿è¯æ”¶åˆ°çš„å­—èŠ‚æ•°æ®æ˜¯å®Œæ•´ä¸”è¿ç»­çš„å¦‚æœå½“å‰å­—èŠ‚æ²¡æœ‰åˆ°è¾¾æ—¶åé¢çš„å­—èŠ‚åªèƒ½æš‚æ—¶å­˜æ”¾åœ¨ç¼“å†²åŒºä¸­ç­‰å¾…è¿™ä¸ªå­—èŠ‚åˆ°è¾¾ï¼Œè¿™å°±æ˜¯HTTP2çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚</li></ul><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>HTTP/3</p>            </div></li><li>ä½¿ç”¨äº†ä»¥ä¸å¯é ä¼ è¾“åè®®UDPä¸ºåŸºæœ¬çš„UQICå¯é åè®®ã€‚<ul><li>QUICåè®®çš„æŸä¸ªæµå‘ç”Ÿä¸¢åŒ…æ—¶ï¼Œåªä¼šé˜»å¡è¿™ä¸ªæµï¼Œå…¶ä»–æµä¸ä¼šå—åˆ°å½±å“ï¼Œå› æ­¤ä¸å­˜åœ¨é˜Ÿå¤´é˜»å¡é—®é¢˜</li><li>æ›´å¿«çš„å»ºç«‹è¿æ¥ï¼Œæ¯”èµ·HTTP2çš„é¦–å…ˆè¦ç»è¿‡TCPæ¡æ‰‹ç„¶åå†TLSæ¡æ‰‹ï¼ŒQUICå†…éƒ¨ä¾¿åŒ…å«äº†TLSï¼Œä¼šåœ¨è‡ªå·±çš„å¸§ä¸­æºå¸¦TLSé‡Œçš„&quot;è®°å½•&quot;,åŠ ä¸ŠQUICä½¿ç”¨çš„æ˜¯TLS1.3ï¼Œæ‰€ä»¥è¿æ¥çš„å»ºç«‹ä¹Ÿä¼šæ›´å¿«ã€‚</li></ul></li></ul>]]></content>
    
    
    <summary type="html">HTTP/3æ–°ä¼˜åŠ¿</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>ç»™å‹é“¾é¡µé¢æ·»åŠ ä¸€ä¸ªSakana~</title>
    <link href="https://www.linjiangyu.com/posts/e5482ed2.html"/>
    <id>https://www.linjiangyu.com/posts/e5482ed2.html</id>
    <published>2023-02-27T00:28:49.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h2 id="ç»™hexoåšå®¢æ·»åŠ ä¸€ä¸ªSakana">ç»™hexoåšå®¢æ·»åŠ ä¸€ä¸ªSakana~</h2></div></div><div class='checkbox'><input type="radio" />            <h3 id="æ¥è‡ªå¼€æºé¡¹ç›®itorr-sakana">æ¥è‡ªå¼€æºé¡¹ç›®<a href="https://github.com/itorr/sakana/">itorr/sakana</a></h3>            </div><div class='checkbox'><input type="radio" />            <p>åŒ<a href="https://naokuoteng.cn/">è„‘é˜”ç–¼ï»©Ù¥</a>ä¸€åŒåˆ¶ä½œå®Œæˆ</p>            </div><details class="folding-tag" cyan open orange><summary> æ•ˆæœå¦‚ä¸‹ </summary>              <div class='content'>              <div class="hide-block"><button type="button" class="hide-button" style="background-color: orange;">é¢„è§ˆç‚¹æˆ‘     </button><div class="hide-content"><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/sakana.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div></div></div><div class="site-card-group"><a class="site-card" href="https://blog.linjiangyu.com/link/"><div class="img"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/saka.png"/></div><div class="info"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/><span class="title">Tianlin</span><span class="desc">æˆ‘çš„ç«™ç‚¹</span></div></a></div>              </div>            </details><h3 id="æ•™ç¨‹">æ•™ç¨‹</h3><div class='checkbox'><input type="radio" />            <p>å†™å…¥åˆ°root_blog\themes\butterfly\source\css\custom.cssæ–‡ä»¶ä¸­å¹¶å¼•ç”¨</p>            </div><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> <span class="selector-class">.sakana-box</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">100%</span> <span class="number">100%</span>; <span class="comment">/* ä»å³ä¸‹å¼€å§‹å˜æ¢ */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sakana-box</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>)&#123;</span><br><span class="line">  <span class="selector-class">.sakana-box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>)&#123;</span><br><span class="line">  <span class="selector-tag">html</span> <span class="selector-class">.sakana-box</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: inherit;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">36%</span> <span class="number">160%</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-class">.layout</span> &gt; <span class="selector-tag">div</span><span class="selector-pseudo">:first</span>-child<span class="selector-pseudo">:not</span>(<span class="selector-class">.recent-posts</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, .<span class="number">8</span>);</span><br><span class="line">    -webkit-backdrop-<span class="attribute">filter</span>: none;</span><br><span class="line">    backdrop-<span class="attribute">filter</span>: none<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.layout</span> &gt; <span class="selector-tag">div</span><span class="selector-pseudo">:first</span>-child<span class="selector-pseudo">:not</span>(<span class="selector-class">.recent-posts</span>) &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">15</span>, <span class="number">15</span>, <span class="number">15</span>, .<span class="number">75</span>);</span><br><span class="line">    -webkit-backdrop-<span class="attribute">filter</span>: none;</span><br><span class="line">    backdrop-<span class="attribute">filter</span>: none<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">html</span><span class="selector-class">.hide-aside</span> <span class="selector-class">.layout</span> &gt; <span class="selector-tag">div</span><span class="selector-pseudo">:first</span>-child &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">90%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class='checkbox'><input type="radio" />            <p>ç›´æ¥å†™å…¥åˆ°root_blog\source\link\index.mdæ–‡ä»¶ä¸­</p>            </div><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;sakana-box&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;script <span class="attribute">src</span>=&quot;https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/js/sakana.js<span class="string">&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">Sakana.init(&#123;</span></span><br><span class="line"><span class="string">  el:         &#x27;.sakana-box&#x27;,     // å¯åŠ¨å…ƒç´  node æˆ– é€‰æ‹©å™¨</span></span><br><span class="line"><span class="string">  scale:      .5,                // ç¼©æ”¾å€æ•°</span></span><br><span class="line"><span class="string">  canSwitchCharacter: true,      // å…è®¸æ¢è§’è‰²</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><div class='checkbox'><input type="radio" />            <p>ä¿®æ”¹root_blog\themes\butterfly_config.yml</p>            </div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line"><span class="string">+</span>    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;&gt;</span></span><br><span class="line"><span class="string">......</span></span><br><span class="line"><span class="attr">pjax:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line"><span class="string">+</span>    <span class="bullet">-</span> <span class="string">/link/</span></span><br><span class="line">    <span class="comment"># - xxxx</span></span><br><span class="line">    <span class="comment"># - xxxx</span></span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªSakanaäº†~</p><div class='checkbox'><input type="radio" />            <h3 id="è¿™é‡Œæˆ‘è¿˜ç»™Heoçš„éŸ³ä¹æ’­æ”¾å™¨åŠ ä¸Šäº†">è¿™é‡Œæˆ‘è¿˜ç»™<a href="https://github.com/zhheo/HeoMusic">Heoçš„éŸ³ä¹æ’­æ”¾å™¨</a>åŠ ä¸Šäº†</h3>            </div><details class="folding-tag" cyan open orange><summary> æ•ˆæœå¦‚ä¸‹ </summary>              <div class='content'>              <div class="hide-block"><button type="button" class="hide-button" style="background-color: orange;">é¢„è§ˆç‚¹æˆ‘     </button><div class="hide-content"><p><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1677466852471.png" alt=""></p></div></div><div class="site-card-group"><a class="site-card" href="https://music.linjiangyu.com/"><div class="img"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/1677466852471.png"/></div><div class="info"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/><span class="title">å¿ƒçµåº‡æŠ¤æ‰€</span><span class="desc">æˆ‘çš„ç«™ç‚¹</span></div></a></div>              </div>            </details><div class='checkbox'><input type="radio" />            <p>ä¿®æ”¹index.htmlæ–‡ä»¶</p>            </div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-icon-precomposed&quot;</span> <span class="attr">sizes</span>=<span class="string">&quot;180x180&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./img/icon-r.webp&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;å¿µå¿µä¸å¿˜ å¿…æœ‰å›å“&quot;</span>&gt;</span></span><br><span class="line">+  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">+  <span class="selector-tag">html</span> <span class="selector-class">.sakana-box</span>&#123;</span></span><br><span class="line"><span class="language-css">+    <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">+    <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">+    <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">+    <span class="attribute">transform-origin</span>: <span class="number">100%</span> <span class="number">100%</span>; <span class="comment">/* ä»å³ä¸‹å¼€å§‹å˜æ¢ */</span></span></span><br><span class="line"><span class="language-css">+  &#125;</span></span><br><span class="line"><span class="language-css">+  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">......</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/APlayer.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/Meting2.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">data-pjax</span> <span class="attr">src</span>=<span class="string">&quot;./js/main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">+  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;sakana-box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">+  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/linjiangyu2/halo/js/sakana.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">+  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">+  <span class="comment">// å–æ¶ˆé™éŸ³</span></span></span><br><span class="line"><span class="language-javascript">+  <span class="title class_">Sakana</span>.<span class="title function_">setMute</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">+  <span class="comment">// å¯åŠ¨</span></span></span><br><span class="line"><span class="language-javascript">+  <span class="title class_">Sakana</span>.<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">+    <span class="attr">el</span>:         <span class="string">&#x27;.sakana-box&#x27;</span>,     <span class="comment">// å¯åŠ¨å…ƒç´  node æˆ– é€‰æ‹©å™¨</span></span></span><br><span class="line"><span class="language-javascript">+    <span class="attr">scale</span>:      <span class="number">.5</span>,                <span class="comment">// ç¼©æ”¾å€æ•°</span></span></span><br><span class="line"><span class="language-javascript">+    <span class="attr">canSwitchCharacter</span>: <span class="literal">true</span>,      <span class="comment">// å…è®¸æ¢è§’è‰²</span></span></span><br><span class="line"><span class="language-javascript">+  &#125;);</span></span><br><span class="line"><span class="language-javascript">+  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git add index.html</span></span><br><span class="line"><span class="comment"># git commit -m &#x27;none&#x27;</span></span><br><span class="line"><span class="comment"># git push</span></span><br></pre></td></tr></table></figure><p>æ¨åˆ°githubå°±å¯ä»¥äº†</p>]]></content>
    
    
    <summary type="html">ç»™åšå®¢å‹é“¾é¡µé¢æ·»åŠ ä¸€ä¸ªSakana~</summary>
    
    
    
    <category term="é­”æ”¹æ•™ç¨‹" scheme="https://www.linjiangyu.com/categories/%E9%AD%94%E6%94%B9%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="butterfly" scheme="https://www.linjiangyu.com/tags/butterfly/"/>
    
  </entry>
  
  <entry>
    <title>kvm-qemuè™šæ‹ŸåŒ–</title>
    <link href="https://www.linjiangyu.com/posts/2388a20a.html"/>
    <id>https://www.linjiangyu.com/posts/2388a20a.html</id>
    <published>2023-02-25T12:13:51.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<p>ç¼–å†™ä¸­â€¦</p>]]></content>
    
    
    <summary type="html">kvm-qemuè™šæ‹ŸåŒ–</summary>
    
    
    
    <category term="è¿ç»´" scheme="https://www.linjiangyu.com/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://www.linjiangyu.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ç¼“å­˜ä»£ç†ä¸­é—´ä»¶squid</title>
    <link href="https://www.linjiangyu.com/posts/e56cd95.html"/>
    <id>https://www.linjiangyu.com/posts/e56cd95.html</id>
    <published>2023-02-25T00:48:36.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="ç¼–è¯‘å®‰è£…">ç¼–è¯‘å®‰è£…</h3></div><div class="note default orange simple"><h4 id="ç¼–è¯‘å‚æ•°">ç¼–è¯‘å‚æ•°</h4></div><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--preifxï¼šæŒ‡å®šå®‰è£…è·¯å¾„</span><br><span class="line">--sysconfdirï¼šæŒ‡å®šé…ç½®æ–‡ä»¶ç›®å½•</span><br><span class="line">--enable-arp-aclï¼šå¯ä»¥åœ¨è§„åˆ™ä¸­è®¾ç½®ä¸ºç›´æ¥é€šè¿‡å®¢æˆ·ç«¯MACè¿›è¡Œç®¡ç†ï¼Œé˜²æ­¢å®¢æˆ·ç«¯ä½¿ç”¨IPæ¬ºéª—</span><br><span class="line">--enable-linux-netfilterï¼šä½¿ç”¨å†…æ ¸è¿‡æ»¤</span><br><span class="line">--enable-linux-tproxyï¼šæ”¯æŒé€æ˜æ¨¡å¼</span><br><span class="line">--enable-async-io=100ï¼šå¼‚æ­¥I/Oï¼Œæå‡å­˜å‚¨æ€§èƒ½ï¼Œç›¸å½“äº --enable-<span class="attribute">pthreads</span>   --enable-storeio=ufs,aufs</span><br><span class="line">--enable-err-language=<span class="string">&quot;Simplify_Chinese&quot;</span>ï¼šæŠ¥é”™æ—¶æ˜¾ç¤ºçš„è¯­éŸ³ï¼Œè¿™é‡ŒæŒ‡å®šä¸ºChinese</span><br><span class="line">--enable-underscoreï¼šå…è®¸URLä¸­æœ‰ä¸‹åˆ’çº¿</span><br><span class="line">--enable-<span class="literal">poll</span>ï¼šä½¿ç”¨Poll()æ¨¡å¼ï¼Œæå‡æ€§èƒ½</span><br><span class="line">--enable-gnuregexï¼šä½¿ç”¨GUNæ­£åˆ™è¡¨è¾¾å¼</span><br></pre></td></tr></table></figure><div class="note default orange simple"><h4 id="ç¼–è¯‘">ç¼–è¯‘</h4></div><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># useradd -r -s /sbin/nologin -M squid</span></span><br><span class="line"><span class="comment"># tar xf squid-release.tar.gz</span></span><br><span class="line"><span class="comment"># cd squid-release</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local/squid --sysconfdir=/usr/local/squid/conf --enable-arp-acl --enable-linux-netfilter --enable-linux-tproxy --enable-async-io=100 --enable-err-language=&quot;Simplify_Chinese&quot; --enable-underscore --enable-poll --enable-gnuregex</span></span><br><span class="line"><span class="comment"># make -j2 &amp;&amp; make install</span></span><br><span class="line"><span class="comment"># usradd -r -s /sbin/nologin -M squid</span></span><br><span class="line"><span class="comment"># chown -R squid. /usr/local/squid</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># vim /etc/init.d/squid.sh</span></span><br><span class="line"><span class="attribute">export</span> SQUID_HOME=/usr/local/squid</span><br><span class="line">export PATH=<span class="variable">$&#123;SQUID_HOME&#125;</span>/sbin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># source !$</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><h4 id="unit">unit</h4></div><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat &gt; /usr/lib/systemd/system/squid.service &lt;&lt;END</span></span><br><span class="line"><span class="comment"># /usr/lib/systemd/system/squid.service</span></span><br><span class="line"><span class="comment"># author: linjiangyu</span></span><br><span class="line"><span class="comment"># cc: https://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=<span class="attribute">Unit</span> squid by linjiangyu</span><br><span class="line">Documentation=https://linjiangyu.com/squid</span><br><span class="line">After=network-online.target nss-lookup.target remote-fs.target</span><br><span class="line">Wants=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">PIDFile=/usr/local/squid/var/run/squid.pid</span><br><span class="line">ExecStart=/usr/local/squid/sbin/squid -f /usr/local/squid/conf/squid.conf</span><br><span class="line">ExecReload=/bin/kill -s HUP <span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/bin/kill -s QUIT <span class="variable">$MAINPID</span></span><br><span class="line">User=squid</span><br><span class="line">Group=squid</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">END</span><br></pre></td></tr></table></figure><div class="note default orange simple"><h4 id="æœåŠ¡å¯åŠ¨å‰å…ˆä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶è®©squidç”¨æˆ·å¯åŠ¨æœåŠ¡">æœåŠ¡å¯åŠ¨å‰å…ˆä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶è®©squidç”¨æˆ·å¯åŠ¨æœåŠ¡</h4></div><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /usr/local/squid/conf/squid.conf</span></span><br><span class="line"><span class="attribute">cache_effective_user</span>squid</span><br><span class="line">cache_effective_groupsquid</span><br><span class="line">cache_dir ufs /usr/local/squid/var/cache/squid <span class="number">100</span> <span class="number">16</span> <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl daemon-reload</span></span><br><span class="line"><span class="comment"># systemctl start squid.service</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ç¼“å­˜ä»£ç†ä¸­é—´ä»¶squid</summary>
    
    
    
    <category term="æœåŠ¡é›†ç¾¤" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/"/>
    
    
  </entry>
  
  <entry>
    <title>å¤šçº¿ç¨‹è§£å‹ç¼©ä¹‹pigz</title>
    <link href="https://www.linjiangyu.com/posts/d932a11.html"/>
    <id>https://www.linjiangyu.com/posts/d932a11.html</id>
    <published>2023-02-24T09:23:41.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<div class="note default orange simple"><p>ç°åœ¨éƒ½æ˜¯å¤šæ ¸çš„é«˜æ€§èƒ½æœåŠ¡å™¨ï¼Œå¦‚æœè¿˜ä¸€ç›´å•ä½¿ç”¨tarçš„è¯å¯å°±å¤ªæäº†</p></div><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum install -y pigz</span></span><br></pre></td></tr></table></figure><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>Options</p>            </div><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-<span class="attribute">b</span> è®¾ç½®å‹ç¼©å—å¤§å°(default <span class="number">128k</span>)</span><br><span class="line">-d è§£å‹</span><br><span class="line">-k ä¸åˆ é™¤åŸå§‹æ–‡ä»¶</span><br><span class="line">-I è¾“å‡ºå‹ç¼©ç›®å½•</span><br><span class="line">-p æœ€å¤§ä½¿ç”¨çº¿ç¨‹æ•°</span><br><span class="line">-q ä¸è¾“å‡ºä¿¡æ¯</span><br><span class="line">-r é€’å½’</span><br><span class="line">-S ä½¿ç”¨sssåç¼€æ›¿æ¢gz</span><br><span class="line">-v æ˜¾ç¤ºè§£å‹ç¼©è¿‡ç¨‹</span><br></pre></td></tr></table></figure><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>Example</p>            </div><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar --use-compress-program=&quot;pigz -k -p4&quot; k.tar.gz ./k</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å¤šçº¿ç¨‹è§£å‹ç¼©ä¹‹pigz</summary>
    
    
    
    <category term="è¿ç»´" scheme="https://www.linjiangyu.com/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
  </entry>
  
  <entry>
    <title>swapä½¿ç”¨è¿‡åº¦åæœ</title>
    <link href="https://www.linjiangyu.com/posts/6f3762be.html"/>
    <id>https://www.linjiangyu.com/posts/6f3762be.html</id>
    <published>2022-12-28T13:57:08.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<p>###SWAPä½¿ç”¨è¿‡å¤šçš„åæœ</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">swap</span>æ˜¯ä½¿ç”¨ç£ç›˜ç©ºé—´åˆ¶ä½œçš„äº¤æ¢åˆ†åŒºï¼Œä¸€èˆ¬åœ¨æœºå™¨çš„ç‰©ç†å†…å­˜ä¸å¤Ÿä½¿ç”¨æ—¶æ‰ä¼šæŠŠéƒ¨åˆ†æ¯”è¾ƒä¸æ´»è·ƒæ•°æ®æš‚æ—¶ç¼“å­˜åœ¨<span class="keyword">swap</span>åˆ†åŒºä¸­</span><br></pre></td></tr></table></figure><ul><li>ç®€å•ä¸¾ä¸€ä¸‹ä¾‹å­<ul><li>åœ¨ä¸€ä¸ªè¿ç»´çš„äº¤æµç¾¤é‡Œé¢æœ‰äººè¯´ä»–çš„1Gå†…å­˜æœåŠ¡å™¨åˆ’åˆ†äº†8Gçš„swapç©ºé—´ç„¶åè·‘äº†<strong>gitlab</strong>å’Œ8ä¸ª<strong>java</strong>æœåŠ¡å’Œ<strong>cicd</strong>(æˆ‘çº¯è·¯äºº)</li></ul></li></ul><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸è¯´JavaæœåŠ¡çš„å†…å­˜èµ·ä¼äº†ï¼Œå°±å•èŠèŠè¿™ä¸ªgitlabï¼Œå®˜æ–¹æ¨èçš„æœ€ä½é…ç½®æ˜¯<span class="number">2</span>æ ¸<span class="number">4</span>Gæ‰å¯ä»¥è·‘ï¼Œæˆ‘åœ¨è™šæ‹Ÿæœºçš„æµ‹è¯•ä¸­<span class="number">4</span>Gä¹Ÿæ˜¯è¿œè¿œä¸å¤Ÿç»™gitlabä½¿ç”¨ï¼Œä¸ªäººæ„Ÿè§‰æœ€å°‘ç»™ä¸ª<span class="number">8</span>Gæ‰èƒ½å‹‰å¼ºä½¿ç”¨ï¼Œæ¯•ç«Ÿå¯åŠ¨ä¾¿è¦<span class="number">2</span>Gå†…å­˜ï¼ˆä½¿ç”¨dockerå®‰è£…çš„å¯èƒ½ä¼šåä½ä¸€äº›ä½†æ˜¯ä¸ä¼šä½åˆ°å“ªå»ï¼‰</span><br><span class="line"></span><br><span class="line">æœ¬æ¥æ˜¯åœ¨å†…å­˜ä¸­éƒ½éœ€è¦ä¿åº•ç‚¹è¯´<span class="number">6</span>Gçš„å†…å­˜ï¼Œåœ¨çœŸå®å†…å­˜åªæœ‰<span class="number">1</span>Gçš„äº‘æœåŠ¡å™¨ä¸Šå’Œ<span class="number">8</span>Gçš„<span class="keyword">swap</span>ç©ºé—´ï¼Œè¦æ€ä¹ˆä½¿ç”¨å‘¢ï¼Œå…¶ä¸­<span class="number">5</span>Gçš„å†…å­˜éœ€æ±‚<span class="number">8</span>Gçš„<span class="keyword">swap</span>ç©ºé—´è¦æ€ä¹ˆé¡¶æ›¿ï¼Œä¼—æ‰€å‘¨çŸ¥å†…å­˜çš„é€Ÿåº¦æ— æ¯”çš„å¿«ï¼Œåº•éƒ¨æ˜¯ç£ç›˜å­˜å‚¨çš„<span class="keyword">swap</span>è¦æ‰¿æ‹…å…¶ä¸­<span class="number">5</span>Gå†…å­˜ç©ºé—´çš„å¿«é€Ÿé¢‘ç¹çš„è¯»å†™æ“ä½œä¼šå¯¼è‡´æœºå™¨çš„ç£ç›˜IOç¹å¿™ï¼Œè‡ªç„¶ä¾¿ä¼šæå¤§é™ä½æ“ä½œç³»ç»Ÿçš„è¿è¡Œé€Ÿç‡ï¼Œç”šè‡³å¯¼è‡´å®•æœºï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆk8sç¦æ­¢ä½¿ç”¨<span class="keyword">swap</span>çš„éƒ¨åˆ†åŸå› </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">swapä½¿ç”¨è¿‡åº¦çš„åæœ</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>cpio</title>
    <link href="https://www.linjiangyu.com/posts/35144386.html"/>
    <id>https://www.linjiangyu.com/posts/35144386.html</id>
    <published>2022-12-08T02:05:45.000Z</published>
    <updated>2023-11-27T01:42:42.512Z</updated>
    
    <content type="html"><![CDATA[<div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="cpio">cpio</h3></div></div><div class="note default orange simple"><p>ä¼˜ç‚¹: å¯ä»¥å¤‡ä»½ä»»ä½•çš„æ–‡ä»¶</p><p>ç¼ºç‚¹: éœ€è¦é…åˆåˆ«çš„å‘½ä»¤æ‰èƒ½å®ç°</p></div><h4 id="command">command</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cpio <span class="literal">-ovcB</span> &gt; [<span class="type">file</span>|<span class="type">device</span>]        //å¤‡ä»½</span><br><span class="line">cpio <span class="literal">-ivcdu</span> &lt; [<span class="type">file</span>|<span class="type">device</span>]       //è¿˜åŸ</span><br><span class="line">cpio <span class="literal">-ivct</span> &lt; [<span class="type">file</span>|<span class="type">device</span>]        //æŸ¥çœ‹</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤‡ä»½ä¼šä½¿ç”¨åˆ°çš„å‚æ•°</span></span><br><span class="line"><span class="literal">-o</span>   å°†æ•°æ®å¤åˆ¶è¾“å‡ºåˆ°æ–‡ä»¶æˆ–è®¾å¤‡ä¸Š</span><br><span class="line"><span class="literal">-B</span>   è®©é»˜è®¤çš„blockså¯ä»¥å¢åŠ è‡³<span class="number">5120</span>å­—èŠ‚(é»˜è®¤æ˜¯<span class="number">512</span>å­—èŠ‚),å¯ä»¥è®©å¤§æ–‡ä»¶çš„å­˜å‚¨é€Ÿåº¦åŠ å¿«</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿˜åŸä¼šä½¿ç”¨åˆ°çš„å‚æ•°</span></span><br><span class="line"><span class="literal">-i</span>   å°†æ•°æ®è‡ªæ–‡æˆ–è®¾å¤‡å¤åˆ¶å‡ºæ¥</span><br><span class="line"><span class="literal">-d</span>   è‡ªåŠ¨å»ºç«‹ç›®å½•,ä½¿ç”¨cpioæ‰€å¤‡ä»½çš„å†…å®¹ä¸è§å¾—ä¼šåœ¨åŒä¸€å±‚ç›®å½•ä¸­,æ‰€ä»¥è¦è®©cpioåœ¨å¤åˆ¶çš„æ—¶å€™å¯ä»¥è‡ªå·±åˆ›å»ºç›®å½•</span><br><span class="line"><span class="literal">-u</span>   è‡ªåŠ¨æŠŠæ–°æ–‡ä»¶è¦†ç›–æ—§æ–‡ä»¶</span><br><span class="line"><span class="literal">-t</span>   é…åˆ<span class="literal">-i</span>æŸ¥çœ‹ä»¥cpioå»ºç«‹çš„æ–‡ä»¶æˆ–è®¾å¤‡çš„ä½ å†…å®¹</span><br><span class="line"><span class="literal">-v</span>   æ˜¾ç¤ºè¿‡ç¨‹</span><br><span class="line"><span class="literal">-c</span>   ä»¥portable formatæ–¹å¼å­˜å‚¨</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>example:</p><p>å¤‡ä»½/bootç›®å½•ä¸­çš„å†…å®¹</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /</span></span><br><span class="line"><span class="comment"># find boot | cpio -ocvB &gt; /opt/boot.cpio       //æ‰“åŒ…</span></span><br><span class="line">è¿™é‡Œç»å¯¹ä¸èƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„(æ‰€ä»¥ä½¿ç”¨findå‘½ä»¤çš„æ—¶å€™åœ¨/ä¸‹è¿è¡Œå‡ºæ¥å°±ä¼šæ˜¯./PATH),è¦ä¸ç„¶è§£åŒ…çš„æ—¶å€™cpioä¼šè‡ªåŠ¨æŠŠæ•°æ®è§£åŒ…è¦†ç›–åŸç›®å½•</span><br><span class="line"><span class="comment"># cd</span></span><br><span class="line"><span class="comment"># cpio /opt/boot.cpio &lt; /opt/boot.cpio   //è§£åŒ…åˆ°å½“å‰ç›®å½•</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>äº‹å®ä¸Šcpioå¯ä»¥æŠŠä¸€æ•´ä¸ªç³»ç»Ÿçš„æ•°æ®å®Œæ•´çš„å¤‡ä»½åˆ°å…‰ç›˜ä¸­</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find / | cpio -ocvB &gt; /dev/st0     //å¤‡ä»½</span></span><br><span class="line"><span class="comment"># cpio -idvc &lt; /dev/st0              //è¿˜åŸ</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">cpio</summary>
    
    
    
    <category term="LinuxåŸºç¡€" scheme="https://www.linjiangyu.com/categories/Linux%E5%9F%BA%E7%A1%80/"/>
    
    
  </entry>
  
  <entry>
    <title>dd</title>
    <link href="https://www.linjiangyu.com/posts/a97191d.html"/>
    <id>https://www.linjiangyu.com/posts/a97191d.html</id>
    <published>2022-12-08T01:51:53.000Z</published>
    <updated>2023-11-27T01:42:42.512Z</updated>
    
    <content type="html"><![CDATA[<div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="dd">dd</h3></div></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">lsblk</span></span><br><span class="line">/dev/sdb10G</span><br><span class="line">/dev/sdc10G</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mkfs.xfs /dev/sdb</span> </span><br><span class="line">/dev/sdcæ˜¯ä½œä¸ºè¦å¤åˆ¶çš„&quot;è·¯å¾„&quot;è®¾å¤‡,ä¸éœ€è¦æ ¼å¼åŒ–æˆxfsæ–‡ä»¶ç³»ç»Ÿ,ddå‘½ä»¤å¯ä»¥å°†æºå—è®¾å¤‡çš„ç£ç›˜åˆ†åŒºä¸Šæ‰‡åŒºçš„æ•°æ®æ•´ä¸ªå¤åˆ¶,è¿åŒè¶…çº§åŒºå—ã€å¯åŠ¨æ‰‡åŒºã€å…ƒæ•°æ®å’ŒUUIDéƒ½ä¼šä¸€è‡´å¤åˆ¶</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mkdir</span> /&#123;sdb,sdc&#125; -v</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mount /dev/sdb /sdb</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mounr /dev/sdc /sdc</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> -a /etc/. /sdb/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/sdb of=/dev/sdc  //ç›´æ¥æŠŠ/dev/sdbè®¾å¤‡å—å¤åˆ¶åˆ°/dev/sdc,ä¸æŒ‡å®šbs</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">xfs_repair -L /dev/sdc      //è®©æ—¥å¿—æ–‡ä»¶å½’é›¶,æ¸…ç†ä¸€ä¸‹æ—¥å¿—</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">xfs_admin -U `uuid` /dev/sdc    //é‡æ–°æŒ‡å®šä¸€ä¸‹UUID,å› ä¸ºä½¿ç”¨<span class="built_in">dd</span>å‘½ä»¤æ‹·è´çš„æ—¶å€™è¿UUIDä¹Ÿä¸€å¹¶æ‹·è´ç›¸åŒäº†</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mount /dev/sdc /sdc        //æŸ¥çœ‹ä¸€ä¸‹å¤åˆ¶è¿‡æ¥çš„å’Œ/dev/sdbè®¾å¤‡ä¸Šçš„æ•°æ®æ˜¯å¦ä¸€è‡´</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">dd</summary>
    
    
    
    <category term="LinuxåŸºç¡€" scheme="https://www.linjiangyu.com/categories/Linux%E5%9F%BA%E7%A1%80/"/>
    
    
  </entry>
  
  <entry>
    <title>ç§äººäº‘ç›˜ä¹‹Alist</title>
    <link href="https://www.linjiangyu.com/posts/e7cd4481.html"/>
    <id>https://www.linjiangyu.com/posts/e7cd4481.html</id>
    <published>2022-11-22T20:54:36.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="Alist">Alist</h3></div></div><details class="folding-tag" ><summary> é¢„è§ˆ </summary>              <div class='content'>              <div class="hide-block"><button type="button" class="hide-button" style="background-color: orange;">æ•ˆæœé¢„è§ˆ     </button><div class="hide-content"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/temp/alist.jpg"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/temp/al.png"/></div></div></div></div>              </div>            </details><p>è¯¦æƒ…çœ‹<a href="https://alist.nn.ci/">Alist</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">curl -fsSL <span class="string">&quot;https://alist.nn.ci/v3.sh&quot;</span> | bash -s install// æ–°æ‰‹ä½¿ç”¨ä¸€é”®è„šæœ¬å®‰è£…æ˜¯æœ€ç®€å•çš„å•¦</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é»˜è®¤è¿è¡Œåœ¨5244ç«¯å£ï¼Œæˆ‘è¿™é‡Œæ˜¯åŸºäºåŸŸåçš„å¤šhttpsæœåŠ¡ï¼Œåé¢å¯èƒ½ä¼šå†™ä¸Š</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é»˜è®¤äºŒè¿›åˆ¶æ–‡ä»¶å­˜æ”¾åœ¨äº†/opt/alistä¸‹ï¼Œè¿™é‡Œè¦è·å–ä¸€ä¸‹åˆå§‹å¯†ç </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /opt/alist</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./alist admin  <span class="comment"># ä¼šæ˜¾ç¤ºä½ çš„åˆå§‹å¯†ç ï¼Œè®°å½•èµ·æ¥</span></span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>Alisté»˜è®¤æ”¯æŒäº†æœ¬åœ°å­˜å‚¨çš„æŒ‚è½½å’Œå¤šç§å½“å‰æ¯”è¾ƒæµè¡Œçš„ç½‘ç›˜æŒ‚è½½ä¾‹å¦‚ç™¾åº¦ç½‘ç›˜ï¼Œé˜¿é‡Œäº‘ç›˜ç­‰ç­‰ï¼Œä½†å’Œæˆ‘éƒ½æ²¡å…³ç³»å› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯å¤©ç¿¼äº‘ç›˜</p></div><details class="folding-tag" cyan open><summary> å¤©ç¿¼äº‘ç›˜æŒ‚è½½ </summary>              <div class='content'>              <p>é¦–å…ˆåœ¨pcç½‘é¡µç«¯ç™»é™†ä¸Šå¤©ç¿¼äº‘ç›˜,è®¾ç½®å¥½å¯†ç ,è¿›å…¥åˆ°æƒ³è¦æŒ‚è½½çš„ç›®å½•ä¸‹ï¼ŒæŸ¥çœ‹å½“å‰ç½‘å€çš„æœ€åä¸€ä¸²æ•°å­—ä¾¿æ˜¯æ–‡ä»¶å¤¹ID<br>åƒæˆ‘ä¸€æ ·æŒ‚è½½çš„ä¹Ÿæ˜¯å¤©ç¿¼äº‘ç›˜ä¸­alistä¸‹çš„ç›®å½•ï¼Œè¿›å…¥åˆ°alistç›®å½•ç„¶åæŸ¥çœ‹</p><div class="hide-block"><button type="button" class="hide-button" style="background-color: orange;">é¢„è§ˆ    </button><div class="hide-content"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/temp/1669152925609.png"/></div></div></div></div><p>è¿™é‡Œæˆ‘é®æ‰çš„é‚£éƒ¨åˆ†å°±æ˜¯æ–‡ä»¶å¤¹IDäº†ï¼Œè®°å½•ä¸‹æ¥ä¸‹é¢è¦ä½¿ç”¨åˆ°<br>ä½¿ç”¨IP:5244æˆ–è€…ä½ å·²ç»è®¾ç½®å¥½äº†åŸŸåè®¿é—®Webç•Œé¢ï¼ŒAlistå¯ä»¥é€šè¿‡å›¾å½¢åŒ–åå°ç®¡ç†åœ¨æœ€ä¸‹æ–¹ç‚¹å‡»ç™»é™†æŒ‰ä¹‹å‰è·å–çš„åˆå§‹å¯†ç ,ç™»é™†åå¯ä¿®æ”¹å¯†ç <br>ç‚¹å‡»Storages&gt;Add&gt;189Cloud<br>Mount Path è¾“å…¥è¦æŒ‚è½½åˆ°çš„ç›®å½•ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨çš„alistç›®å½•ä¸­çš„æ–‡ä»¶å…¨éƒ¨è¦æŒ‚è½½åˆ°ä¸»ç›®å½•ä¸‹ä¾¿å¡«/ï¼Œè¦æŒ‚è½½åˆ°ä¸»ç›®å½•ä¸‹çš„optç›®å½•ä¸‹ä¾¿å¡«/opt<br>Username è¾“å…¥ç™»é™†çš„æ‰‹æœºå·<br>Password è¾“å…¥è´¦å·å¯†ç <br>Rooy folder id è¾“å…¥ä¸Šé¢è·å¾—çš„æ–‡ä»¶å¤¹ID<br>æœ€åADDæ·»åŠ å¯ç”¨ä¾¿è·å¾—äº†ä¸€ä¸ªç§äººçš„ç™½å«–äº‘ç›˜å•¦,è¿™é‡Œé€‰æ‹©å¤©ç¿¼äº‘ç›˜æ˜¯å› ä¸ºæ”¯æŒåœ¨çº¿æµè§ˆä¸Šä¼ å’Œä¸‹è½½ï¼Œé€Ÿåº¦äº²æµ‹å¹³å‡10M/s</p>              </div>            </details>]]></content>
    
    
    <summary type="html">ç§äººäº‘ç›˜ä¹‹Alist</summary>
    
    
    
    <category term="æœåŠ¡é›†ç¾¤" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/"/>
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/%E6%BC%94%E7%A4%BA/"/>
    
    
    <category term="storage" scheme="https://www.linjiangyu.com/tags/storage/"/>
    
  </entry>
  
  <entry>
    <title>safe-rm</title>
    <link href="https://www.linjiangyu.com/posts/87519fc9.html"/>
    <id>https://www.linjiangyu.com/posts/87519fc9.html</id>
    <published>2022-11-19T16:25:10.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><p>safe-rm</p></div></div><div class='checkbox orange checked'><input type="checkbox" checked="checked"/>            <p>çœ‹åå­—å°±èƒ½çŸ¥é“æ˜¯ä»€ä¹ˆäº†ï¼Œå®‰å…¨çš„rmå‘½ä»¤</p>            </div><div class="note default orange simple"><p>æ¯”rmå‘½ä»¤å¢åŠ çš„åŠŸèƒ½ï¼Œskip Directory or file</p></div><details class="folding-tag" cyan open><summary> è¿™é‡Œä½¿ç”¨çš„äºŒè¿›åˆ¶åŒ… </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="safe-rm.tar.gz" href="https://alist.linjiangyu.com/d/Linux/safe-rm-0.12.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">safe-rm.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/safe-rm-0.12.tar.gz</p></div></a></div>              </div>            </details>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tar xf safe-rm.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> safe-rm-0.12</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">chown</span> root. safe-rm</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> safe-rm /usr/local/bin/rm</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /etc/profile</span></span><br><span class="line">export PATH=/usr/local/bin:$PATH</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">source</span> /etc/profile</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ç¼–å†™ä¸€ä¸‹ç¦æ­¢åˆ é™¤çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">touch</span> /opt/t1                    // æµ‹è¯•æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /etc/safe-rm.conf         // è¿™ä¸ªæ–‡ä»¶æ˜¯è‡ªå·±åˆ›å»ºçš„,safe-rmä¼šé»˜è®¤å»æ‰¾è¿™ä¸ªæ–‡ä»¶çš„è§„åˆ™</span></span><br><span class="line">/</span><br><span class="line">/*</span><br><span class="line">/etc</span><br><span class="line">/etc/*</span><br><span class="line">/usr</span><br><span class="line">/usr/local</span><br><span class="line">/usr/local/bin</span><br><span class="line">/usr/local/bin/*</span><br><span class="line">/root</span><br><span class="line">/root/*</span><br><span class="line">/opt/t1         # ä¸ºäº†æµ‹è¯•</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">rm</span> -f /opt/t1</span>  </span><br><span class="line">safe-rm: skipping t1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¼šæ— æ³•åˆ é™¤,æŠŠ/etc/safe-rm.confä¸­çš„/opt/t1åˆ é™¤åå†<span class="built_in">rm</span> -f /opt/t1ä¾¿å¯åˆ é™¤</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">safe-rm</summary>
    
    
    
    <category term="è¿ç»´" scheme="https://www.linjiangyu.com/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="Linux" scheme="https://www.linjiangyu.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>hadoop+spark+zookeeper+hiveåˆ†å¸ƒå¼é›†ç¾¤æ­å»º</title>
    <link href="https://www.linjiangyu.com/posts/b10cf3a3.html"/>
    <id>https://www.linjiangyu.com/posts/b10cf3a3.html</id>
    <published>2022-11-18T00:42:26.000Z</published>
    <updated>2023-11-27T01:42:42.512Z</updated>
    
    <content type="html"><![CDATA[<div class="timeline orange"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>å¤§æ•°æ®æœåŠ¡åˆé›†</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2022-09-01 <a href="https://linjiangyu.com/posts/b10cf3a3.html">hadoop+spark</a></p></div></div><div class='timeline-item-content'><p>hadoop+sparkåˆè¯†</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2022-11-11 <a href="https://linjiangyu.com/posts/b10cf3a3.html#zookeeper%E5%88%86%E5%B8%83%E5%BC%8F">zookeeper</a></p></div></div><div class='timeline-item-content'><p>å‘é›†ç¾¤åŠ å…¥äº†zookeeperåˆ†å¸ƒå¼</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2022-11-19 <a href="https://linjiangyu.com/posts/b10cf3a3.html#hive">hive</a></p></div></div><div class='timeline-item-content'><p>è¿™é‡Œä¹Ÿå†™äº†é€‚é…CentOS6.xçš„é…ç½®</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2022-11-19 <a href="https://linjiangyu.com/posts/b10cf3a3.html#flume">flume</a></p></div></div><div class='timeline-item-content'><p>æ—¥å¿—é‡‡é›†</p></div></div></div><details class="folding-tag" cyan orang open><summary> å¤§æ•°æ®æœåŠ¡åˆé›† </summary>              <div class='content'>              <p><span class='nota' data-nota='hadoop+spark+zookeeper+hiveåˆ†å¸ƒå¼é›†ç¾¤'>å¤§æ•°æ®æœåŠ¡åˆé›†</span></p>              </div>            </details><p>2022-09-01hadoopå’Œsparkçš„åˆè¯†<span class="hidden-anchor" id="referto_[1]"></span><sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hadoop and spark</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><br>2022-11-11æ·»åŠ äº†zookeeperåˆ†å¸ƒå¼<span class="hidden-anchor" id="referto_[2]"></span><sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">zookeeper</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><br>2022-11-19æ·»åŠ äº†ç»“åˆMariadbçš„hiveæ•°æ®åº“ä½¿ç”¨<span class="hidden-anchor" id="referto_[3]"></span><sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hive</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span></p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.linjiangyu.com/2022/09/01/hadoop-spark%E5%88%86%E5%B8%83%E5%BC%8F%E6%90%AD%E5%BB%BA/">hadoop and sparkåˆ†å¸ƒå¼</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.linjiangyu.com/2022/11/11/hadoop-spark-zookeeper%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/">zookeeper</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.linjiangyu.com/2022/11/18/hadoop-spark-zookeeper-hive%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/">hive</a></div><p>hadoop+spark+zookeeper+hiveåˆ†å¸ƒå¼é›†ç¾¤éƒ¨ç½²</p><div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h3></div></div><div class="note default orange simple"><p>ç¯å¢ƒçš„å‡†å¤‡åŸºäºæˆ‘å†™çš„åˆå§‹åŒ–è„šæœ¬,è‡ªç”¨7.xç³»åˆ—çš„CentOS,è€ç‰ˆæœ¬çš„å°±æ”¯æŒCentOS/Redhat6,7,8ä½†æ˜¯æœ‰ç‚¹ä¸å®Œå–„ï¼Œéœ€è¦å¯ä»¥é‚®ç®±æˆ–è€…åšå®¢ç•™è¨€ã€‚</p></div><table><thead><tr><th style="text-align:center">os\ip</th><th style="text-align:center">hostname</th><th style="text-align:center">block</th></tr></thead><tbody><tr><td style="text-align:center">centos7.9 192.168.222.226</td><td style="text-align:center">master</td><td style="text-align:center">rsmanager,datanode,namenode.snamenode,nmanager</td></tr><tr><td style="text-align:center">centos7.9 192.168.222.227</td><td style="text-align:center">node1</td><td style="text-align:center">snamenode,nmnager,datanode</td></tr><tr><td style="text-align:center">centos7.9 192.168.222.228</td><td style="text-align:center">node2</td><td style="text-align:center">datanode,nmanager</td></tr></tbody></table><div class="tabs" id="åˆå§‹åŒ–"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#åˆå§‹åŒ–-1">æ—§ç‰ˆ</button></li><li class="tab active"><button type="button" data-href="#åˆå§‹åŒ–-2">æ–°ç‰ˆ(æ¨è)</button></li><li class="tab"><button type="button" data-href="#åˆå§‹åŒ–-3">èˆ¹æ–°ç‰ˆ</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="åˆå§‹åŒ–-1"><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>å›½å¤–æœåŠ¡å™¨æ‰˜ç®¡ä»£ç ï¼Œå¯èƒ½è¢«å¢™</p>            </div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/linjiangyu2/K.git   //å¯èƒ½ä¼šæ‹‰ä¸ä¸‹æ¥ï¼Œå¤šæ‹‰å‡ æ¬¡å°±ä¸‹æ¥äº†ï¼Œå› ä¸ºæ‰˜ç®¡ä»£ç çš„æœåŠ¡å™¨æ˜¯å›½å¤–çš„</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> K</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> README.md  //ä¸ä¼šä½¿ç”¨çš„è¦çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼Œäº†è§£è„šæœ¬éœ€è¦è¾“å…¥çš„é…ç½®</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./ksh  //ä¾æ¬¡è¾“å…¥ä½ è‡ªå·±çš„é…ç½®ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¸€å®šè¦çœ‹README.mdæ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœéœ€è¦æœ‰æ—¶å€™æ”¹IPåœ°å€å›¾æ–¹ä¾¿çš„è¯ï¼Œç›´æ¥æŠŠkshè¿™ä¸ªäºŒè¿›åˆ¶çš„è„šæœ¬æ”¾åœ¨/usr/binä¸‹ï¼Œä¾¿å¯ä»¥åœ¨å…¨å±€æ‰§è¡Œäº†</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> ksh /usr/bin/ksh</span></span><br><span class="line">ä½¿ç”¨kshåˆå§‹åŒ–åï¼Œå¼€å§‹é…ç½®</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="åˆå§‹åŒ–-2"><div class='checkbox orange checked'><input type="checkbox" checked="checked"/>            <p>æœ¬ç«™æ‰˜ç®¡ä»£ç æ”¾å¿ƒé£Ÿç”¨</p>            </div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum install -y https://mirrors.linjiangyu.com/centos/tianlin-release.noarch-7-1.x86_64.rpm</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum --enablerepo=<span class="string">&#x27;tianlin&#x27;</span> install -y ksh-5.0-1.x86_64</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /usr/share/K/README.md  //ä¸ä¼šä½¿ç”¨çš„è¦çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼Œäº†è§£è„šæœ¬éœ€è¦è¾“å…¥çš„é…ç½®</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ksh  //ä¾æ¬¡è¾“å…¥ä½ è‡ªå·±çš„é…ç½®ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¸€å®šè¦çœ‹README.mdæ–‡ä»¶</span></span><br><span class="line">ä½¿ç”¨kshåˆå§‹åŒ–åï¼Œç»§ç»­ä¸‹æ–‡é…ç½®</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆå§‹åŒ–-3"><div class='checkbox orange checked'><input type="checkbox" checked="checked"/>            <p>CDNæ‰˜ç®¡æ”¾å¿ƒé£Ÿç”¨</p>            </div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">wget https://cdn.staticaly.com/gh/linjiangyu2/K@master/ksh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">chmod</span> +x ./ksh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./ksh  //ä¾æ¬¡è¾“å…¥ä½ è‡ªå·±çš„é…ç½®ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¸€å®šè¦çœ‹https://github.com/linjiangyu2/K</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœéœ€è¦æœ‰æ—¶å€™æ”¹IPåœ°å€å›¾æ–¹ä¾¿çš„è¯ï¼Œç›´æ¥æŠŠkshè¿™ä¸ªäºŒè¿›åˆ¶çš„è„šæœ¬æ”¾åœ¨/usr/binä¸‹ï¼Œä¾¿å¯ä»¥åœ¨å…¨å±€æ‰§è¡Œäº†</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> ksh /usr/bin/ksh</span></span><br><span class="line">ä½¿ç”¨kshåˆå§‹åŒ–åï¼Œç»§ç»­ä¸‹æ–‡é…ç½®</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note default orange simple"><p>å¯¹åº”è‡ªå·±çš„IPåœ°å€ï¼Œæœ€å¥½/etc/hostsçš„è§£æåå’Œæˆ‘ä¸€è‡´ï¼Œä¸ç„¶ä¸‹é¢çš„é…ç½®æ–‡ä»¶éœ€è¦è‡ªå·±å¯¹åº”è‡ªå·±çš„è§£æåä¿®æ”¹</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[master]# </span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="built_in">cat</span> &gt; /etc/hosts &lt;&lt;<span class="string">END</span></span></span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 </span><br><span class="line">192.168.222.226 master</span><br><span class="line">192.168.222.227 node1</span><br><span class="line">192.168.222.228 node2</span><br><span class="line">END</span><br><span class="line"><span class="meta prompt_">[master]# </span><span class="language-bash"><span class="string">ssh-keygen -P &#x27;&#x27; -f ~/.ssh/id_rsa</span></span></span><br><span class="line"><span class="meta prompt_">[master]# </span><span class="language-bash"><span class="string">for i in master node&#123;1..2&#125;;do ssh-copy-id $i;done</span></span></span><br><span class="line"><span class="meta prompt_">[master]# </span><span class="language-bash"><span class="string">for i in node&#123;1..2&#125;;do rsync -av /etc/hosts root@$i:/etc/hosts;done</span></span></span><br><span class="line"><span class="meta prompt_">[master]# </span><span class="language-bash"><span class="string">for i in master node&#123;1..2&#125;;do ssh $i yum install -y openssl-devel;done</span></span></span><br></pre></td></tr></table></figure><p>2.æ­å»º</p><div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="hadoopåˆ†å¸ƒå¼">hadoopåˆ†å¸ƒå¼</h3></div></div><h4 id="ä¸Šä¼ jdkå’Œhadoopçš„taråŒ…">ä¸Šä¼ jdkå’Œhadoopçš„taråŒ…</h4><details class="folding-tag" cyan open><summary> è¿™é‡Œä½¿ç”¨çš„äºŒè¿›åˆ¶åŒ… </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="hadoop-2.8.5.tar.gz" href="https://alist.linjiangyu.com/d/Linux/hadoop-2.8.5.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">hadoop-2.8.5.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/hadoop-2.8.5.tar.gz</p></div></a></div><div class="tag link"><a class="link-card" title="jdk-8u212-linux-x64.tar.gz" href="https://alist.linjiangyu.com/d/Linux/jdk-8u212-linux-x64.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">jdk-8u212-linux-x64.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/jdk-8u212-linux-x64.tar.gz</p></div></a></div>              </div>            </details><h4 id="é…ç½®">é…ç½®</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">  [master]# </span><span class="language-bash">tar xf hadoop...  //ä¸çŸ¥é“ä½ ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œå†™äº†...ï¼Œä»¥ä¸‹ä¹Ÿæ˜¯ï¼Œtabé”®æˆ–è€…å¯¹åº”ä¿®æ”¹å°±å¯ä»¥</span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">...æ˜¯è¡¨ç¤ºæˆ‘ä¸çŸ¥é“ä½ ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œè‡ªå·±æ”¹</span></span><br><span class="line">  [root@ master]# tar xf jdk...</span><br><span class="line">  [root@ master]# tar xf hadoop...</span><br><span class="line">  [root@ master]# mv hadoop... /opt/hadoop285</span><br><span class="line">  [root@ master]# mv jdk... /usr/local/jdk</span><br><span class="line"><span class="meta prompt_">  </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /etc/profile</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line">export HADOOP_HOME=/opt/hadoop285</span><br><span class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$&#123;HADOOP_HOME&#125;/bin:$&#123;HADOOP_HOME&#125;/sbin:$PATH</span><br><span class="line">export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native </span><br><span class="line">export HADOOP_OPTS=&quot;-Djava.library.path=$HADOOP_HOME/lib/native&quot;</span><br><span class="line">export LD_LIBRARY_PATH=$HADOOP_HOME/lib/native/:$LD_LIBRARY_PATH</span><br><span class="line"><span class="meta prompt_">  </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">source</span> !$</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ä»¥ä¸‹æ˜¯è‡ªå·±ç›´æ¥å†™å…¥é…ç½®ï¼Œåœ¨masteræœåŠ¡å™¨ä¸Šè¿›è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /opt/hadoop285/etc/hadoop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim hadoop-env.sh  //ä¿®æ”¹æ–‡ä»¶é‡Œé¢çš„<span class="built_in">export</span> JAVA_HOME=<span class="variable">$&#123;JAVA_HOME&#125;</span>ä¸º</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim yarn-env.sh //ä¿®æ”¹å‰é¢æœ‰æ³¨é‡Šçš„<span class="built_in">export</span> JAVA_HOMEä¸º</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># vim core-site.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.groups<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># vim hdfs-site.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/data/hdfs/name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/data/hdfs/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># vim yarn-site.xml </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># cp mapred-site.xml.template mapred-site.xml</span><br><span class="line"># vim mapred-site.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim slaves</span></span><br><span class="line">master</span><br><span class="line">node1</span><br><span class="line">node2</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ç„¶ååœ¨masterèŠ‚ç‚¹æŠŠé…ç½®å‘åˆ°å„ä¸ªèŠ‚ç‚¹</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[master]# </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /usr/local/jdk root@<span class="variable">$i</span>:/usr/local/;<span class="keyword">done</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /opt/hadoop285 root@<span class="variable">$i</span>:/opt/;<span class="keyword">done</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /etc/profile root@<span class="variable">$i</span>:/etc/profile;<span class="keyword">done</span></span></span><br><span class="line">ç„¶ååˆ°å„ä¸ªèŠ‚ç‚¹</span><br><span class="line">[node1,2]# source /etc/profile</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨node1,2ä¸Šæ“ä½œï¼Œæœ€ååœ¨masteræ“ä½œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hdfs namenode -format   //åˆå§‹åŒ–</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ls</span> -d /opt/data   //æ­¤æ–‡ä»¶å¤¹äº§ç”Ÿå°±æ˜¯åˆå§‹åŒ–æˆåŠŸ</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨masterä¸Šæ“ä½œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ master]# start-all.sh</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>æœ€åå¯ä»¥åœ¨å„ä¸ªèŠ‚ç‚¹ä½¿ç”¨jpså‘½ä»¤æŸ¥çœ‹å„è‡ªçš„éƒ¨ä»¶</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ xxx]# jps</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>å½“ç„¶webç•Œé¢ä¹Ÿå¯ä»¥è®¿é—®çš„ï¼Œæµè§ˆå™¨è®¿é—®192.168.222.226:8088å’Œ192.168.222.226:50070(å¯¹åº”è‡ªå·±IPåœ°å€)</p></div><div class="note default orange simple"><p>æ¥å°è¯•è¿è¡Œä¸€ä¸‹ç¬¬ä¸€ä¸ªhadoopåˆ†å¸ƒå¼ä»»åŠ¡å§</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ master]# hdfs dfs -put /etc/passwd /t1</span><br><span class="line">[root@ master]# hadoop jar /opt/hadoop285/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.8.5.jar wordcount /t1 /output/00</span><br><span class="line">[root@ master]# hdfs dfs -ls /output/00  //æŸ¥çœ‹è¿è¡Œåçš„ç»“æœæ–‡ä»¶,è¿è¡Œåçš„æ•°æ®åœ¨part-r-00000</span><br></pre></td></tr></table></figure><div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="sparkåˆ†å¸ƒå¼">sparkåˆ†å¸ƒå¼</h3></div></div><div class="note default orange simple"><p>ä¸‹é¢å¼€å§‹æ­å»ºåˆ†å¸ƒå¼spark</p></div><details class="folding-tag" cyan open><summary> è¿™é‡Œä½¿ç”¨sparkçš„3.3.0ç‰ˆæœ¬ </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="spark-3.3.0-bin-hadoop3.tgz" href="https://alist.linjiangyu.com/d/Linux/spark-3.3.0-bin-hadoop3.tgz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">spark-3.3.0-bin-hadoop3.tgz</p><p class="url">https://alist.linjiangyu.com/d/Linux/spark-3.3.0-bin-hadoop3.tgz</p></div></a></div>              </div>            </details><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŠŠsparkåŒ…ä¸Šä¼ åˆ°æœºå™¨ä¸Šï¼Œç„¶ååˆ°è¯¥åŒ…çš„ç›®å½•ï¼Œè¿™é‡Œç»Ÿä¸€ä»¥spark-3.3.0-bin-hadoop3.tgzè¿™ä¸ªåŒ…ä¸ºæ¼”ç¤º</span></span><br><span class="line">[root@ master]# tar xf spark-3.3.0-bin-hadoop3.tgz</span><br><span class="line">[root@ master]# mv spark-3.3.0-bin-hadoop3 /opt/spark</span><br><span class="line">[root@ master]# vim /etc/profile</span><br><span class="line">export PATH=/opt/spark/bin:/opt/spark/sbin:$PATH</span><br><span class="line">[root@ master]# cd /opt/spark/conf</span><br><span class="line">[root@ master]# mv spark-env.sh.template spark-env.sh</span><br><span class="line">[root@ master]# vim spark-env.sh</span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line">export HADOOP_CONF_DIR=/opt/hadoop285/etc/hadoop</span><br><span class="line">export SPARK_MASTER_IP=master   #å¯¹åº”è‡ªå·±çš„masteræœºå™¨IPæˆ–è€…masterè§£æçš„åŸŸåï¼Œå¦‚æœæ˜¯æŒ‰ç…§æˆ‘ä¸Šé¢åšçš„ç›´æ¥å†™masterå³å¯</span><br><span class="line">export SPARK_WORKER_MEMORY=1024m</span><br><span class="line">export SPARK_WORKER_CORES=2 </span><br><span class="line">export SPARK_EXECUTOR_MEMORY=1024m</span><br><span class="line">export SPARK_WORKER_INSTANCES=1</span><br><span class="line">export SOARK_MASTER_PORT=7077</span><br><span class="line">export SPARK_EXECUTOR_CORES=1</span><br><span class="line">SPARK_HISTORY_OPTS=&quot;-Dspark.history.fs.logDirectory=hdfs://master:9000/spark_logs&quot;</span><br><span class="line">[root@ master]# cp spark-defaults.conf.template spark-defaults.conf</span><br><span class="line">[root@ master]# vim spark-defaults.conf</span><br><span class="line">spark.master                     spark://master:7077</span><br><span class="line">spark.eventLog.enabled           true</span><br><span class="line">spark.eventLog.dir               hdfs://master:9000/spark_logs</span><br><span class="line">[root@ master]# vim slaves     //å¯¹åº”è‡ªå·±çš„ä¸‰å°ä¸»æœºIPåœ°å€æˆ–è€…è§£æçš„åŸŸå</span><br><span class="line">master</span><br><span class="line">node1</span><br><span class="line">node2</span><br><span class="line">[root@ master]# cd /opt/spark/sbin</span><br><span class="line">[root@ master]# mv start-all.sh spark-start.sh</span><br><span class="line">[root@ master]# mv stop-all.sh spark-stop.sh</span><br><span class="line">[root@ master]# source /etc/profile</span><br><span class="line">[root@ master]# scp -r /opt/spark root@node1:/opt/</span><br><span class="line">[root@ master]# scp -r /opt/spark root@node2:/opt/</span><br><span class="line">[root@ master]# scp -r /etc/profile root@node1:/etc/</span><br><span class="line">[root@ master]# scp -r /etc/profile root@node2:/etc/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç„¶ååœ¨å„å·¥ä½œèŠ‚ç‚¹æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">[root@ node1,node2]# source /etc/profile</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨masterèŠ‚ç‚¹æ‰§è¡Œ</span></span><br><span class="line">[root@ master]# start-all.sh</span><br><span class="line">[root@ master]# hdfs dfs -mkdir /spark_logs</span><br><span class="line">[root@ master]# spark-start.sh  //å¯åŠ¨sparké›†ç¾¤</span><br><span class="line">[root@ master]# jps     //æŸ¥çœ‹</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ä»¥ä¸Šä¾¿æ­å»ºå¥½äº†sparkç»“åˆhadoopçš„åˆ†å¸ƒå¼é›†ç¾¤ï¼Œsparkä¹Ÿæœ‰è‡ªå·±çš„webç•Œé¢ï¼Œå¯ä»¥æµè§ˆå™¨è®¿é—®192.168.222.226:8080æ¥æŸ¥çœ‹(å¯¹åº”è‡ªå·±IPåœ°å€)</p></div><div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="zookeeperåˆ†å¸ƒå¼">zookeeperåˆ†å¸ƒå¼</h3></div></div><details class="folding-tag" cyan open><summary> è¿™é‡Œä½¿ç”¨çš„äºŒè¿›åˆ¶åŒ… </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="apache-zookeeper-3.5.10.tar.gz" href="https://alist.linjiangyu.com/d/Linux/zookeeper-3.4.14.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">apache-zookeeper-3.5.10.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/zookeeper-3.4.14.tar.gz</p></div></a></div>              </div>            </details><div class="note default orange simple"><p>åœ¨masteræœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tar xf zookeeper*</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> zookeeper* /opt/zookeeper</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> /opt/zookeeper/conf/zoo_sample.cfg /opt/zookeeper/conf/zoo.cfg</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /opt/zookeeper/conf/zoo.cfg</span></span><br><span class="line">ä¿®æ”¹</span><br><span class="line">dataDir=/opt/data/zookeeper</span><br><span class="line">æ·»åŠ </span><br><span class="line">dataLogDir=/opt/data/zookeeper/logs</span><br><span class="line">server.1=master:2888:3888</span><br><span class="line">server.2=node1:2888:3888</span><br><span class="line">server.3=node2:2888:3888</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™é‡Œå¯¹åº”è‡ªå·±çš„ä¸»æœºå</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨å„æœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mkdir</span> -p /opt/data/zookeeper/logs</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">echo</span> 1 &gt; /opt/data/zookeeper/myid             <span class="comment">#è¿™é‡Œmasterå¯¹åº”ä¸Šé¢çš„server.1 ä¾¿è¦echo1,node1å¯¹åº”server.2ä¾¿è¦echo 2,node3å¯¹åº”server.3ä¾¿è¦echo 3</span></span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨masteræœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /etc/profile</span></span><br><span class="line">export ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line">export PATH=$&#123;ZOOKEEPER_HOME&#125;/bin:$PATH</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /opt/zookeeper root@<span class="variable">$i</span>:/opt/;<span class="keyword">done</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /etc/profile /etc/;<span class="keyword">done</span></span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨å„æœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">source</span> /etc/profile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zkServer.sh start             <span class="comment">#è¿™ä¸ªå‘½ä»¤æœ€å¥½ä½¿ç”¨å¤šå‘½ä»¤ä¸€èµ·æ‰§è¡Œ,å°±æ˜¯å¤šä¸ªæœºå™¨çš„æ‰§è¡Œæ—¶é—´è¦å·®ä¸å¤šä¸€ç›´,å› ä¸ºzookeeperå¯¹æ—¶é—´çš„è¦æ±‚æ€§å¾ˆé«˜å’Œå„ç§é—®é¢˜</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zkServer.sh status    <span class="comment"># å¯ä»¥åœ¨å„èŠ‚ç‚¹æŸ¥çœ‹è‡ªå·±çš„è§’è‰²æ˜¯leaderè¿˜æ˜¯follower</span></span></span><br></pre></td></tr></table></figure><div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><h3 id="hive">hive</h3></div></div><h4 id="Mariadb">Mariadb</h4><div class="note default orange simple"><p>è¿™é‡Œä¸ºäº†æ–¹ä¾¿ç›´æ¥å®‰è£…mariadbä½œä¸ºMySQLä½¿ç”¨,CentOS7.xå’ŒCentOS6.xä½¿ç”¨æ–¹æ³•ä¸åŒ(ä¸ºäº†æœ‹å‹å†™äº†CentOS6çš„ï¼Œæ³ªç›®äº†),ä½¿ç”¨å‰æç½‘ç»œè¦èƒ½è®¿é—®å¤–ç½‘</p></div><div class="tabs" id="mariadb"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#mariadb-1">CentOS 7.x</button></li><li class="tab"><button type="button" data-href="#mariadb-2">CentOS 6.x</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="mariadb-1"><div class="tip sync"><p>CentOS 7.x</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# yum install -y mariadb mariadb-server</span><br><span class="line">[root@master ~]# systemctl enable mariadb &amp;&amp; systemctl start mariadb</span><br><span class="line">[root@master ~]# mysqladmin password abcd1234</span><br><span class="line">[root@master ~]# mysql -uroot -pabcd1234 -e &quot;create user &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;abcd1234&#x27;;&quot; -e &quot;grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27;;&quot;</span><br><span class="line">[root@master ~]# mysql_secure_installation</span><br><span class="line">æŒ‰é¡ºåºè¾“å…¥abcd1234,n,y,n,y,y</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mariadb-2"><div class="tip sync"><p>CentOS 6.x</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# mkdir /etc/yum.repos.d/bak</span><br><span class="line">[root@master ~]# mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/bak/</span><br><span class="line">[root@master ~]# wget -O /etc/yum.repos.d/CentOS-Base.repo https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/repo/CentOS-Base.repo &amp;&amp; yum install -y epel-release</span><br><span class="line">[root@master ~]# vim /etc/yum.repos.d/mariadb.repo</span><br><span class="line">[mariadb]</span><br><span class="line">name=MariaDB</span><br><span class="line">baseurl=https://mirrors.aliyun.com/mariadb/yum/10.4/centos6-amd64</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/mariadb/yum/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck=1</span><br><span class="line">[root@master ~]# yum install -y mysql mysql-devel mysql-server</span><br><span class="line">[root@master ~]# service mysql start &amp;&amp; chkconfig --add mysql &amp;&amp; chkconfig mysql on</span><br><span class="line">[root@master ~]# mysqladmin password abcd1234</span><br><span class="line">[root@master ~]# mysql -uroot -pabcd1234 -e &quot;create user &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;abcd1234&#x27;;&quot; -e &quot;grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27;;&quot;</span><br><span class="line">[root@master ~]# mysql_secure_installation</span><br><span class="line">æŒ‰é¡ºåºè¾“å…¥abcd1234,n,y,n,y,y</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><details class="folding-tag" cyan open><summary> è¿™é‡Œä½¿ç”¨çš„äºŒè¿›åˆ¶åŒ… </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="apache-hive-3.1.2-bin.tar.gz" href="https://alist.linjiangyu.com/d/Linux/apache-hive-3.1.2-bin.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">apache-hive-3.1.2-bin.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/apache-hive-3.1.2-bin.tar.gz</p></div></a></div>              </div>            </details><div class="note default orange simple"><p>æŠŠäºŒè¿›åˆ¶åŒ…ä¸Šä¼ åˆ°masteræœºå™¨çš„optç›®å½•ä¸‹</p></div><h4 id="hiveé…ç½®">hiveé…ç½®</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# cd /opt</span><br><span class="line">[root@master opt]# tar xf apache-hive-3.1.2-bin.tar.gz</span><br><span class="line">[root@master opt]# mv apache-hive-3.1.2-bin hive</span><br><span class="line">[root@master opt]# cd hive/conf</span><br><span class="line">[root@master conf]# cp -a hive-env.sh.template hive-env.sh</span><br><span class="line">[root@master conf]# vim hive-env.sh</span><br><span class="line">åœ¨æœ€å‰é¢æ·»åŠ ,è¿™é‡Œå¯¹åº”å¥½è‡ªå·±çš„ç›®å½•</span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line">export HADOOP_HOME=/opt/hadoop285</span><br><span class="line">export HADOOP_CONF_DIR=$&#123;HADOOP_HOME&#125;/etc/hadoop</span><br><span class="line">export HADOOP_HEAPSIZE=1024</span><br><span class="line">export HIVE_HOME=/opt/hive</span><br><span class="line">export HIVE_CONF_DIR=$&#123;HIVE_HOME&#125;/conf</span><br><span class="line">export HIVE_AUX_JARS_PATH=$&#123;HIVE_HOME&#125;/lib</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@master conf]# vim hive-site.xml// ä»¥ä¸‹å¯¹åº”æ³¨é‡Šæ›´æ”¹è‡ªå·±çš„é…ç½®</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è¿™é‡Œå¯¹åº”å¡«å…¥è‡ªå·±ä¸»èŠ‚ç‚¹æœºå™¨åœ¨hostsæ–‡ä»¶è§£æçš„åŸŸåï¼Œæˆ‘æ˜¯masterï¼Œè¿è¡Œé”™è¯¯çš„è¯åº”è¯¥æ˜¯ä½ å“ªé‡Œçš„è®¾ç½®æœ‰é—®é¢˜å°±æ¢æˆIPåœ°å€,åé¢å¯¹åº”çš„ä¹Ÿå°±éƒ½æ¢æˆIPåœ°å€--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--MySQLç™»é™†ç”¨æˆ·--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--ç”¨æˆ·å¯†ç --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>abcd1234<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.bind.host<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--è¿™é‡Œå¯¹åº”è§£æç¬¬äºŒå°çš„hostsæ–‡ä»¶è§£æçš„åŸŸå--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>node1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server3.thrift.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server3.thrift.bind.host<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--è¿™é‡Œå¯¹åº”è§£æç¬¬ä¸‰å°çš„hostsæ–‡ä»¶è§£æçš„åŸŸå--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>node2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@master conf]# cp hive-log4j2.properties.template hive-log4j2.properties</span><br><span class="line">[root@master conf]# vim hive-log4j2.properties</span><br><span class="line">æŠŠINFOå…¨éƒ¨æ›´æ”¹ä¸ºERROR</span><br><span class="line">[root@master conf]# vim /etc/profile</span><br><span class="line">export HIVE_HOME=/opt/hive</span><br><span class="line">export PATH=$&#123;HIVE_HOME&#125;/bin:$PATH</span><br><span class="line">[root@master conf]# source /etc/profile</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ä¸Šä¼ è¿æ¥MySQLéœ€è¦çš„jaråŒ…</p></div><details class="folding-tag" cyan open><summary> mysql-connector-java-8.0.17.jar </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="mysql-connector-java-8.0.17.jar" href="https://alist.linjiangyu.com/d/Linux/mysql-connector-java-8.0.17.jar"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">mysql-connector-java-8.0.17.jar</p><p class="url">https://alist.linjiangyu.com/d/Linux/mysql-connector-java-8.0.17.jar</p></div></a></div>              </div>            </details><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# mv  mysql-connector-java-8.0.17.jar /opt/hive/lib/</span><br><span class="line">[root@master ~]# cd /opt/hive/bin</span><br><span class="line">[root@master bin]# ./schematool -initSchema -dbType mysql// åˆå§‹åŒ–</span><br><span class="line">[root@master ~]# mysql -uroot -pabcd1234</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show tables from hive;// æœ‰æ•°æ®åˆ™åˆå§‹åŒ–æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h4 id="è¿æ¥æ“ä½œæµ‹è¯•">è¿æ¥æ“ä½œæµ‹è¯•</h4><div class="note default orange simple"><p>hiveçš„å¯åŠ¨éœ€è¦å…ˆå¯åŠ¨hadoopå’ŒsparkæœåŠ¡</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[root@master]# </span><span class="language-bash">start-all.sh &amp;&amp; spark-start.sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŠŠæœåŠ¡æ”¾åœ¨ä¸åŒèŠ‚ç‚¹æµ‹è¯•è¿æ¥æ•°æ®åº“æ“ä½œ</span></span><br><span class="line"><span class="meta prompt_">[root@master]# </span><span class="language-bash">scp -r /opt/hive root@node1:/opt/</span></span><br><span class="line"><span class="meta prompt_">[root@master]# </span><span class="language-bash">scp -r /opt/hive root@node2:/opt/</span></span><br><span class="line"><span class="meta prompt_">[root@master]# </span><span class="language-bash">scp /etc/profile root@node1:/etc/</span></span><br><span class="line"><span class="meta prompt_">[root@master]# </span><span class="language-bash">scp /etc/profile root@node2:/etc/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç„¶ååœ¨å„èŠ‚ç‚¹ä¸Šä½¿ç”¨å‘½ä»¤</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">source</span> /etc/profile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å›åˆ°masteræœºå™¨æ“ä½œ</span></span><br><span class="line"><span class="meta prompt_">[root@master]# </span><span class="language-bash">hiveserver2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡å¼€ç»ˆç«¯å¼€å¯ä¸€ä¸ªå¯è¢«å¦å¤–èŠ‚ç‚¹è¿æ¥çš„æœåŠ¡ç»ˆç«¯</span></span><br><span class="line">[root@master ~]# hive --service metastore</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™é‡Œä½¿ç”¨node1æ¥è¿æ¥,å¯èƒ½è¦ç­‰å¾…ä¹…ç‚¹æ‰èƒ½èµ·10000ç«¯å£</span></span><br><span class="line"><span class="meta prompt_">[root@node1]# </span><span class="language-bash">beeline<span class="comment"># ä¾æ¬¡è‡ªå·±å°è¯•</span></span></span><br><span class="line"><span class="meta prompt_">beeline&gt; </span><span class="language-bash">!connect jdbc:hive2://master:10000</span></span><br><span class="line">Connecting to jdbc:hive2://master:10000</span><br><span class="line">Enter username for jdbc:hive2://master:10000: root</span><br><span class="line">Enter password for jdbc:hive2://master:10000: ***</span><br><span class="line">Connected to: Apache Hive (version 3.1.2)</span><br><span class="line">Driver: Hive JDBC (version 2.3.9)</span><br><span class="line">Transaction isolation: TRANSACTION_REPEATABLE_READ</span><br><span class="line">0: jdbc:hive2://master:10000&gt; show databases;</span><br><span class="line">+----------------+</span><br><span class="line">| database_name  |</span><br><span class="line">+----------------+</span><br><span class="line">| default        |</span><br><span class="line">+----------------+</span><br><span class="line">1 row selected (1.442 seconds)</span><br></pre></td></tr></table></figure><h4 id="è¡¨åˆ›å»ºæµ‹è¯•">è¡¨åˆ›å»ºæµ‹è¯•</h4><div class="note default orange simple"><p>åœ¨masteræœºå™¨ä¸Šå‡†å¤‡ä¸€ä¸‹ç”¨åˆ°çš„txtæ–‡ä»¶,ä¸Šä¼ åˆ°hdfsæ–‡ä»¶ç³»ç»Ÿ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[master@root ~]# vim t.txt</span><br><span class="line">1,linjiangyu,20</span><br><span class="line">2,lintian,20</span><br><span class="line">3,k,20</span><br><span class="line">[master@root ~]# hdfs dfs -mkdir /t</span><br><span class="line">[master@root ~]# hdfs dfs -put ./t.txt /t/</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>å›åˆ°node1</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:hive2://master:10000&gt; create database k ;</span><br><span class="line">No rows affected (0.267 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:hive2://master:10000&gt; use k;</span><br><span class="line">No rows affected (0.078 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:hive2://master:10000&gt; create table k_user(kid int,kname string,kage int) row format delimited fields terminated by &#x27;,&#x27; location &#x27;/t&#x27;;</span><br><span class="line">No rows affected (0.558 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:hive2://master:10000&gt; show tables;</span><br><span class="line">+-----------+</span><br><span class="line">| tab_name  |</span><br><span class="line">+-----------+</span><br><span class="line">| k_user    |</span><br><span class="line">+-----------+</span><br><span class="line">1 row selected (0.114 seconds)</span><br><span class="line"></span><br><span class="line">0: jdbc:hive2://master:10000&gt; select * from k_user;</span><br><span class="line">+-------------+---------------+--------------+</span><br><span class="line">| k_user.kid  | k_user.kname  | k_user.kage  |</span><br><span class="line">+-------------+---------------+--------------+</span><br><span class="line">| 1           | linjiangyu    | 20           |</span><br><span class="line">| 2           | lintian       | 20           |</span><br><span class="line">| 3           | k             | 20           |</span><br><span class="line">+-------------+---------------+--------------+</span><br><span class="line">3 rows selected (3.141 seconds)</span><br></pre></td></tr></table></figure><h3 id="flume">flume</h3><div class="note default orange simple"><p>è²Œä¼¼æ˜¯æ—¥å¿—æ”¶é›†åº”ç”¨</p></div><ul><li><p>æŠŠ<a href="https://dlcdn.apache.org/flume/1.11.0/apache-flume-1.11.0-bin.tar.gz">apache-flume-bin.tar.gz</a>ä¸‹è½½å¹¶ä¸Šä¼ åˆ°ç³»ç»Ÿä¸­</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xf apache-flume-1.11.0-bin.tar.gz &amp;&amp; rm -f apache-flume-1.11.0-bin.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mv apache-flume* /usr/local/flume</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># vim /etc/profile</span></span><br><span class="line"><span class="attribute">export</span> FLUME_HOME=/usr/local/flume</span><br><span class="line">export PATH=<span class="variable">$&#123;FLUME_HOME&#125;</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cd /usr/local/flume/conf/</span></span><br><span class="line"><span class="comment"># cp flume-env.sh.template flume-env.sh</span></span><br><span class="line"><span class="comment"># vim flume-env.sh</span></span><br><span class="line">// åœ¨æœ€ä¸Šé¢æ·»åŠ </span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line"></span><br><span class="line"><span class="comment"># vim netcat-logger.conf </span></span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = <span class="number">0.0.0.0</span></span><br><span class="line">a1.sources.r1.port = <span class="number">44444</span></span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = <span class="number">1000</span></span><br><span class="line">a1.channels.c1.transactionCapacity = <span class="number">100</span></span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line"><span class="comment"># flume-ng agent -n a1 -c ./ -f ./netcat-logger.conf -Dflume.root.logger=INFO,console  // å¯åŠ¨æœåŠ¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># yum install -y telnet</span></span><br><span class="line"><span class="comment"># telnet 127.0.0.1 44444</span></span><br><span class="line">  // éšä¾¿å†™ç‚¹ä¸œè¥¿å›è½¦ä¼šæœ‰OKå‡ºç°å°±è¡Œäº†</span><br></pre></td></tr></table></figure></li></ul><h3 id="sqoop">sqoop</h3><ol><li><p>ä¸‹è½½åŒ…<a href="https://archive.apache.org/dist/sqoop/1.4.7/sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz">sqoop</a>æ”¾åˆ°/optä¸‹</p></li><li><p>æ•´</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tar xf sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> sqoop-1.4.7.bin__hadoop-2.6.0 sqoop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> sqoop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> conf/sqoop-env-template.sh conf/sqoop-env.sh</span></span><br><span class="line">export HADOOP_COMMON_HOME=/opt/hadoop285</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Set path to <span class="built_in">where</span> hadoop-*-core.jar is available</span></span><br><span class="line">export HADOOP_MAPRED_HOME=/opt/hadoop285</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">set</span> the path to <span class="built_in">where</span> bin/hbase is available</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">export</span> HBASE_HOME=</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Set the path to <span class="built_in">where</span> bin/hive is available</span></span><br><span class="line">export HIVE_HOME=/opt/hive</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Set the path <span class="keyword">for</span> <span class="built_in">where</span> zookeper config <span class="built_in">dir</span> is</span></span><br><span class="line">export ZOOCFGDIR=/opt/zookeeper/conf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /etc/profile</span></span><br><span class="line">export SQOOP_HOME=/opt/sqoop</span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;SQOOP_HOME&#125;/lib</span><br><span class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$&#123;HADOOP_HOME&#125;/bin:$&#123;HADOOP_HOME&#125;/sbin:$&#123;HIVE_HOME&#125;/bin:$&#123;SQOOP_HOME&#125;/bin:$PATH</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">source</span> /etc/profile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> /opt/hive/lib/mysql-connector-java-8.0.17.jar /opt/sqoop/lib/</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim bin/configure-sqoopæŠŠæ–‡ä»¶å…¨éƒ¨æ›¿æ¢ä¸ºä»¥ä¸‹</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Copyright 2011 The Apache Software Foundation</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Licensed to the Apache Software Foundation (ASF) under one</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">or more contributor license agreements.  See the NOTICE file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">distributed with this work <span class="keyword">for</span> additional information</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">regarding copyright ownership.  The ASF licenses this file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to you under the Apache License, Version 2.0 (the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;License&quot;</span>); you may not use this file except <span class="keyword">in</span> compliance</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">with the License.  You may obtain a copy of the License at</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#     http://www.apache.org/licenses/LICENSE-2.0</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Unless required by applicable law or agreed to in writing, software</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">distributed under the License is distributed on an <span class="string">&quot;AS IS&quot;</span> BASIS,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">See the License <span class="keyword">for</span> the specific language governing permissions and</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">limitations under the License.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This is sourced <span class="keyword">in</span> by bin/sqoop to <span class="built_in">set</span> environment variables prior to</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">invoking Hadoop.</span></span><br><span class="line"></span><br><span class="line">bin=&quot;$1&quot;</span><br><span class="line"></span><br><span class="line">if [ -z &quot;$&#123;bin&#125;&quot; ]; then</span><br><span class="line">  bin=`dirname $0`</span><br><span class="line">  bin=`cd $&#123;bin&#125; &amp;&amp; pwd`</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ -z &quot;$SQOOP_HOME&quot; ]; then</span><br><span class="line">  export SQOOP_HOME=$&#123;bin&#125;/..</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">SQOOP_CONF_DIR=$&#123;SQOOP_CONF_DIR:-$&#123;SQOOP_HOME&#125;/conf&#125;</span><br><span class="line"></span><br><span class="line">if [ -f &quot;$&#123;SQOOP_CONF_DIR&#125;/sqoop-env.sh&quot; ]; then</span><br><span class="line">  . &quot;$&#123;SQOOP_CONF_DIR&#125;/sqoop-env.sh&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Find paths to our dependency systems. If they are <span class="built_in">unset</span>, use CDH defaults.</span></span><br><span class="line"></span><br><span class="line">if [ -z &quot;$&#123;HADOOP_COMMON_HOME&#125;&quot; ]; then</span><br><span class="line">  if [ -n &quot;$&#123;HADOOP_HOME&#125;&quot; ]; then</span><br><span class="line">    HADOOP_COMMON_HOME=$&#123;HADOOP_HOME&#125;</span><br><span class="line">  else</span><br><span class="line">    if [ -d &quot;/usr/lib/hadoop&quot; ]; then</span><br><span class="line">      HADOOP_COMMON_HOME=/usr/lib/hadoop</span><br><span class="line">    else</span><br><span class="line">      HADOOP_COMMON_HOME=$&#123;SQOOP_HOME&#125;/../hadoop</span><br><span class="line">    fi</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ -z &quot;$&#123;HADOOP_MAPRED_HOME&#125;&quot; ]; then</span><br><span class="line">  HADOOP_MAPRED_HOME=/usr/lib/hadoop-mapreduce</span><br><span class="line">  if [ ! -d &quot;$&#123;HADOOP_MAPRED_HOME&#125;&quot; ]; then</span><br><span class="line">    if [ -n &quot;$&#123;HADOOP_HOME&#125;&quot; ]; then</span><br><span class="line">      HADOOP_MAPRED_HOME=$&#123;HADOOP_HOME&#125;</span><br><span class="line">    else</span><br><span class="line">      HADOOP_MAPRED_HOME=$&#123;SQOOP_HOME&#125;/../hadoop-mapreduce</span><br><span class="line">    fi</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">We are setting HADOOP_HOME to HADOOP_COMMON_HOME <span class="keyword">if</span> it is not <span class="built_in">set</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">so that hcat script works correctly on BigTop</span></span><br><span class="line">if [ -z &quot;$&#123;HADOOP_HOME&#125;&quot; ]; then</span><br><span class="line">  if [ -n &quot;$&#123;HADOOP_COMMON_HOME&#125;&quot; ]; then</span><br><span class="line">     HADOOP_HOME=$&#123;HADOOP_COMMON_HOME&#125;</span><br><span class="line">     export HADOOP_HOME</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ -z &quot;$&#123;HBASE_HOME&#125;&quot; ]; then</span><br><span class="line">  if [ -d &quot;/usr/lib/hbase&quot; ]; then</span><br><span class="line">    HBASE_HOME=/usr/lib/hbase</span><br><span class="line">  else</span><br><span class="line">    HBASE_HOME=$&#123;SQOOP_HOME&#125;/../hbase</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line">if [ -z &quot;$&#123;HCAT_HOME&#125;&quot; ]; then</span><br><span class="line">  if [ -d &quot;/usr/lib/hive-hcatalog&quot; ]; then</span><br><span class="line">    HCAT_HOME=/usr/lib/hive-hcatalog</span><br><span class="line">  elif [ -d &quot;/usr/lib/hcatalog&quot; ]; then</span><br><span class="line">    HCAT_HOME=/usr/lib/hcatalog</span><br><span class="line">  else</span><br><span class="line">    HCAT_HOME=$&#123;SQOOP_HOME&#125;/../hive-hcatalog</span><br><span class="line">    if [ ! -d $&#123;HCAT_HOME&#125; ]; then</span><br><span class="line">       HCAT_HOME=$&#123;SQOOP_HOME&#125;/../hcatalog</span><br><span class="line">    fi</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line">if [ -z &quot;$&#123;ACCUMULO_HOME&#125;&quot; ]; then</span><br><span class="line">  if [ -d &quot;/usr/lib/accumulo&quot; ]; then</span><br><span class="line">    ACCUMULO_HOME=/usr/lib/accumulo</span><br><span class="line">  else</span><br><span class="line">    ACCUMULO_HOME=$&#123;SQOOP_HOME&#125;/../accumulo</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line">if [ -z &quot;$&#123;ZOOKEEPER_HOME&#125;&quot; ]; then</span><br><span class="line">  if [ -d &quot;/usr/lib/zookeeper&quot; ]; then</span><br><span class="line">    ZOOKEEPER_HOME=/usr/lib/zookeeper</span><br><span class="line">  else</span><br><span class="line">    ZOOKEEPER_HOME=$&#123;SQOOP_HOME&#125;/../zookeeper</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line">if [ -z &quot;$&#123;HIVE_HOME&#125;&quot; ]; then</span><br><span class="line">  if [ -d &quot;/usr/lib/hive&quot; ]; then</span><br><span class="line">    export HIVE_HOME=/usr/lib/hive</span><br><span class="line">  elif [ -d $&#123;SQOOP_HOME&#125;/../hive ]; then</span><br><span class="line">    export HIVE_HOME=$&#123;SQOOP_HOME&#125;/../hive</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check: If we can<span class="string">&#x27;t find our dependencies, give up here.</span></span></span><br><span class="line">if [ ! -d &quot;$&#123;HADOOP_COMMON_HOME&#125;&quot; ]; then</span><br><span class="line">  echo &quot;Error: $HADOOP_COMMON_HOME does not exist!&quot;</span><br><span class="line">  echo &#x27;Please set $HADOOP_COMMON_HOME to the root of your Hadoop installation.&#x27;</span><br><span class="line">  exit 1</span><br><span class="line">fi</span><br><span class="line">if [ ! -d &quot;$&#123;HADOOP_MAPRED_HOME&#125;&quot; ]; then</span><br><span class="line">  echo &quot;Error: $HADOOP_MAPRED_HOME does not exist!&quot;</span><br><span class="line">  echo &#x27;Please set $HADOOP_MAPRED_HOME to the root of your Hadoop MapReduce installation.&#x27;</span><br><span class="line">  exit 1</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"># Moved to be a runtime check in sqoop.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">if [ ! -d &quot;$&#123;HBASE_HOME&#125;&quot; ]; then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &quot;Warning: $HBASE_HOME does not exist! HBase imports will fail.&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &#x27;</span>Please <span class="built_in">set</span> <span class="variable">$HBASE_HOME</span> to the root of your HBase installation.<span class="string">&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">fi</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">### Moved to be a runtime check in sqoop.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">if [ ! -d &quot;$&#123;HCAT_HOME&#125;&quot; ]; then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &quot;Warning: $HCAT_HOME does not exist! HCatalog jobs will fail.&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &#x27;</span>Please <span class="built_in">set</span> <span class="variable">$HCAT_HOME</span> to the root of your HCatalog installation.<span class="string">&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">fi</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#if [ ! -d &quot;$&#123;ACCUMULO_HOME&#125;&quot; ]; then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &quot;Warning: $ACCUMULO_HOME does not exist! Accumulo imports will fail.&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &#x27;</span>Please <span class="built_in">set</span> <span class="variable">$ACCUMULO_HOME</span> to the root of your Accumulo installation.<span class="string">&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">fi</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">if [ ! -d &quot;$&#123;ZOOKEEPER_HOME&#125;&quot; ]; then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &quot;Warning: $ZOOKEEPER_HOME does not exist! Accumulo imports will fail.&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> echo &#x27;</span>Please <span class="built_in">set</span> <span class="variable">$ZOOKEEPER_HOME</span> to the root of your Zookeeper installation.<span class="string">&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">fi</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Where to find the main Sqoop jar</span></span></span><br><span class="line">SQOOP_JAR_DIR=$SQOOP_HOME</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If there&#x27;</span>s a <span class="string">&quot;build&quot;</span> subdir, override with this, so we use</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the newly-compiled copy.</span></span><br><span class="line">if [ -d &quot;$SQOOP_JAR_DIR/build&quot; ]; then</span><br><span class="line">  SQOOP_JAR_DIR=&quot;$&#123;SQOOP_JAR_DIR&#125;/build&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">function add_to_classpath() &#123;</span><br><span class="line">  dir=$1</span><br><span class="line">  for f in $dir/*.jar; do</span><br><span class="line">    SQOOP_CLASSPATH=$&#123;SQOOP_CLASSPATH&#125;:$f;</span><br><span class="line">  done</span><br><span class="line"></span><br><span class="line">  export SQOOP_CLASSPATH</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Add sqoop dependencies to classpath.</span></span><br><span class="line">SQOOP_CLASSPATH=&quot;&quot;</span><br><span class="line">if [ -d &quot;$SQOOP_HOME/lib&quot; ]; then</span><br><span class="line">  add_to_classpath $SQOOP_HOME/lib</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Add HBase to dependency list</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">if</span> [ -e <span class="string">&quot;<span class="variable">$HBASE_HOME</span>/bin/hbase&quot;</span> ]; <span class="keyword">then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> TMP_SQOOP_CLASSPATH=<span class="variable">$&#123;SQOOP_CLASSPATH&#125;</span>:`<span class="variable">$HBASE_HOME</span>/bin/hbase classpath`</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> SQOOP_CLASSPATH=<span class="variable">$&#123;TMP_SQOOP_CLASSPATH&#125;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">fi</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">## Add HCatalog to dependency list</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">if</span> [ -e <span class="string">&quot;<span class="variable">$&#123;HCAT_HOME&#125;</span>/bin/hcat&quot;</span> ]; <span class="keyword">then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> TMP_SQOOP_CLASSPATH=<span class="variable">$&#123;SQOOP_CLASSPATH&#125;</span>:`<span class="variable">$&#123;HCAT_HOME&#125;</span>/bin/hcat -classpath`</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$&#123;HIVE_CONF_DIR&#125;</span>&quot;</span> ]; <span class="keyword">then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   TMP_SQOOP_CLASSPATH=<span class="variable">$&#123;TMP_SQOOP_CLASSPATH&#125;</span>:<span class="variable">$&#123;HIVE_CONF_DIR&#125;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> <span class="keyword">fi</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> SQOOP_CLASSPATH=<span class="variable">$&#123;TMP_SQOOP_CLASSPATH&#125;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">fi</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Add Accumulo to dependency list</span></span><br><span class="line">if [ -e &quot;$ACCUMULO_HOME/bin/accumulo&quot; ]; then</span><br><span class="line">  for jn in `$ACCUMULO_HOME/bin/accumulo classpath | grep file:.*accumulo.*jar | cut -d&#x27;:&#x27; -f2`; do</span><br><span class="line">    SQOOP_CLASSPATH=$SQOOP_CLASSPATH:$jn</span><br><span class="line">  done</span><br><span class="line">  for jn in `$ACCUMULO_HOME/bin/accumulo classpath | grep file:.*zookeeper.*jar | cut -d&#x27;:&#x27; -f2`; do</span><br><span class="line">    SQOOP_CLASSPATH=$SQOOP_CLASSPATH:$jn</span><br><span class="line">  done</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">ZOOCFGDIR=$&#123;ZOOCFGDIR:-/etc/zookeeper&#125;</span><br><span class="line">if [ -d &quot;$&#123;ZOOCFGDIR&#125;&quot; ]; then</span><br><span class="line">  SQOOP_CLASSPATH=$ZOOCFGDIR:$SQOOP_CLASSPATH</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">SQOOP_CLASSPATH=$&#123;SQOOP_CONF_DIR&#125;:$&#123;SQOOP_CLASSPATH&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If there<span class="string">&#x27;s a build subdir, use Ivy-retrieved dependencies too.</span></span></span><br><span class="line">if [ -d &quot;$SQOOP_HOME/build/ivy/lib/sqoop&quot; ]; then</span><br><span class="line">  for f in $SQOOP_HOME/build/ivy/lib/sqoop/*/*.jar; do</span><br><span class="line">    SQOOP_CLASSPATH=$&#123;SQOOP_CLASSPATH&#125;:$f;</span><br><span class="line">  done</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">add_to_classpath $&#123;SQOOP_JAR_DIR&#125;</span><br><span class="line"></span><br><span class="line">HADOOP_CLASSPATH=&quot;$&#123;SQOOP_CLASSPATH&#125;:$&#123;HADOOP_CLASSPATH&#125;&quot;</span><br><span class="line">if [ ! -z &quot;$SQOOP_USER_CLASSPATH&quot; ]; then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">User has elements to prepend to the classpath, forcibly overriding</span></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">Sqoop&#x27;</span>s own lib directories.</span></span><br><span class="line">  export HADOOP_CLASSPATH=&quot;$&#123;SQOOP_USER_CLASSPATH&#125;:$&#123;HADOOP_CLASSPATH&#125;&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">export SQOOP_CLASSPATH</span><br><span class="line">export SQOOP_CONF_DIR</span><br><span class="line">export SQOOP_JAR_DIR</span><br><span class="line">export HADOOP_CLASSPATH</span><br><span class="line">export HADOOP_COMMON_HOME</span><br><span class="line">export HADOOP_MAPRED_HOME</span><br><span class="line">export HBASE_HOME</span><br><span class="line">export HCAT_HOME</span><br><span class="line">export HIVE_CONF_DIR</span><br><span class="line">export ACCUMULO_HOME</span><br><span class="line">export ZOOKEEPER_HOME</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql -uroot -p123</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">create user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;127.0.0.1&#x27;</span> identified by <span class="string">&#x27;123&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">grant all privileges on *.* to <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;127.0.0.1&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">flush privileges;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash"><span class="built_in">exit</span></span></span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•è¿æ¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sqoop list-databases -connect jdbc:mysql://localhost:3306/ --username root --password 123</span></span><br><span class="line">è¾“å‡º</span><br><span class="line">23/05/20 23:14:23 INFO sqoop.Sqoop: Running Sqoop version: 1.4.7</span><br><span class="line">23/05/20 23:14:23 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.</span><br><span class="line">23/05/20 23:14:23 INFO manager.MySQLManager: Preparing to use a MySQL streaming resultset.</span><br><span class="line">Loading class `com.mysql.jdbc.Driver&#x27;. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver&#x27;. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</span><br><span class="line">mysql</span><br><span class="line">information_schema</span><br><span class="line">performance_schema</span><br><span class="line">sys</span><br><span class="line">hive</span><br><span class="line">rsyslog</span><br><span class="line">Syslo</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <summary type="html">hadoop+spark+zookeeper+hiveåˆ†å¸ƒå¼é›†ç¾¤æ­å»º</summary>
    
    
    
    <category term="æœåŠ¡é›†ç¾¤" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/"/>
    
    
  </entry>
  
  <entry>
    <title>ecy</title>
    <link href="https://www.linjiangyu.com/posts/d6542125.html"/>
    <id>https://www.linjiangyu.com/posts/d6542125.html</id>
    <published>2022-11-15T02:16:58.000Z</published>
    <updated>2023-11-27T01:42:42.512Z</updated>
    
    <content type="html"><![CDATA[<div class="tip warning faa-horizontal animated faa-fast"><p>ç½‘é¡µè§†é¢‘ç´ æ</p></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/relife.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/02.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/aila.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/aill.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/ecy.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/ecysg.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/eee.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/gyx.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/jiojio.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/onepis.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/wzzs.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/video/plmm.mp4' type='video/mp4'>Your browser does not support the video tag.</video></div>]]></content>
    
    
    <summary type="html">ecy</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>sersync2å®æ—¶ç›‘æ§åŒæ­¥æ–‡ä»¶</title>
    <link href="https://www.linjiangyu.com/posts/f2af38d6.html"/>
    <id>https://www.linjiangyu.com/posts/f2af38d6.html</id>
    <published>2022-11-12T15:20:01.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><p>sesyncçš„å®æ—¶åŒæ­¥</p></div></div><div class="tag link"><a class="link-card" title="sesync2" href="https://alist.linjiangyu.com/d/Linux/sersync2.5.4_64bit_binary_stable_final.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">sesync2</p><p class="url">https://alist.linjiangyu.com/d/Linux/sersync2.5.4_64bit_binary_stable_final.tar.gz</p></div></a></div><div class="note default orange simple"><p>ä¹Ÿè¦ç»“åˆrsyncå’ŒInotifyä¸€èµ·ä½¿ç”¨</p></div><table><thead><tr><th style="text-align:center">IP</th><th style="text-align:center">HOSTNAME</th></tr></thead><tbody><tr><td style="text-align:center">192.168.222.160</td><td style="text-align:center">master</td></tr><tr><td style="text-align:center">192.168.222.161</td><td style="text-align:center">backup</td></tr></tbody></table><div class="note default orange simple"><p>backupçš„rsyncdçš„é…ç½®</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum install -y rsync</span></span><br><span class="line"><span class="comment"># vim /etc/rsyncd.conf</span></span><br><span class="line">uid = root</span><br><span class="line">gid = root</span><br><span class="line"><span class="comment">#use chroot = yes</span></span><br><span class="line">max connections = <span class="number">0</span></span><br><span class="line">pid file = /var/run/rsyncd.pid</span><br><span class="line">exclude = lost+found/</span><br><span class="line"><span class="comment">#transfer logging = yes</span></span><br><span class="line"><span class="comment">#timeout = 900</span></span><br><span class="line"><span class="comment">#ignore nonreadable = yes</span></span><br><span class="line"><span class="comment">#dont compress   = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2</span></span><br><span class="line">reverse lookup = no</span><br><span class="line"></span><br><span class="line">[<span class="type">backup</span>]</span><br><span class="line">       path = /opt      <span class="comment"># å…±äº«çš„ç›®å½•</span></span><br><span class="line">       comment = ftp export area </span><br><span class="line">       read only = no</span><br><span class="line">       auth users = lt         <span class="comment"># ç™»é™†çš„ç”¨æˆ·å</span></span><br><span class="line">       secrets file = /etc/rsync.pas   <span class="comment"># è®¤è¯æ–‡ä»¶</span></span><br><span class="line"> <span class="comment"># åˆ›å»ºè®¤è¯æ–‡ä»¶</span></span><br><span class="line"> <span class="comment"># echo &#x27;lt:123&#x27; &gt; /etc/rsync.pas</span></span><br><span class="line"> <span class="comment"># systemctl restart rsyncd</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>masterçš„é…ç½®</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># yum install -y rsync inotify-tools</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># rsync rsync://192.168.222.161  //æ˜¾ç¤º192.168.222.161æœåŠ¡å™¨å…±äº«çš„rsyncdçš„åå­—</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># rsync rsync://lt@192.168.222.161/backup   //æŸ¥çœ‹ç›®å½•,ä¹Ÿå¯ä»¥ä¸Šä¼ ç›®å½•,ä½†æ˜¯ä¹Ÿå¯ä»¥ä¸Šä¼ å‘é€æ–‡ä»¶,ä½†æ˜¯æ˜¯éœ€è¦äº¤äº’å¼è¾“å…¥å¯†ç è®¤è¯çš„</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># echo 123 &gt; /etc/rsync.pas         //è®¤è¯æ–‡ä»¶</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># rsync --password-file=/etc/rsync.pas lt@192.168.222.161::backup</span></span><br><span class="line">æˆ–è€…</span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># rsync --password-file=/etc/rsync.pas rsync://lt@192.168.222.161/backup</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># tar xf sersync* </span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># mv sersync* /usr/local/sersync</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># vim /etc/profile</span></span><br><span class="line">export SERSYNC_HOME=/usr/local/sersync</span><br><span class="line">export PATH=<span class="variable">$</span>&#123;SERSYNC_HOME&#125;:<span class="variable">$PATH</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># source /etc/profile</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># cd /usr/local/sersync</span></span><br><span class="line">[<span class="type">root</span>@<span class="type">master</span>~]<span class="comment"># vim confxml.xml</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span><br><span class="line">&lt;head version=<span class="string">&quot;2.5&quot;</span>&gt;</span><br><span class="line">    &lt;host hostip=<span class="string">&quot;localhost&quot;</span> port=<span class="string">&quot;8008&quot;</span>&gt;&lt;/host&gt;</span><br><span class="line">    &lt;debug <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">    &lt;fileSystem xfs=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">    &lt;<span class="keyword">filter</span> <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>&gt;   &lt;!<span class="literal">--</span>&lt;æ˜¯å¦å¼€å¯è¿‡æ»¤åŠŸèƒ½ï¼Œä¸ºtrueçš„è¯è®¾ç½®ä»¥ä¸‹çš„ç±»å‹æ–‡ä»¶ä¸åŒæ­¥ &gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;(.*)\.svn&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;(.*)\.gz&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;^info/*&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;^static/*&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">    &lt;/<span class="keyword">filter</span>&gt;</span><br><span class="line">    &lt;inotify&gt;</span><br><span class="line">        &lt;delete <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;createFolder <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;createFile <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;      &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹&gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;closeWrite <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;moveFrom <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;moveTo <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;attrib <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;     &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹&gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;modify <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">    &lt;/inotify&gt;</span><br><span class="line"></span><br><span class="line">    &lt;sersync&gt;</span><br><span class="line">        &lt;localpath watch=<span class="string">&quot;/opt/&quot;</span>&gt;               &lt;!<span class="literal">--</span>&lt;ç›‘æ§çš„ç›®å½•&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;remote ip=<span class="string">&quot;192.168.222.161&quot;</span> name=<span class="string">&quot;backup&quot;</span>/&gt;   &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹ç›®æ ‡IPåœ°å€,backupæ˜¯å…±äº«å‡ºæ¥çš„æœåŠ¡åç§°&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;!<span class="literal">--</span>&lt;remote ip=<span class="string">&quot;192.168.8.39&quot;</span> name=<span class="string">&quot;tongbu&quot;</span>/&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;!<span class="literal">--</span>&lt;remote ip=<span class="string">&quot;192.168.8.40&quot;</span> name=<span class="string">&quot;tongbu&quot;</span>/&gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;/localpath&gt;</span><br><span class="line">        &lt;rsync&gt;</span><br><span class="line">            &lt;commonParams params=<span class="string">&quot;-artuz&quot;</span>/&gt;             &lt;!<span class="literal">--</span>&lt;rsyncä¼ è¾“æ—¶é—´æºå¸¦çš„å‚æ•°&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹,å¼€å¯æ‰èƒ½ä¿®æ”¹,è¿˜æœ‰ç™»é™†çš„ltç”¨æˆ·å’Œè®¤è¯çš„æ–‡ä»¶&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;auth <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span> users=<span class="string">&quot;lt&quot;</span> passwordfile=<span class="string">&quot;/etc/rsync.pas&quot;</span>/&gt;</span><br><span class="line">            &lt;userDefinedPort <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> port=<span class="string">&quot;874&quot;</span>/&gt;&lt;!<span class="literal">--</span> port=<span class="number">874</span> <span class="literal">--</span>&gt;</span><br><span class="line">            &lt;timeout <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> time=<span class="string">&quot;100&quot;</span>/&gt;&lt;!<span class="literal">--</span> timeout=<span class="number">100</span> <span class="literal">--</span>&gt;</span><br><span class="line">            &lt;ssh <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">        &lt;/rsync&gt;</span><br><span class="line">        &lt;failLog path=<span class="string">&quot;/tmp/rsync_fail_log.sh&quot;</span> timeToExecute=<span class="string">&quot;60&quot;</span>/&gt;&lt;!<span class="literal">--default</span> every <span class="number">60</span>mins execute once<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;crontab <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> schedule=<span class="string">&quot;600&quot;</span>&gt;&lt;!<span class="literal">--600mins--</span>&gt;</span><br><span class="line">            &lt;crontabfilter <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">                &lt;exclude expression=<span class="string">&quot;*.php&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">                &lt;exclude expression=<span class="string">&quot;info/*&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">            &lt;/crontabfilter&gt;</span><br><span class="line">        &lt;/crontab&gt;</span><br><span class="line">        &lt;plugin <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> name=<span class="string">&quot;command&quot;</span>/&gt;</span><br><span class="line">    &lt;/sersync&gt;</span><br><span class="line">                                &lt;!<span class="literal">--</span>&lt;ä»¥ä¸‹ä¸éœ€è¦ä¿®æ”¹ &gt;<span class="literal">--</span>&gt;</span><br><span class="line">    &lt;plugin name=<span class="string">&quot;command&quot;</span>&gt;</span><br><span class="line">        &lt;<span class="keyword">param</span> prefix=<span class="string">&quot;/bin/sh&quot;</span> suffix=<span class="string">&quot;&quot;</span> ignoreError=<span class="string">&quot;true&quot;</span>/&gt;  &lt;!<span class="literal">--prefix</span> /opt/tongbu/mmm.sh suffix<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;<span class="keyword">filter</span> <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">            &lt;include expression=<span class="string">&quot;(.*)\.php&quot;</span>/&gt;</span><br><span class="line">            &lt;include expression=<span class="string">&quot;(.*)\.sh&quot;</span>/&gt;</span><br><span class="line">        &lt;/<span class="keyword">filter</span>&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br><span class="line"></span><br><span class="line">    &lt;plugin name=<span class="string">&quot;socket&quot;</span>&gt;</span><br><span class="line">        &lt;localpath watch=<span class="string">&quot;/opt/tongbu&quot;</span>&gt;</span><br><span class="line">            &lt;deshost ip=<span class="string">&quot;192.168.138.20&quot;</span> port=<span class="string">&quot;8009&quot;</span>/&gt;</span><br><span class="line">        &lt;/localpath&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br><span class="line">    &lt;plugin name=<span class="string">&quot;refreshCDN&quot;</span>&gt;</span><br><span class="line">        &lt;localpath watch=<span class="string">&quot;/data0/htdocs/cms.xoyo.com/site/&quot;</span>&gt;</span><br><span class="line">            &lt;cdninfo domainname=<span class="string">&quot;ccms.chinacache.com&quot;</span> port=<span class="string">&quot;80&quot;</span> username=<span class="string">&quot;xxxx&quot;</span> passwd=<span class="string">&quot;xxxx&quot;</span>/&gt;</span><br><span class="line">            &lt;sendurl base=<span class="string">&quot;http://pic.xoyo.com/cms&quot;</span>/&gt;</span><br><span class="line">            &lt;regexurl regex=<span class="string">&quot;false&quot;</span> match=<span class="string">&quot;cms.xoyo.com/site([/a-zA-Z0-9]*).xoyo.com/images&quot;</span>/&gt;</span><br><span class="line">        &lt;/localpath&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>äº†è§£ä¸€ä¸‹sersync2å‘½ä»¤çš„å‚æ•°</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å‚æ•°<span class="literal">-d</span>:å¯ç”¨å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼</span><br><span class="line">å‚æ•°<span class="literal">-r</span>:åœ¨ç›‘æ§å‰ï¼Œå°†ç›‘æ§ç›®å½•ä¸è¿œç¨‹ä¸»æœºç”¨rsyncå‘½ä»¤æ¨é€ä¸€é</span><br><span class="line">å‚æ•°<span class="literal">-n</span>: æŒ‡å®šå¼€å¯å®ˆæŠ¤çº¿ç¨‹çš„æ•°é‡ï¼Œé»˜è®¤ä¸º<span class="number">10</span>ä¸ª</span><br><span class="line">å‚æ•°<span class="literal">-o</span>:æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œé»˜è®¤ä½¿ç”¨confxml.xmlæ–‡ä»¶</span><br><span class="line">å‚æ•°<span class="literal">-m</span>:å•ç‹¬å¯ç”¨å…¶ä»–æ¨¡å—ï¼Œä½¿ç”¨ <span class="literal">-m</span> refreshCDN å¼€å¯åˆ·æ–°CDNæ¨¡å—</span><br><span class="line">å‚æ•°<span class="literal">-m</span>:å•ç‹¬å¯ç”¨å…¶ä»–æ¨¡å—ï¼Œä½¿ç”¨ <span class="literal">-m</span> socket å¼€å¯socketæ¨¡å—</span><br><span class="line">å‚æ•°<span class="literal">-m</span>:å•ç‹¬å¯ç”¨å…¶ä»–æ¨¡å—ï¼Œä½¿ç”¨ <span class="literal">-m</span> http å¼€å¯httpæ¨¡å—</span><br><span class="line">ä¸åŠ <span class="literal">-m</span>å‚æ•°ï¼Œåˆ™é»˜è®¤æ‰§è¡ŒåŒæ­¥ç¨‹åº</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ‰€ä»¥ä½¿ç”¨</span><br><span class="line"><span class="comment"># sersync2 -dro /usr/local/sesync/confxml.xml      //ç¬¬ä¸€æ¬¡ä½¿ç”¨å…ˆåŒæ­¥ä¸€æ¬¡,ç¬¬äºŒæ¬¡ä½¿ç”¨å°±å¯ä»¥å»é™¤-rå‚æ•°</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>sshçš„è¿æ¥</p></div><div class="note default orange simple"><p>rsyncçš„æœåŠ¡è¿æ¥è²Œä¼¼æ˜¯æ²¡æœ‰æ•°æ®åŠ å¯†çš„ï¼Œä¸ºäº†å®‰å…¨èµ·è§éœ€è¦ä½¿ç”¨ssh</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /usr/local/sesync/confxml.xml</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span><br><span class="line">&lt;head version=<span class="string">&quot;2.5&quot;</span>&gt;</span><br><span class="line">    &lt;host hostip=<span class="string">&quot;localhost&quot;</span> port=<span class="string">&quot;8008&quot;</span>&gt;&lt;/host&gt;</span><br><span class="line">    &lt;debug <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">    &lt;fileSystem xfs=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">    &lt;<span class="keyword">filter</span> <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>&gt;   &lt;!<span class="literal">--</span>&lt;æ˜¯å¦å¼€å¯è¿‡æ»¤åŠŸèƒ½ï¼Œä¸ºtrueçš„è¯è®¾ç½®ä»¥ä¸‹çš„ç±»å‹æ–‡ä»¶ä¸åŒæ­¥ &gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;(.*)\.svn&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;(.*)\.gz&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;^info/*&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">        &lt;exclude expression=<span class="string">&quot;^static/*&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">    &lt;/<span class="keyword">filter</span>&gt;</span><br><span class="line">    &lt;inotify&gt;</span><br><span class="line">        &lt;delete <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;createFolder <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;createFile <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">        &lt;closeWrite <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;moveFrom <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;moveTo <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">        &lt;attrib <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;     &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹&gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;modify <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">    &lt;/inotify&gt;</span><br><span class="line"></span><br><span class="line">    &lt;sersync&gt;</span><br><span class="line">        &lt;localpath watch=<span class="string">&quot;/opt/&quot;</span>&gt;</span><br><span class="line">            &lt;remote ip=<span class="string">&quot;192.168.222.161&quot;</span> name=<span class="string">&quot;/opt&quot;</span>/&gt;   &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹ä¸ºè¦ä¼ è¾“åˆ°backupæœºå™¨çš„ç›®æ ‡åœ°å€&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;!<span class="literal">--</span>&lt;remote ip=<span class="string">&quot;192.168.8.39&quot;</span> name=<span class="string">&quot;tongbu&quot;</span>/&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;!<span class="literal">--</span>&lt;remote ip=<span class="string">&quot;192.168.8.40&quot;</span> name=<span class="string">&quot;tongbu&quot;</span>/&gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;/localpath&gt;</span><br><span class="line">        &lt;rsync&gt;</span><br><span class="line">            &lt;commonParams params=<span class="string">&quot;-artuz&quot;</span>/&gt;</span><br><span class="line">            &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹,å…³é—­&gt;<span class="literal">--</span>&gt;</span><br><span class="line">            &lt;auth <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> users=<span class="string">&quot;lt&quot;</span> passwordfile=<span class="string">&quot;/etc/rsync.pas&quot;</span>/&gt;</span><br><span class="line">            &lt;userDefinedPort <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> port=<span class="string">&quot;874&quot;</span>/&gt;&lt;!<span class="literal">--</span> port=<span class="number">874</span> <span class="literal">--</span>&gt;</span><br><span class="line">            &lt;timeout <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> time=<span class="string">&quot;100&quot;</span>/&gt;&lt;!<span class="literal">--</span> timeout=<span class="number">100</span> <span class="literal">--</span>&gt;</span><br><span class="line">            &lt;ssh <span class="built_in">start</span>=<span class="string">&quot;true&quot;</span>/&gt;          &lt;!<span class="literal">--</span>&lt;ä¿®æ”¹,å¼€å¯sshè¿æ¥&gt;<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;/rsync&gt;</span><br><span class="line">        &lt;failLog path=<span class="string">&quot;/tmp/rsync_fail_log.sh&quot;</span> timeToExecute=<span class="string">&quot;60&quot;</span>/&gt;&lt;!<span class="literal">--default</span> every <span class="number">60</span>mins execute once<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;crontab <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> schedule=<span class="string">&quot;600&quot;</span>&gt;&lt;!<span class="literal">--600mins--</span>&gt;</span><br><span class="line">            &lt;crontabfilter <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">                &lt;exclude expression=<span class="string">&quot;*.php&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">                &lt;exclude expression=<span class="string">&quot;info/*&quot;</span>&gt;&lt;/exclude&gt;</span><br><span class="line">            &lt;/crontabfilter&gt;</span><br><span class="line">        &lt;/crontab&gt;</span><br><span class="line">        &lt;plugin <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span> name=<span class="string">&quot;command&quot;</span>/&gt;</span><br><span class="line">    &lt;/sersync&gt;</span><br><span class="line">                                &lt;!<span class="literal">--</span>&lt;ä»¥ä¸‹ä¸éœ€è¦ä¿®æ”¹ &gt;<span class="literal">--</span>&gt;</span><br><span class="line">    &lt;plugin name=<span class="string">&quot;command&quot;</span>&gt;</span><br><span class="line">        &lt;<span class="keyword">param</span> prefix=<span class="string">&quot;/bin/sh&quot;</span> suffix=<span class="string">&quot;&quot;</span> ignoreError=<span class="string">&quot;true&quot;</span>/&gt;  &lt;!<span class="literal">--prefix</span> /opt/tongbu/mmm.sh suffix<span class="literal">--</span>&gt;</span><br><span class="line">        &lt;<span class="keyword">filter</span> <span class="built_in">start</span>=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">            &lt;include expression=<span class="string">&quot;(.*)\.php&quot;</span>/&gt;</span><br><span class="line">            &lt;include expression=<span class="string">&quot;(.*)\.sh&quot;</span>/&gt;</span><br><span class="line">        &lt;/<span class="keyword">filter</span>&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br><span class="line"></span><br><span class="line">    &lt;plugin name=<span class="string">&quot;socket&quot;</span>&gt;</span><br><span class="line">        &lt;localpath watch=<span class="string">&quot;/opt/tongbu&quot;</span>&gt;</span><br><span class="line">            &lt;deshost ip=<span class="string">&quot;192.168.138.20&quot;</span> port=<span class="string">&quot;8009&quot;</span>/&gt;</span><br><span class="line">        &lt;/localpath&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br><span class="line">    &lt;plugin name=<span class="string">&quot;refreshCDN&quot;</span>&gt;</span><br><span class="line">        &lt;localpath watch=<span class="string">&quot;/data0/htdocs/cms.xoyo.com/site/&quot;</span>&gt;</span><br><span class="line">            &lt;cdninfo domainname=<span class="string">&quot;ccms.chinacache.com&quot;</span> port=<span class="string">&quot;80&quot;</span> username=<span class="string">&quot;xxxx&quot;</span> passwd=<span class="string">&quot;xxxx&quot;</span>/&gt;</span><br><span class="line">            &lt;sendurl base=<span class="string">&quot;http://pic.xoyo.com/cms&quot;</span>/&gt;</span><br><span class="line">            &lt;regexurl regex=<span class="string">&quot;false&quot;</span> match=<span class="string">&quot;cms.xoyo.com/site([/a-zA-Z0-9]*).xoyo.com/images&quot;</span>/&gt;</span><br><span class="line">        &lt;/localpath&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>éœ€è¦åŒæ­¥å¤šä¸ªç›®å½•å°±éœ€è¦ç¼–å†™å¤šä¸ªconfxml.xmlç„¶åä¸åŒè¿›ç¨‹åœ°æ‰§è¡Œ</p></div>]]></content>
    
    
    <summary type="html">sersync2å®æ—¶ç›‘æ§åŒæ­¥æ–‡ä»¶</summary>
    
    
    
    <category term="æœåŠ¡é›†ç¾¤" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/"/>
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/%E6%BC%94%E7%A4%BA/"/>
    
    
    <category term="Linux" scheme="https://www.linjiangyu.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>hadoop+spark+zookeeperåˆ†å¸ƒå¼é›†ç¾¤æ­å»º</title>
    <link href="https://www.linjiangyu.com/posts/371a3fb1.html"/>
    <id>https://www.linjiangyu.com/posts/371a3fb1.html</id>
    <published>2022-11-11T03:42:26.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<h1>hadoop+spark+zookeeperåˆ†å¸ƒå¼é›†ç¾¤éƒ¨ç½²</h1><div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><p>1.ç¯å¢ƒå‡†å¤‡</p></div></div><div class="note default orange simple"><p>ç¯å¢ƒçš„å‡†å¤‡åŸºäºæˆ‘å†™çš„åˆå§‹åŒ–è„šæœ¬,è‡ªç”¨7.xç³»åˆ—çš„CentOS,è€ç‰ˆæœ¬çš„å°±æ”¯æŒCentOS/Redhat6,7,8ä½†æ˜¯æœ‰ç‚¹ä¸å®Œå–„ï¼Œéœ€è¦å¯ä»¥é‚®ç®±æˆ–è€…åšå®¢ç•™è¨€ã€‚</p></div><table><thead><tr><th style="text-align:center">os\ip</th><th style="text-align:center">hostname</th><th style="text-align:center">block</th></tr></thead><tbody><tr><td style="text-align:center">centos7.9 192.168.222.226</td><td style="text-align:center">master</td><td style="text-align:center">rsmanager,datanode,namenode.snamenode,nmanager</td></tr><tr><td style="text-align:center">centos7.9 192.168.222.227</td><td style="text-align:center">node1</td><td style="text-align:center">snamenode,nmnager,datanode</td></tr><tr><td style="text-align:center">centos7.9 192.168.222.228</td><td style="text-align:center">node2</td><td style="text-align:center">datanode,nmanager</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/linjiangyu2/K.git   //å¯èƒ½ä¼šæ‹‰ä¸ä¸‹æ¥ï¼Œå¤šæ‹‰å‡ æ¬¡å°±ä¸‹æ¥äº†ï¼Œå› ä¸ºæ‰˜ç®¡ä»£ç çš„æœåŠ¡å™¨æ˜¯å›½å¤–çš„</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> K</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> README.md  //ä¸ä¼šä½¿ç”¨çš„è¦çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼Œäº†è§£è„šæœ¬éœ€è¦è¾“å…¥çš„é…ç½®</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">./ksh  //ä¾æ¬¡è¾“å…¥ä½ è‡ªå·±çš„é…ç½®ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¸€å®šè¦çœ‹README.mdæ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœéœ€è¦æœ‰æ—¶å€™æ”¹IPåœ°å€å›¾æ–¹ä¾¿çš„è¯ï¼Œç›´æ¥æŠŠkshè¿™ä¸ªäºŒè¿›åˆ¶çš„è„šæœ¬æ”¾åœ¨/usr/binä¸‹ï¼Œä¾¿å¯ä»¥åœ¨å…¨å±€æ‰§è¡Œäº†</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> ksh /usr/bin/ksh</span></span><br><span class="line">ä½¿ç”¨kshåˆå§‹åŒ–åï¼Œå¼€å§‹é…ç½®</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>å¯¹åº”è‡ªå·±çš„IPåœ°å€ï¼Œæœ€å¥½/etc/hostsçš„è§£æåå’Œæˆ‘ä¸€è‡´ï¼Œä¸ç„¶ä¸‹é¢çš„é…ç½®æ–‡ä»¶éœ€è¦è‡ªå·±å¯¹åº”è‡ªå·±çš„è§£æåä¿®æ”¹</p></div><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[master]</span># </span><br><span class="line">cat &gt; /etc/hosts &lt;&lt;END</span><br><span class="line"><span class="number">127.0.0.1</span>   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::<span class="number">1</span>         localhost localhost.localdomain localhost6 </span><br><span class="line"><span class="number">192.168.222.226</span> master</span><br><span class="line"><span class="number">192.168.222.227</span> node1</span><br><span class="line"><span class="number">192.168.222.228</span> node2</span><br><span class="line">END</span><br><span class="line"><span class="string">[master]</span># ssh-keygen -P &#x27;&#x27; -f ~/.ssh/id_rsa</span><br><span class="line"><span class="string">[master]</span># for i in master node&#123;<span class="number">1</span>..<span class="number">2</span>&#125;;do ssh-copy-id $i;done</span><br><span class="line"><span class="string">[master]</span># for i in node&#123;<span class="number">1</span>..<span class="number">2</span>&#125;;do rsync -av /etc/hosts root@$i:/etc/hosts;done</span><br><span class="line"><span class="string">[master]</span># for i in master node&#123;<span class="number">1</span>..<span class="number">2</span>&#125;;do ssh $i yum install -y openssl-devel;done</span><br><span class="line"><span class="string">[master]</span># cd /usr/lib64</span><br><span class="line"><span class="string">[master]</span># ln -s libcrypto.so.<span class="number">1</span>.<span class="number">0</span>.2k libcrypto.so</span><br></pre></td></tr></table></figure><div class='wow animate__flip' data-wow-duration='' data-wow-delay='' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-fan"></i><p>2.æ­å»º</p></div></div><h4 id="2-1-hadoopåˆ†å¸ƒå¼">2.1 hadoopåˆ†å¸ƒå¼</h4><h4 id="ä¸Šä¼ jdkå’Œhadoopçš„taråŒ…">ä¸Šä¼ jdkå’Œhadoopçš„taråŒ…</h4><div class="note default orange simple"><p>è¿™é‡Œä½¿ç”¨çš„äºŒè¿›åˆ¶åŒ…</p></div><div class="tag link"><a class="link-card" title="hadoop-2.8.5.tar.gz" href="https://alist.linjiangyu.com/d/Linux/hadoop-2.8.5.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">hadoop-2.8.5.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/hadoop-2.8.5.tar.gz</p></div></a></div><div class="tag link"><a class="link-card" title="jdk-8u212-linux-x64.tar.gz" href="https://alist.linjiangyu.com/d/Linux/jdk-8u212-linux-x64.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">jdk-8u212-linux-x64.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/jdk-8u212-linux-x64.tar.gz</p></div></a></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  [master]<span class="comment"># tar xf hadoop...  //ä¸çŸ¥é“ä½ ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œå†™äº†...ï¼Œä»¥ä¸‹ä¹Ÿæ˜¯ï¼Œtabé”®æˆ–è€…å¯¹åº”ä¿®æ”¹å°±å¯ä»¥</span></span><br><span class="line">  <span class="comment"># ...æ˜¯è¡¨ç¤ºæˆ‘ä¸çŸ¥é“ä½ ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œè‡ªå·±æ”¹</span></span><br><span class="line">  [root@ master]<span class="comment"># tar xf jdk...</span></span><br><span class="line">  [root@ master]<span class="comment"># tar xf hadoop...</span></span><br><span class="line">  [root@ master]<span class="comment"># mv hadoop... /opt/hadoop285</span></span><br><span class="line">  [root@ master]<span class="comment"># mv jdk... /usr/local/jdk</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># vim /etc/profile</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/local/jdk</span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/hadoop285</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="variable">$&#123;HADOOP_HOME&#125;</span>/bin:<span class="variable">$&#123;HADOOP_HOME&#125;</span>/sbin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_LIB_NATIVE_DIR=<span class="variable">$HADOOP_HOME</span>/lib/native </span><br><span class="line"><span class="built_in">export</span> HADOOP_OPTS=<span class="string">&quot;-Djava.library.path=<span class="variable">$HADOOP_HOME</span>/lib/native&quot;</span></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$HADOOP_HOME</span>/lib/native/:<span class="variable">$LD_LIBRARY_PATH</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># source !$</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ä»¥ä¸‹æ˜¯è‡ªå·±ç›´æ¥å†™å…¥é…ç½®ï¼Œåœ¨masteræœåŠ¡å™¨ä¸Šè¿›è¡Œ</p></div><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /opt/hadoop285/etc/hadoop</span></span><br><span class="line"><span class="comment"># vim hadoop-env.sh  //ä¿®æ”¹æ–‡ä»¶é‡Œé¢çš„export JAVA_HOME=$&#123;JAVA_HOME&#125;ä¸º</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line"><span class="comment"># vim yarn-env.sh //ä¿®æ”¹å‰é¢æœ‰æ³¨é‡Šçš„export JAVA_HOMEä¸º</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line"><span class="comment"># vim core-site.xml</span></span><br><span class="line"><span class="variable">&lt;configuration&gt;</span></span><br><span class="line">        <span class="variable">&lt;property&gt;</span></span><br><span class="line">                <span class="variable">&lt;name&gt;</span>hadoop.tmp.dir<span class="variable">&lt;/name&gt;</span></span><br><span class="line">                <span class="variable">&lt;value&gt;</span>/opt/data<span class="variable">&lt;/value&gt;</span></span><br><span class="line">        <span class="variable">&lt;/property&gt;</span></span><br><span class="line">        <span class="variable">&lt;property&gt;</span></span><br><span class="line">                <span class="variable">&lt;name&gt;</span>fs.defaultFS<span class="variable">&lt;/name&gt;</span></span><br><span class="line">                <span class="variable">&lt;value&gt;</span>hdfs://master:9000<span class="variable">&lt;/value&gt;</span></span><br><span class="line">        <span class="variable">&lt;/property&gt;</span></span><br><span class="line"><span class="variable">&lt;/configuration&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim hdfs-site.xml</span></span><br><span class="line"><span class="variable">&lt;configuration&gt;</span></span><br><span class="line">        <span class="variable">&lt;property&gt;</span></span><br><span class="line">                <span class="variable">&lt;name&gt;</span>dfs.replication<span class="variable">&lt;/name&gt;</span></span><br><span class="line">                <span class="variable">&lt;value&gt;</span>1<span class="variable">&lt;/value&gt;</span></span><br><span class="line">        <span class="variable">&lt;/property&gt;</span></span><br><span class="line">        <span class="variable">&lt;property&gt;</span></span><br><span class="line">                <span class="variable">&lt;name&gt;</span>dfs.namenode.name.dir<span class="variable">&lt;/name&gt;</span></span><br><span class="line">                <span class="variable">&lt;value&gt;</span>/opt/data/hdfs/name<span class="variable">&lt;/value&gt;</span></span><br><span class="line">        <span class="variable">&lt;/property&gt;</span></span><br><span class="line">        <span class="variable">&lt;property&gt;</span></span><br><span class="line">                <span class="variable">&lt;name&gt;</span>dfs.datanode.data.dir<span class="variable">&lt;/name&gt;</span></span><br><span class="line">                <span class="variable">&lt;value&gt;</span>/opt/data/hdfs/data<span class="variable">&lt;/value&gt;</span></span><br><span class="line">        <span class="variable">&lt;/property&gt;</span></span><br><span class="line"><span class="variable">&lt;/configuration&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim yarn-site.xml </span></span><br><span class="line"></span><br><span class="line"><span class="variable">&lt;configuration&gt;</span></span><br><span class="line">        <span class="variable">&lt;property&gt;</span></span><br><span class="line">                <span class="variable">&lt;name&gt;</span>yarn.resourcemanager.hostname<span class="variable">&lt;/name&gt;</span></span><br><span class="line">                <span class="variable">&lt;value&gt;</span>master<span class="variable">&lt;/value&gt;</span></span><br><span class="line">        <span class="variable">&lt;/property&gt;</span></span><br><span class="line">        <span class="variable">&lt;property&gt;</span></span><br><span class="line">                <span class="variable">&lt;name&gt;</span>yarn.nodemanager.aux-services<span class="variable">&lt;/name&gt;</span></span><br><span class="line">                <span class="variable">&lt;value&gt;</span>mapreduce_shuffle<span class="variable">&lt;/value&gt;</span></span><br><span class="line">        <span class="variable">&lt;/property&gt;</span></span><br><span class="line"><span class="variable">&lt;/configuration&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cp mapred-site.xml.template mapred-site.xml</span></span><br><span class="line"><span class="comment"># vim mapred-site.xml</span></span><br><span class="line"><span class="variable">&lt;configuration&gt;</span></span><br><span class="line">    <span class="variable">&lt;property&gt;</span></span><br><span class="line">        <span class="variable">&lt;name&gt;</span>mapreduce.framework.name<span class="variable">&lt;/name&gt;</span></span><br><span class="line">        <span class="variable">&lt;value&gt;</span>yarn<span class="variable">&lt;/value&gt;</span></span><br><span class="line">    <span class="variable">&lt;/property&gt;</span></span><br><span class="line"><span class="variable">&lt;/configuration&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim slaves</span></span><br><span class="line"><span class="keyword">master</span></span><br><span class="line"><span class="title">node1</span></span><br><span class="line">node2</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ç„¶ååœ¨masterèŠ‚ç‚¹æŠŠé…ç½®å‘åˆ°å„ä¸ªèŠ‚ç‚¹</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[master]# </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /usr/local/jdk root@<span class="variable">$i</span>:/usr/local/;<span class="keyword">done</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /opt/hadoop285 root@<span class="variable">$i</span>:/opt/;<span class="keyword">done</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /etc/profile root@<span class="variable">$i</span>:/etc/profile;<span class="keyword">done</span></span></span><br><span class="line">ç„¶ååˆ°å„ä¸ªèŠ‚ç‚¹</span><br><span class="line">[node1,2]# source /etc/profile</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨node1,2ä¸Šæ“ä½œï¼Œæœ€ååœ¨masteræ“ä½œ</p></div><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># hdfs namenode -format   <span class="comment">//åˆå§‹åŒ–</span></span></span><br><span class="line"><span class="meta"># ls -d /opt/data   <span class="comment">//æ­¤æ–‡ä»¶å¤¹äº§ç”Ÿå°±æ˜¯åˆå§‹åŒ–æˆåŠŸ</span></span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨masterä¸Šæ“ä½œ</p></div><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ <span class="literal">master</span>]<span class="comment"># start-all.sh</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>æœ€åå¯ä»¥åœ¨å„ä¸ªèŠ‚ç‚¹ä½¿ç”¨jpså‘½ä»¤æŸ¥çœ‹å„è‡ªçš„éƒ¨ä»¶</p></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">root@ xxx</span>]<span class="meta"># jps</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>å½“ç„¶webç•Œé¢ä¹Ÿå¯ä»¥è®¿é—®çš„ï¼Œæµè§ˆå™¨è®¿é—®192.168.222.226:8088å’Œ192.168.222.226:50070(å¯¹åº”è‡ªå·±IPåœ°å€)</p></div><div class="note default orange simple"><p>æ¥å°è¯•è¿è¡Œä¸€ä¸‹ç¬¬ä¸€ä¸ªhadoopåˆ†å¸ƒå¼ä»»åŠ¡å§</p></div><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ master]# hdfs dfs -put <span class="regexp">/etc/</span>passwd /t1</span><br><span class="line">[root@ master]# hadoop jar <span class="regexp">/opt/</span>hadoop285<span class="regexp">/share/</span>hadoop<span class="regexp">/mapreduce/</span>hadoop-mapreduce-examples-<span class="number">2.8</span>.<span class="number">5</span>.jar wordcount <span class="regexp">/t1 /</span>output/<span class="number">00</span></span><br><span class="line">[root@ master]# hdfs dfs -ls <span class="regexp">/output/</span><span class="number">00</span>  <span class="comment">//æŸ¥çœ‹è¿è¡Œåçš„ç»“æœæ–‡ä»¶,è¿è¡Œåçš„æ•°æ®åœ¨part-r-00000</span></span><br></pre></td></tr></table></figure><h4 id="2-2-sparkåˆ†å¸ƒå¼">2.2 sparkåˆ†å¸ƒå¼</h4><div class="note default orange simple"><p>ä¸‹é¢å¼€å§‹æ­å»ºåˆ†å¸ƒå¼sparkï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯sparkçš„3.3.0ç‰ˆæœ¬</p></div><div class="tag link"><a class="link-card" title="spark-3.3.0-bin-hadoop3.tgz" href="https://alist.linjiangyu.com/d/Linux/spark-3.3.0-bin-hadoop3.tgz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">spark-3.3.0-bin-hadoop3.tgz</p><p class="url">https://alist.linjiangyu.com/d/Linux/spark-3.3.0-bin-hadoop3.tgz</p></div></a></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># æŠŠsparkåŒ…ä¸Šä¼ åˆ°æœºå™¨ä¸Šï¼Œç„¶ååˆ°è¯¥åŒ…çš„ç›®å½•ï¼Œè¿™é‡Œç»Ÿä¸€ä»¥spark-3.3.0-bin-hadoop3.tgzè¿™ä¸ªåŒ…ä¸ºæ¼”ç¤º</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># tar xf spark-3.3.0-bin-hadoop3.tgz</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># mv spark-3.3.0-bin-hadoop3 /opt/spark</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># vim /etc/profile</span></span><br><span class="line">export PATH=/opt/spark/bin:/opt/spark/sbin:$PATH</span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># cd /opt/spark/conf</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># mv spark-env.sh.template spark-env.sh</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># vim spark-env.sh</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line">export HADOOP_CONF_DIR=/opt/hadoop285/etc/hadoop</span><br><span class="line">export SPARK_MASTER_IP=master   <span class="meta">#å¯¹åº”è‡ªå·±çš„masteræœºå™¨IPæˆ–è€…masterè§£æçš„åŸŸåï¼Œå¦‚æœæ˜¯æŒ‰ç…§æˆ‘ä¸Šé¢åšçš„ç›´æ¥å†™masterå³å¯</span></span><br><span class="line">export SPARK_WORKER_MEMORY=<span class="number">1024</span>m</span><br><span class="line">export SPARK_WORKER_CORES=<span class="number">2</span> </span><br><span class="line">export SPARK_EXECUTOR_MEMORY=<span class="number">1024</span>m</span><br><span class="line">export SPARK_WORKER_INSTANCES=<span class="number">1</span></span><br><span class="line">export SOARK_MASTER_PORT=<span class="number">7077</span></span><br><span class="line">export SPARK_EXECUTOR_CORES=<span class="number">1</span></span><br><span class="line">SPARK_HISTORY_OPTS=<span class="string">&quot;-Dspark.history.fs.logDirectory=hdfs://master:9000/spark_logs&quot;</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># cp spark-defaults.conf.template spark-defaults.conf</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># vim spark-defaults.conf</span></span><br><span class="line">spark.master                     spark:<span class="comment">//master:7077</span></span><br><span class="line">spark.eventLog.enabled           <span class="literal">true</span></span><br><span class="line">spark.eventLog.dir               hdfs:<span class="comment">//master:9000/spark_logs</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># vim slaves     //å¯¹åº”è‡ªå·±çš„ä¸‰å°ä¸»æœºIPåœ°å€æˆ–è€…è§£æçš„åŸŸå</span></span><br><span class="line">master</span><br><span class="line">node1</span><br><span class="line">node2</span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># cd /opt/spark/sbin</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># mv start-all.sh spark-start.sh</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># mv stop-all.sh spark-stop.sh</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># source /etc/profile</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># scp -r /opt/spark root@node1:/opt/</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># scp -r /opt/spark root@node2:/opt/</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># scp -r /etc/profile root@node1:/etc/</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># scp -r /etc/profile root@node2:/etc/</span></span><br><span class="line"><span class="meta"># ç„¶ååœ¨å„å·¥ä½œèŠ‚ç‚¹æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">[<span class="meta">root@ node1,node2</span>]<span class="meta"># source /etc/profile</span></span><br><span class="line"><span class="meta"># åœ¨masterèŠ‚ç‚¹æ‰§è¡Œ</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># start-all.sh</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># hdfs dfs -mkdir /spark_logs</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># spark-start.sh  //å¯åŠ¨sparké›†ç¾¤</span></span><br><span class="line">[<span class="meta">root@ master</span>]<span class="meta"># jps     //æŸ¥çœ‹</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>ä»¥ä¸Šä¾¿æ­å»ºå¥½äº†sparkç»“åˆhadoopçš„åˆ†å¸ƒå¼é›†ç¾¤ï¼Œsparkä¹Ÿæœ‰è‡ªå·±çš„webç•Œé¢ï¼Œå¯ä»¥æµè§ˆå™¨è®¿é—®192.168.222.226:8080æ¥æŸ¥çœ‹(å¯¹åº”è‡ªå·±IPåœ°å€)</p></div><h4 id="2-3-zookeeperåˆ†å¸ƒå¼">2.3 zookeeperåˆ†å¸ƒå¼</h4><div class="tag link"><a class="link-card" title="apache-zookeeper-3.5.10.tar.gz" href="https://alist.linjiangyu.com/d/Linux/zookeeper-3.4.14.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">apache-zookeeper-3.5.10.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/zookeeper-3.4.14.tar.gz</p></div></a></div><div class="note default orange simple"><p>åœ¨masteræœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tar xf zookeeper*</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> zookeeper* /opt/zookeeper</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> /opt/zookeeper/conf/zoo_sample.cfg /opt/zookeeper/conf/zoo.cfg</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /opt/zookeeper/conf/zoo.cfg</span></span><br><span class="line">ä¿®æ”¹</span><br><span class="line">dataDir=/opt/data/zookeeper</span><br><span class="line">æ·»åŠ </span><br><span class="line">dataLogDir=/opt/data/zookeeper/logs</span><br><span class="line">server.1=master:2888:3888</span><br><span class="line">server.2=node1:2888:3888</span><br><span class="line">server.3=node2:2888:3888</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™é‡Œå¯¹åº”è‡ªå·±çš„ä¸»æœºå</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨å„æœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mkdir</span> -p /opt/data/zookeeper/logs</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">echo</span> 1 &gt; /opt/data/zookeeper/myid             <span class="comment">#è¿™é‡Œmasterå¯¹åº”ä¸Šé¢çš„server.1 ä¾¿è¦echo1,node1å¯¹åº”server.2ä¾¿è¦echo 2,node3å¯¹åº”server.3ä¾¿è¦echo 3</span></span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨masteræœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /etc/profile</span></span><br><span class="line">export ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line">export PATH=$&#123;ZOOKEEPER_HOME&#125;/bin:$PATH</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /opt/zookeeper root@<span class="variable">$i</span>:/opt/;<span class="keyword">done</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> node&#123;1..2&#125;;<span class="keyword">do</span> rsync -av /etc/profile /etc/;<span class="keyword">done</span></span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>åœ¨å„æœºå™¨ä¸Šæ‰§è¡Œ</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">source</span> /etc/profile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zkServer.sh start             <span class="comment">#è¿™ä¸ªå‘½ä»¤æœ€å¥½ä½¿ç”¨å¤šå‘½ä»¤ä¸€èµ·æ‰§è¡Œ,å°±æ˜¯å¤šä¸ªæœºå™¨çš„æ‰§è¡Œæ—¶é—´è¦å·®ä¸å¤šä¸€ç›´,å› ä¸ºzookeeperå¯¹æ—¶é—´çš„è¦æ±‚æ€§å¾ˆé«˜å’Œå„ç§é—®é¢˜</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zkServer.sh status    <span class="comment"># å¯ä»¥åœ¨å„èŠ‚ç‚¹æŸ¥çœ‹è‡ªå·±çš„è§’è‰²æ˜¯leaderè¿˜æ˜¯follower</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">hadoop+spark+zookeeperåˆ†å¸ƒå¼é›†ç¾¤æ­å»º</summary>
    
    
    
    <category term="æœåŠ¡é›†ç¾¤" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/"/>
    
    
  </entry>
  
  <entry>
    <title>ä¸æ€ä¹ˆå¥½èµ°çš„è·¯ æ‰æ˜¯ä¸Šå¡è·¯</title>
    <link href="https://www.linjiangyu.com/posts/78ceeb56.html"/>
    <id>https://www.linjiangyu.com/posts/78ceeb56.html</id>
    <published>2022-11-06T08:17:21.000Z</published>
    <updated>2023-11-27T01:42:42.513Z</updated>
    
    <content type="html"><![CDATA[<span class='p center red logo large'>ä¸æ€ä¹ˆå¥½èµ°çš„è·¯ æ‰æ˜¯ä¸Šå¡è·¯</span><p>ä¸€ä»¶äº‹åšè¿‡ä¸€ç™¾éï¼Œä¹Ÿè¿˜æœ‰å¯ä»¥ç²¾è¿›ä¹‹å¤„;<br>ä¸€ç¯‡æ–‡ç« å†™è¿‡ä¸€ç™¾éï¼Œä¹Ÿè¿˜æœ‰å¯ä»¥æ”¹è¿›ä¹‹å¤„;<br>ä¸€ç§æ–¹æ³•ç”¨è¿‡ä¸€ç™¾éï¼Œä¹Ÿè¿˜æœ‰å¯ä»¥å®Œå–„ä¹‹å¤„ã€‚<br>ä¸€æ—¦åœæ­¢å­¦ä¹ ï¼Œäººå°±ä¼šæ­¢æ­¥ä¸å‰ã€‚</p>]]></content>
    
    
    <summary type="html">ä¸æ€ä¹ˆå¥½èµ°çš„è·¯ æ‰æ˜¯ä¸Šå¡è·¯</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>Webåº”ç”¨ä¹‹Tomcat</title>
    <link href="https://www.linjiangyu.com/posts/d5d9f79c.html"/>
    <id>https://www.linjiangyu.com/posts/d5d9f79c.html</id>
    <published>2022-11-03T07:50:40.000Z</published>
    <updated>2022-11-03T07:53:03.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Tomcat">Tomcat</h2><h3 id="äºŒè¿›åˆ¶å®‰è£…">äºŒè¿›åˆ¶å®‰è£…</h3><div class="note default orange simple"><p>å®‰è£…jdk</p></div><details class="folding-tag" cyan open><summary> è¿™é‡Œä½¿ç”¨çš„äºŒè¿›åˆ¶åŒ… </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="jdk-8u212-linux-x64.tar.gz" href="https://alist.linjiangyu.com/d/Linux/jdk-8u212-linux-x64.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">jdk-8u212-linux-x64.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/jdk-8u212-linux-x64.tar.gz</p></div></a></div>              </div>            </details><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xf jdk-8u212-linux-x64.tar.gz</span></span><br><span class="line"><span class="comment"># mv jdk-8u212-linux /usr/local/jdk</span></span><br></pre></td></tr></table></figure><details class="folding-tag" cyan open><summary> è¿™é‡Œä½¿ç”¨çš„äºŒè¿›åˆ¶åŒ… </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="apache-tomcat-9.0.65-src.tar.gz" href="https://alist.linjiangyu.com/d/Linux/apache-tomcat-9.0.65-src.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">apache-tomcat-9.0.65-src.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/apache-tomcat-9.0.65-src.tar.gz</p></div></a></div><div class="tag link"><a class="link-card" title="tomcat-native-1.2.23-src.tar.gz" href="https://alist.linjiangyu.com/d/Linux/tomcat-native-1.2.23-src.tar.gz"><div class="left"><img src="https://gcore.jsdelivr.net/gh/linjiangyu2/halo@master/img/fa.jpg"/></div><div class="right"><p class="text">tomcat-native-1.2.23-src.tar.gz</p><p class="url">https://alist.linjiangyu.com/d/Linux/tomcat-native-1.2.23-src.tar.gz</p></div></a></div>              </div>            </details><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xf apache-tomcat-9.0.65-src.tar.gz</span></span><br><span class="line"><span class="comment"># mv apache-tomcat-9.0.65-src /usr/local/tomcat</span></span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum install apr apr-devel apr-utils openssl-devel</span></span><br><span class="line"><span class="comment"># tar xf tomcat-native-1.2.23-src.tar.gz </span></span><br><span class="line"><span class="comment"># cd tomcat-native-1.2.23-src/native/</span></span><br><span class="line"><span class="comment"># ./configure --with-apr=/usr/bin/apr-1-config --with-java-home=/usr/local/jdk --prefix=/usr/local/tomcat</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>å°†jdkå’Œtomcatå†™å…¥ç¯å¢ƒå˜é‡</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/profile</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line">export JRE_HOME=/usr/local/jdk/jre</span><br><span class="line">export TOMCAT_HOME=/usr/local/tomcat</span><br><span class="line">export PATH=<span class="variable">$</span>&#123;JAVA_HOME&#125;/bin:<span class="variable">$</span>&#123;JRE_HOME&#125;/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªå°è„šæœ¬</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;<span class="keyword">END</span></span><br><span class="line">author: linjiangyu</span><br><span class="line">cc: http://creativecommons.org/licenses/by<span class="literal">-nc-sa</span>/<span class="number">4.0</span>/</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="comment"># vim /etc/init.d/tomcat</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#chkconfig: 2345 85 15</span></span><br><span class="line"><span class="comment">#description: By K &lt;linjiangyu0702@qq.com&gt;</span></span><br><span class="line">case <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line"><span class="built_in">start</span>)</span><br><span class="line">    /usr/local/tomcat/bin/startup.sh </span><br><span class="line">    ;;</span><br><span class="line">stop)</span><br><span class="line">    /usr/local/tomcat/bin/shutdown.sh</span><br><span class="line">    ;;</span><br><span class="line">status)    </span><br><span class="line">    /usr/local/tomcat/bin/configtest.sh</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> <span class="literal">-e</span> <span class="string">&quot;\033[31mUsage: <span class="variable">$</span>(basename <span class="variable">$0</span>) (start|stop|status)\033[0m&quot;</span></span><br><span class="line">    ;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">&lt;!<span class="literal">--</span>è¿™é‡Œè¦åæ§½ä¸€ä¸‹javaçš„ç¨‹åºè¿è¡Œçš„æ˜¯çœŸçš„æ…¢ï¼ŒæœåŠ¡åˆšå¯åŠ¨çš„è¯<span class="number">8005</span>çš„å¥—æ¥å­—ç«¯å£ä¸ä¼šé‚£ä¹ˆå¿«å°±å¯ç”¨ï¼Œè€Œå…³é—­æœåŠ¡çš„æ—¶å€™æ˜¯è¦ä½¿ç”¨åˆ°<span class="number">8005</span>ç«¯å£shutdownçš„ï¼Œæ‰€ä»¥åº”è¯¥æŠŠrestartæœåŠ¡åŠ ä¸Šä¸€æ®µæ—¶é—´<span class="literal">--</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># chmod +x /etc/init.d/tomcat</span></span><br><span class="line"><span class="comment"># vim /usr/local/tomcat/bin/catalina.sh# æŠŠç¯å¢ƒå˜é‡å†™å…¥ç›¸åº”éœ€è¦çš„æ–‡ä»¶ä¸­(tomcatçš„å˜é‡è¿™é‡Œæ²¡æœ‰å¼•ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡,æ‰€ä»¥è¦è‡ªå·±å†å†™ä¸Š)</span></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line">export JRE_HOME=/usr/local/jdk/jre</span><br><span class="line"><span class="comment"># chkconfig --add tomcat</span></span><br><span class="line"><span class="comment"># chkconfig tomcat on</span></span><br><span class="line"><span class="comment"># service tomcat start</span></span><br></pre></td></tr></table></figure><h4 id="1-ä¼˜ç‚¹å’ŒåŠŸèƒ½">1.ä¼˜ç‚¹å’ŒåŠŸèƒ½</h4><div class="note default orange simple"><p>ä¼˜ç‚¹å’ŒåŠŸèƒ½</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Tomcatè¿è¡Œæ—¶å ç”¨çš„ç³»ç»Ÿèµ„æºå°ï¼Œæ‰©å±•æ€§å¥½ï¼Œæ”¯æŒè´Ÿè½½å‡è¡¡ä¸é‚®ä»¶æœåŠ¡ç­‰å¼€å‘åº”ç”¨ç³»ç»Ÿå¸¸ç”¨çš„åŠŸèƒ½ï¼›</span><br><span class="line"></span><br><span class="line">Tomcatæ˜¯ä¸€ä¸ªå¼€æºçš„webæœåŠ¡å™¨ ;</span><br><span class="line"></span><br><span class="line">Tomcatæ˜¯ä¸€ä¸ªå°å‹çš„è½»é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œåœ¨ä¸­å°å‹ç³»ç»Ÿå’Œå¹¶å‘è®¿é—®ç”¨æˆ·ä¸æ˜¯å¾ˆå¤šçš„åœºåˆä¸‹è¢«æ™®éä½¿ç”¨ï¼Œæ˜¯å¼€å‘å’Œè°ƒè¯•JSPç¨‹åºçš„é¦–é€‰ã€‚</span><br><span class="line"></span><br><span class="line">å¯¹äºä¸€ä¸ªåˆå­¦è€…æ¥è¯´ï¼Œå¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå½“åœ¨ä¸€å°æœºå™¨ä¸Šé…ç½®å¥½ApacheæœåŠ¡å™¨ï¼Œå¯åˆ©ç”¨å®ƒå“åº”å¯¹HTMLé¡µé¢çš„è®¿é—®è¯·æ±‚ã€‚å®é™…ä¸ŠTomcatéƒ¨åˆ†æ˜¯ApacheæœåŠ¡å™¨çš„æ‰©å±•ï¼Œæ‰€ä»¥å½“ä½ è¿è¡Œtomcatæ—¶ï¼Œå®ƒå®é™…ä¸Šä½œä¸ºä¸€ä¸ªApacheç‹¬ç«‹çš„è¿›ç¨‹å•ç‹¬è¿è¡Œçš„ã€‚ å½“é…ç½®æ­£ç¡®æ—¶ï¼ŒApacheä¸ºHTMLé¡µé¢æœåŠ¡ï¼Œè€ŒTomcatå®é™…ä¸Šè¿è¡ŒJSPé¡µé¢å’ŒServletã€‚å¦å¤–ï¼ŒTomcatå’ŒIISã€Apacheç­‰WebæœåŠ¡å™¨ä¸€æ ·ï¼Œå…·æœ‰å¤„ç†HTMLé¡µé¢çš„åŠŸèƒ½ï¼Œå¦å¤–å®ƒè¿˜æ˜¯ä¸€ä¸ªServletå’ŒJSPå®¹å™¨ï¼Œç‹¬ç«‹çš„Servletå®¹å™¨æ˜¯Tomcatçš„é»˜è®¤æ¨¡å¼ã€‚</span><br><span class="line"></span><br><span class="line">ä¸è¿‡ï¼ŒTomcatå¤„ç†é™æ€HTMLçš„èƒ½åŠ›ä¸å¦‚ApacheæœåŠ¡å™¨ã€‚</span><br></pre></td></tr></table></figure><h4 id="2-ç»„ä»¶">2.ç»„ä»¶</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Server: æ§åˆ¶tomcatçš„å¯åŠ¨å’Œå…³é—­,tomcatçš„ç”Ÿå‘½å‘¨æœŸç”±Serveræ§åˆ¶</span><br><span class="line"></span><br><span class="line">Engine: è´Ÿè´£å¤„ç†æ‰€æœ‰çš„è¯·æ±‚,å¤„ç†åå°†ç»“æœè¿”å›ç»™Service,è€Œconnectoræ˜¯ä½œä¸ºserviceä¸engineçš„ä½œä¸ºä¸­é—´äº¤æµè€…ï¼›ä¸€ä¸ªengineä¸‹å¯ä»¥é…ç½®ä¸€ä¸ªé»˜è®¤ä¸»æœºï¼Œæ¯ä¸ªè™šæ‹Ÿä¸»æœºéƒ½æœ‰ä¸€ä¸ªåŸŸå</span><br><span class="line"></span><br><span class="line">Connector ä¸»è¦è´Ÿè´£å¯¹å¤–äº¤æµ</span><br><span class="line"></span><br><span class="line">Hostï¼šä»£è¡¨ä¸€ä¸ªè™šæ‹Ÿä¸»æœºï¼Œæ¯ä¸ªè™šæ‹Ÿä¸»æœºå’ŒæŸä¸ªç½‘ç»œåŸŸåï¼ˆDomain Nameï¼‰ç›¸åŒ¹é…ã€‚ æ¯ä¸ªè™šæ‹Ÿä¸»æœºä¸‹éƒ½å¯ä»¥éƒ¨ç½²ä¸€ä¸ªæˆ–å¤šä¸ªwebåº”ç”¨ï¼Œæ¯ä¸ªwebåº”ç”¨å¯¹åº”äºä¸€ä¸ªcontextï¼Œæœ‰ä¸€ä¸ªcontext pathã€‚ å½“Hostè·å¾—ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå°†æŠŠè¯¥è¯·æ±‚åŒ¹é…åˆ°æŸä¸ªContextä¸Š</span><br><span class="line"></span><br><span class="line">Wrapperï¼š ä»£è¡¨ä¸€ä¸ª Servletï¼Œå®ƒè´Ÿè´£ç®¡ç†ä¸€ä¸ª Servletï¼ŒåŒ…æ‹¬çš„ Servlet çš„è£…è½½ã€åˆå§‹åŒ–ã€æ‰§è¡Œä»¥åŠèµ„æºå›æ”¶ã€‚Wrapper æ˜¯æœ€åº•å±‚çš„å®¹å™¨ï¼Œå®ƒæ²¡æœ‰å­å®¹å™¨</span><br></pre></td></tr></table></figure><h4 id="3-é…ç½®">3.é…ç½®</h4><div class="note default orange simple"><p>ç”¨æˆ·è®¤è¯ç™»é™†</p></div><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/tomcat/tomcat-user.xml</span></span><br><span class="line">&lt;user username=<span class="string">&quot;tomcat&quot;</span> password=<span class="string">&quot;abcd0702&quot;</span> roles=<span class="string">&quot;manager-gui&quot;</span>/&gt;  è®¾ç½®ç™»é™†ç”¨æˆ·å’Œå¯†ç ,roleè®¾ç½®ä¸ºå¯ä»¥æŸ¥çœ‹ç®¡ç†webç•Œé¢çš„æƒé™manager<span class="literal">-gui</span></span><br><span class="line"></span><br><span class="line">- manager<span class="literal">-gui</span> -å…è®¸è®¿é—®HTML GUIå’ŒçŠ¶æ€é¡µé¢</span><br><span class="line"></span><br><span class="line">- manager<span class="literal">-script</span> -å…è®¸è®¿é—®HTTP APIå’ŒçŠ¶æ€é¡µé¢</span><br><span class="line"></span><br><span class="line">- manager<span class="literal">-jmx</span> -å…è®¸è®¿é—®JMXä»£ç†å’ŒçŠ¶æ€é¡µ</span><br><span class="line"></span><br><span class="line">- manager<span class="literal">-status</span> -åªå…è®¸è®¿é—®çŠ¶æ€é¡µ</span><br></pre></td></tr></table></figure><div class="note default orange simple"><p>tomcaté»˜è®¤é™æ€ç½‘é¡µçš„å­˜æ”¾ä½ç½®åœ¨/usr/share/tomcat/webapps/ROOT/ä¸‹</p></div><p>â€¦è¿˜åœ¨ç¼–å†™ä¸­</p>]]></content>
    
    
    <summary type="html">Webåº”ç”¨ä¹‹Tomcat</summary>
    
    
    
    <category term="æœåŠ¡é›†ç¾¤" scheme="https://www.linjiangyu.com/categories/%E6%9C%8D%E5%8A%A1%E9%9B%86%E7%BE%A4/"/>
    
    
    <category term="Linux" scheme="https://www.linjiangyu.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>redisæŒä¹…åŒ–å­˜å‚¨åˆ‡æ¢</title>
    <link href="https://www.linjiangyu.com/posts/86ed3030.html"/>
    <id>https://www.linjiangyu.com/posts/86ed3030.html</id>
    <published>2022-10-26T02:29:27.000Z</published>
    <updated>2022-10-26T13:38:58.000Z</updated>
    
    <content type="html"><![CDATA[<div class="note default orange simple"><p>åˆ†äº«ä¸€ä¸ªå‘</p></div><p>redisæ•°æ®åº“çš„æŒä¹…åŒ–å­˜å‚¨æœ‰snapshotå’Œaofä¸¤ç§</p><p>å¦‚æœæ˜¯ä½¿ç”¨è¿‡snapshotä¹‹åå·²ç»æœ‰äº†å­˜å‚¨æ•°æ®ç„¶åè¦å¼€å¯aofçš„è¯,å› ä¸ºaofæ¯”snapshotæœºåˆ¶çš„rdbæ–‡ä»¶çš„ä¼˜å…ˆçº§é«˜,redisé»˜è®¤ä¼šå»åŠ è½½ç¬¬ä¸€æ¬¡ç”Ÿæˆçš„aofçš„ç©ºæ–‡ä»¶,ä¼šå¯¼è‡´å…¨éƒ¨æ•°æ®æœªèƒ½è¢«åŠ è½½,ç„¶åå¦‚æœè¿™ä¸ªæ—¶å€™ä½ ä½¿ç”¨äº†saveæˆ–bgsaveæˆ–è€…è§¦å‘äº†é…ç½®ä¸­çš„saveæœºåˆ¶,é‚£å°±ç›´æ¥æŠŠå½“å‰çš„ç©ºæ•°æ®åº“è¦†ç›–åˆ°rdbæ–‡ä»¶ä¸­äº†,é‚£å°±å¯ä»¥å‡†å¤‡æ”¶æ‹¾è¡Œæè¿å¤œåèˆ¹è½¬åˆ°è€æŒ,ç¼…ç”¸,æŸ¬åŸ”å¯¨äº†</p><p>è§£å†³æ–¹æ³•:</p><p>å‘½ä»¤è¡Œçš„åŠ¨æ€æ›´æ”¹,å‘½ä»¤è¡Œçš„ä¿®æ”¹ä¸ä¼šå’Œé‡å¯æœåŠ¡ä¸€èˆ¬å»æ›´æ–°ä½ çš„æ•°æ®åº“,æ‰€ä»¥åœ¨ä½ åŠ¨æ€æ›´æ”¹ä¸ºaofæœºåˆ¶åå†æ‰§è¡Œé‡å¯ä¼šè¿åŒä»¥å‰çš„æ•°æ®ä¸€åŒå¤‡ä»½è¿›aofæ–‡ä»¶,å½“ç„¶åŠ¨æ€æ›´æ”¹åä½ è¿˜æ˜¯éœ€è¦æŠŠé…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°æ›´æ”¹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># redis-cli </span></span><br><span class="line"></span><br><span class="line">127.0.0.1&gt;<span class="built_in"> config </span><span class="built_in">set</span> appendonly <span class="literal">yes</span></span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># vim redis.conf</span></span><br><span class="line"></span><br><span class="line">appendonly <span class="literal">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl restart redis.service</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">redisæŒä¹…åŒ–å­˜å‚¨åˆ‡æ¢</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/"/>
    
    <category term="æ•°æ®åº“" scheme="https://www.linjiangyu.com/categories/%E6%BC%94%E7%A4%BA/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="redis" scheme="https://www.linjiangyu.com/tags/redis/"/>
    
  </entry>
  
</feed>
